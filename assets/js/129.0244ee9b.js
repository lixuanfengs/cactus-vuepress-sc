(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{479:function(t,s,a){"use strict";a.r(s);var r=a(0),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[s("strong",[t._v("注：该源码分析对应SpringBoot版本为2.1.0.RELEASE")])]),t._v(" "),s("h2",{attrs:{id:"_1-温故而知新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-温故而知新"}},[t._v("#")]),t._v(" 1 温故而知新")]),t._v(" "),s("p",[t._v("本篇接 "),s("a",{attrs:{href:"https://juejin.cn/post/6844904090439270408",target:"_blank",rel:"noopener noreferrer"}},[t._v("外部配置属性值是如何被绑定到XxxProperties类属性上的？--SpringBoot源码（五）"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("温故而知新，我们来简单回顾一下上篇的内容，上一篇我们分析了SpringBoot"),s("strong",[t._v("外部配置属性值是如何被绑定到XxxProperties类属性上")]),t._v("的相关源码，现将外部属性绑定的重要步骤总结如下：")]),t._v(" "),s("ol",[s("li",[t._v("首先是"),s("code",[t._v("@EnableConfigurationProperties")]),t._v("注解"),s("code",[t._v("import")]),t._v("了"),s("code",[t._v("EnableConfigurationPropertiesImportSelector")]),t._v("后置处理器；")]),t._v(" "),s("li",[s("code",[t._v("EnableConfigurationPropertiesImportSelector")]),t._v("后置处理器又向"),s("code",[t._v("Spring")]),t._v("容器中注册了"),s("code",[t._v("ConfigurationPropertiesBeanRegistrar")]),t._v("和"),s("code",[t._v("ConfigurationPropertiesBindingPostProcessorRegistrar")]),t._v("这两个"),s("code",[t._v("bean")]),t._v("；")]),t._v(" "),s("li",[t._v("其中"),s("code",[t._v("ConfigurationPropertiesBeanRegistrar")]),t._v("向"),s("code",[t._v("Spring")]),t._v("容器中注册了"),s("code",[t._v("XxxProperties")]),t._v("类型的"),s("code",[t._v("bean")]),t._v("；"),s("code",[t._v("ConfigurationPropertiesBindingPostProcessorRegistrar")]),t._v("向"),s("code",[t._v("Spring")]),t._v("容器中注册了"),s("code",[t._v("ConfigurationBeanFactoryMetadata")]),t._v("和"),s("code",[t._v("ConfigurationPropertiesBindingPostProcessor")]),t._v("两个后置处理器；")]),t._v(" "),s("li",[s("code",[t._v("ConfigurationBeanFactoryMetadata")]),t._v("后置处理器在初始化"),s("code",[t._v("bean")]),t._v(" "),s("code",[t._v("factory")]),t._v("时将"),s("code",[t._v("@Bean")]),t._v("注解的元数据存储起来，以便在后续的外部配置属性绑定的相关逻辑中使用；")]),t._v(" "),s("li",[s("code",[t._v("ConfigurationPropertiesBindingPostProcessor")]),t._v("后置处理器将外部配置属性值绑定到"),s("code",[t._v("XxxProperties")]),t._v("类属性的逻辑委托给"),s("code",[t._v("ConfigurationPropertiesBinder")]),t._v("对象，然后"),s("code",[t._v("ConfigurationPropertiesBinder")]),t._v("对象又最终将属性绑定的逻辑委托给"),s("code",[t._v("Binder")]),t._v("对象来完成。")])]),t._v(" "),s("p",[t._v("可见，重要的是上面的"),s("strong",[t._v("第5步")]),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"_2-引言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-引言"}},[t._v("#")]),t._v(" 2 引言")]),t._v(" "),s("p",[t._v("我们都知道，SpringBoot内置了各种"),s("code",[t._v("Starter")]),t._v("起步依赖，我们使用非常方便，大大减轻了我们的开发工作。有了"),s("code",[t._v("Starter")]),t._v("起步依赖，我们不用去考虑这个项目需要什么库，这个库的"),s("code",[t._v("groupId")]),t._v("和"),s("code",[t._v("artifactId")]),t._v("是什么？更不用担心引入这个版本的库后会不会跟其他依赖有没有冲突。")]),t._v(" "),s("p",[s("strong",[t._v("举个栗子")]),t._v("：现在我们想开发一个web项目，那么只要引入"),s("code",[t._v("spring-boot-starter-web")]),t._v("这个起步依赖就可以了，不用考虑要引入哪些版本的哪些依赖了。像以前我们还要考虑引入哪些依赖库，比如要引入"),s("code",[t._v("spring-web")]),t._v("和"),s("code",[t._v("spring-webmvc")]),t._v("依赖等；此外，还要考虑引入这些库的哪些版本才不会跟其他库冲突等问题。")]),t._v(" "),s("p",[t._v("那么我们今天暂时不分析SpringBoot自动配置的源码，由于起步依赖跟自动配置的关系是如影随形的关系，因此本篇先站在maven项目构建的角度来宏观分析下我们平时使用的"),s("strong",[t._v("SpringBoot内置的各种")]),s("code",[t._v("**Starter**")]),s("strong",[t._v("是怎样构建的？")])]),t._v(" "),s("h2",{attrs:{id:"_3-maven传递依赖的optional标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-maven传递依赖的optional标签"}},[t._v("#")]),t._v(" 3 Maven传递依赖的optional标签")]),t._v(" "),s("p",[t._v("在分析SpringBoot内置的各种"),s("code",[t._v("Starter")]),t._v("构建原理前，我们先来认识下Maven的"),s("code",[t._v("optional")]),t._v("标签，因为这个标签起到至关重要的作用。 Maven的"),s("code",[t._v("optional")]),t._v("标签表示可选依赖即不可传递的意思，下面直接举个栗子来说明。")]),t._v(" "),s("p",[t._v("比如有"),s("code",[t._v("A")]),t._v(","),s("code",[t._v("B")]),t._v("和"),s("code",[t._v("C")]),t._v("三个库，"),s("code",[t._v("C")]),t._v("依赖"),s("code",[t._v("B")]),t._v("，"),s("code",[t._v("B")]),t._v("依赖"),s("code",[t._v("A")]),t._v("。下面看下这三个库的"),s("code",[t._v("pom.xml")]),t._v("文件：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// A的pom.xml")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("xml version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v(" encoding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("project xmlns"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://maven.apache.org/POM/4.0.0"')]),t._v("\n         xmlns"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("xsi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.w3.org/2001/XMLSchema-instance"')]),t._v("\n         xsi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("schemaLocation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ymbj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("A")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SNAPSHOT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("project"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n复制代码\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("xml version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v(" encoding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("project xmlns"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://maven.apache.org/POM/4.0.0"')]),t._v("\n         xmlns"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("xsi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.w3.org/2001/XMLSchema-instance"')]),t._v("\n         xsi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("schemaLocation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ymbj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("B")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SNAPSHOT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("注意是可选依赖"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ymbj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("A")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SNAPSHOT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\t    "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("optional"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("optional"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dependency"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dependencies"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("project"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n复制代码\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("xml version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v(" encoding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("project xmlns"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://maven.apache.org/POM/4.0.0"')]),t._v("\n         xmlns"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("xsi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.w3.org/2001/XMLSchema-instance"')]),t._v("\n         xsi"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("schemaLocation"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n\t"),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ymbj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("C")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SNAPSHOT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ymbj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("groupId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("B")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("artifactId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SNAPSHOT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dependency"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dependencies"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("project"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br")])]),s("p",[t._v("上面三个"),s("code",[t._v("A")]),t._v(","),s("code",[t._v("B")]),t._v("和"),s("code",[t._v("C")]),t._v("库的"),s("code",[t._v("pom.xml")]),t._v("可知，"),s("code",[t._v("B")]),t._v("库依赖"),s("code",[t._v("A")]),t._v("库，然后"),s("code",[t._v("C")]),t._v("库又依赖了"),s("code",[t._v("B")]),t._v("库，那么请想一下，"),s("strong",[t._v("Maven打包构建")]),s("code",[t._v("**C**")]),s("strong",[t._v("库后，")]),s("code",[t._v("**A**")]),s("strong",[t._v("库有没有被引进来？")])]),t._v(" "),s("p",[t._v("答案肯定是"),s("strong",[t._v("没有")]),t._v("，因为"),s("code",[t._v("B")]),t._v("库引入"),s("code",[t._v("A")]),t._v("库依赖时使用了"),s("code",[t._v("<optional>true</optional>")]),t._v("，即将Maven的"),s("code",[t._v("optional")]),t._v("标签值设为了"),s("code",[t._v("true")]),t._v("，此时"),s("code",[t._v("C")]),t._v("库再引入"),s("code",[t._v("B")]),t._v("库依赖时，"),s("code",[t._v("A")]),t._v("库是不会被引入到"),s("code",[t._v("C")]),t._v("库的。")]),t._v(" "),s("p",[t._v("同时跟Maven传递依赖有关的还有一个"),s("code",[t._v("exclusions")]),t._v("标签，这个表示将某个库的某个子依赖排除掉，这里不再详述。")]),t._v(" "),s("h2",{attrs:{id:"_4-springboot内置的各种starter是怎样构建的"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-springboot内置的各种starter是怎样构建的"}},[t._v("#")]),t._v(" 4 SpringBoot内置的各种Starter是怎样构建的？")]),t._v(" "),s("p",[t._v("我们现在来探究SpringBoot内置的各种"),s("code",[t._v("Starter")]),t._v("到底是怎样构建的呢？")]),t._v(" "),s("p",[t._v("还记得"),s("a",{attrs:{href:"https://juejin.cn/post/6844904070818463751",target:"_blank",rel:"noopener noreferrer"}},[t._v("如何分析SpringBoot源码模块及结构？"),s("OutboundLink")],1),t._v("这篇文章分析的SpringBoot内部的模块之间的关系吗？先来回顾一下SpringBoot源码内部模块图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/5022695728261373679fda99556c5c2a.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图1")]),t._v(" "),s("p",[t._v("我们都知道，SpringBoot的"),s("code",[t._v("Starter")]),t._v("的构建的原理实质就是自动配置，因此由图1可以看到SpringBoot源码项目内部跟"),s("code",[t._v("Starter")]),t._v("及其自动配置有关的模块有四个："),s("code",[t._v("spring-boot-starters")]),t._v(","),s("code",[t._v("spring-boot-actuator-autoconfigure")]),t._v(","),s("code",[t._v("spring-boot-autoconfigure")]),t._v("和"),s("code",[t._v("spring-boot-test-autoconfigure")]),t._v("。 每个模块的作用请看"),s("a",{attrs:{href:"https://juejin.cn/post/6844904070818463751",target:"_blank",rel:"noopener noreferrer"}},[t._v("如何分析SpringBoot源码模块及结构？"),s("OutboundLink")],1),t._v("这篇文章，这里不再赘述。")]),t._v(" "),s("p",[t._v("那么，"),s("code",[t._v("spring-boot-starters")]),t._v("模块跟后面三个自动配置有关的模块"),s("code",[t._v("xxx-autoconfigure")]),t._v("模块的关系是怎样的呢？")]),t._v(" "),s("p",[t._v("此时我们先来看看"),s("code",[t._v("spring-boot-starters")]),t._v("模块里面的结构是怎样的？")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/0c5742ee6a7e90694a4959bbd4c695e3.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图2")]),t._v(" "),s("p",[t._v("由图2可以看到"),s("code",[t._v("spring-boot-starters")]),t._v("模块包含了SpringBoot内置的各种"),s("code",[t._v("starter")]),t._v("："),s("code",[t._v("spring-boot-starter-xxx")]),t._v("。由于SpringBoot内置的各种"),s("code",[t._v("starter")]),t._v("太多，以我们常用的"),s("code",[t._v("spring-boot-starter-web")]),t._v("起步依赖来探究好了。")]),t._v(" "),s("p",[t._v("我们首先看下"),s("code",[t._v("spring-boot-starter-web")]),t._v("模块内部结构：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/be1c41065e2f724efbb938ca99b71443.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图3")]),t._v(" "),s("p",[t._v("可以看到"),s("code",[t._v("spring-boot-starter-web")]),t._v("模块里面只有"),s("code",[t._v(".flattened-pom.xml")]),t._v("和"),s("code",[t._v("pom.xml")]),t._v("文件，"),s("strong",[t._v("而没有任何代码")]),t._v("！有点出乎我们意料。我们都知道若要用到SpringBoot的web功能时引入"),s("code",[t._v("spring-boot-starter-web")]),t._v("起步依赖即可，而现在"),s("code",[t._v("spring-boot-starter-web")]),t._v("模块里面没有一行代码，那么"),s("code",[t._v("spring-boot-starter-web")]),t._v("究竟是如何构建的呢？会不会跟图1所示的"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("自动配置模块有关？")]),t._v(" "),s("p",[t._v("此时我们就需要看下"),s("code",[t._v("spring-boot-starter-web")]),t._v("模块的"),s("code",[t._v("pom.xml")]),t._v("文件内容：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/947159bb161815d87d5a585e9273183f.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图4")]),t._v(" "),s("p",[t._v("由图4可以看到，"),s("code",[t._v("spring-boot-starter-web")]),t._v("模块依赖了"),s("code",[t._v("spring-boot-starter")]),t._v(","),s("code",[t._v("spring-boot-starter-tomcat")]),t._v(","),s("code",[t._v("spring-web")]),t._v("和"),s("code",[t._v("spring-webmvc")]),t._v("等模块，居然没有依赖"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("自动配置模块!")]),t._v(" "),s("p",[t._v("由于"),s("code",[t._v("spring-boot-starter-web")]),t._v("模块肯定跟"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("自动配置模块有关，所以"),s("code",[t._v("spring-boot-starter-web")]),t._v("模块肯定是间接依赖了"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("自动配置模块。")]),t._v(" "),s("p",[t._v('图4标有标注"重点关注"的'),s("code",[t._v("spring-boot-starter")]),t._v("模块是绝大部分"),s("code",[t._v("spring-boot-starter-xxx")]),t._v("模块依赖的基础模块，是核心的"),s("code",[t._v("Starter")]),t._v("，包括了自动配置，日志和"),s("code",[t._v("YAML")]),t._v("支持。我们此时来关注下"),s("code",[t._v("spring-boot-starter")]),t._v("的"),s("code",[t._v("pom.xml")]),t._v("文件，也许其依赖了了"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("自动配置模块。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/74770c7144609c004f4a9c86b3eb38d4.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图5")]),t._v(" "),s("p",[t._v("由图5可以看到，我们前面的猜想没有错，"),s("strong",[t._v("正是")]),s("code",[t._v("**spring-boot-starter**")]),s("strong",[t._v("模块依赖了")]),s("code",[t._v("**spring-boot-autoconfigure**")]),t._v("**自动配置模块！***"),s("em",[s("strong",[t._v("因此，到了这里我们就可以得出结论了：")])]),s("code",[t._v("***spring-boot-starter-web***")]),s("em",[s("strong",[t._v("模块没有一行代码，但是其通过")])]),s("code",[t._v("***spring-boot-starter***")]),t._v("***模块****"),s("strong",[t._v("间接")]),t._v("依赖了"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("自动配置模块，从而实现了其起步依赖的功能。")]),t._v(" "),s("p",[t._v("此时我们再来看下"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("自动配置模块的内部包结构：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/fcb8e73aa3eaf1171c102f858453b474.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图6")]),t._v(" "),s("p",[t._v("由图6红框处，我们可以知道"),s("code",[t._v("spring-boot-starter-web")]),t._v("起步依赖的自动配置功能原来是由"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("模块的"),s("code",[t._v("web")]),t._v("包下的类实现的。")]),t._v(" "),s("p",[t._v("到了这里"),s("code",[t._v("spring-boot-starter-web")]),t._v("起步依赖的构建基本原理我们就搞清楚了，但是还有一个特别重要的关键点我们还没Get到。这个关键点跟Maven的"),s("code",[t._v("optional")]),t._v("标签有的作用有关。")]),t._v(" "),s("p",[t._v("为了Get到这个点，我们先来思考一个问题：平时我们开发"),s("code",[t._v("web")]),t._v("项目为什么引入了"),s("code",[t._v("spring-boot-starter-web")]),t._v("这个起步依赖后，"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("模块的"),s("code",[t._v("web")]),t._v("相关的自动配置类就会起自动起作用呢？")]),t._v(" "),s("p",[t._v("我们应该知道，某个自动配置类起作用往往是由于"),s("code",[t._v("classpath")]),t._v("中存在某个类，这里以"),s("code",[t._v("DispatcherServletAutoConfiguration")]),t._v("这个自动配置类为切入点去Get这个点好了。 先看下"),s("code",[t._v("DispatcherServletAutoConfiguration")]),t._v("能够自动配置的条件是啥？")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/a5d25e066adbe8986d2d3bbc2be7e613.webp?x-oss-process=image/format,png",alt:"img"}})]),t._v(" "),s("p",[t._v("图7")]),t._v(" "),s("p",[t._v("由图7所示，"),s("code",[t._v("DispatcherServletAutoConfiguration")]),t._v("能够自动配置的条件之一是"),s("code",[t._v("@ConditionalOnClass(DispatcherServlet.class)")]),t._v("，即只有"),s("code",[t._v("classpath")]),t._v("中存在"),s("code",[t._v("DispatcherServlet.class")]),t._v("这个类，那么"),s("code",[t._v("DispatcherServletAutoConfiguration")]),t._v("自动配置相关逻辑才能起作用。")]),t._v(" "),s("p",[t._v("而"),s("code",[t._v("DispatcherServlet")]),t._v("这个类是在"),s("code",[t._v("spring-webmvc")]),t._v("这个依赖库中的，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/f9787c27dc0410f9443018b4b0566aa7.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图8")]),t._v(" "),s("p",[t._v("此时我们再看下"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("模块的"),s("code",[t._v("pom.xml")]),t._v("文件引入"),s("code",[t._v("spring-webmvc")]),t._v("这个依赖的情况：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/7a4a3c1268add74cd59202a32a92d551.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图9")]),t._v(" "),s("p",[t._v("由图9所示，"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("模块引入的"),s("code",[t._v("spring-webmvc")]),t._v("这个依赖时"),s("code",[t._v("optional")]),t._v("被设置为"),s("code",[t._v("true")]),t._v("，原来是可选依赖。即"),s("code",[t._v("spring-webmvc")]),t._v("这个依赖库只会被导入到"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("模块中，而不会被导入到间接依赖"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("模块的"),s("code",[t._v("spring-boot-starter-web")]),t._v("这个起步依赖中。")]),t._v(" "),s("p",[t._v("此时，我们再来看看"),s("code",[t._v("spring-boot-starter-web")]),t._v("的"),s("code",[t._v("pom.xml")]),t._v("文件的依赖情况：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/18889b6e01000a053b7130a6caba29a8.webp",alt:"img"}})]),t._v(" "),s("p",[t._v("图10")]),t._v(" "),s("p",[t._v("由图10所示，"),s("code",[t._v("spring-boot-starter-web")]),t._v("起步依赖"),s("strong",[t._v("显式")]),t._v("引入了"),s("code",[t._v("spring-webmvc")]),t._v("这个依赖库，即引入"),s("code",[t._v("spring-webmvc")]),t._v("  时没有"),s("code",[t._v("optional")]),t._v("这个标签，又因为"),s("code",[t._v("DispatcherServlet")]),t._v("这个类是在"),s("code",[t._v("spring-webmvc")]),t._v("这个依赖库中的,从而"),s("code",[t._v("classpath")]),t._v("中存在"),s("code",[t._v("DispatcherServlet")]),t._v("这个类，因此"),s("code",[t._v("DispatcherServletAutoConfiguration")]),t._v("这个自动配置类就生效了。当然，"),s("code",[t._v("web")]),t._v("相关的其他自动配置类生效也是这个原理。")]),t._v(" "),s("p",[t._v("至此，我们也明白了"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("模块为什么要把引入的"),s("code",[t._v("spring-webmvc")]),t._v("这个依赖作为可选依赖了，其目的就是为了在"),s("code",[t._v("spring-boot-starter-web")]),t._v("起步依赖中能显式引入"),s("code",[t._v("spring-webmvc")]),t._v("这个依赖（这个起决定性作用），从而我们开发web项目只要引入了"),s("code",[t._v("spring-boot-starter-web")]),t._v("起步依赖，那么web相关的自动配置类就生效，从而可以开箱即用这个就是"),s("code",[t._v("spring-boot-starter-web")]),t._v("这个起步依赖的构建原理了。")]),t._v(" "),s("p",[t._v("前面提到的"),s("code",[t._v("spring-boot-starter-actuator")]),t._v(","),s("code",[t._v("spring-boot-starter-test")]),t._v("及其他内置的"),s("code",[t._v("spring-boot-starter-xxx")]),t._v("的起步依赖的构建原理也是如此，只不过"),s("code",[t._v("spring-boot-starter-actuator")]),t._v("依赖的是"),s("code",[t._v("spring-boot-actuator-autoconfigure")]),t._v("，"),s("code",[t._v("spring-boot-starter-test")]),t._v("依赖的是"),s("code",[t._v("spring-boot-test-autoconfigure")]),t._v("模块罢了，这里不再详述。")]),t._v(" "),s("p",[s("strong",[t._v("思考")]),t._v("："),s("code",[t._v("spring-boot-actuator-autoconfigure")]),t._v("的"),s("code",[t._v("pom.xml")]),t._v("文件引入了20多个可选依赖，而为什么"),s("code",[t._v("spring-boot-starter-actuator")]),t._v("起步依赖只引入了"),s("code",[t._v("micrometer-core")]),t._v("这个依赖呢？")]),t._v(" "),s("h2",{attrs:{id:"_5-模仿springboot包结构自定义一个starter"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-模仿springboot包结构自定义一个starter"}},[t._v("#")]),t._v(" 5 模仿SpringBoot包结构自定义一个Starter")]),t._v(" "),s("p",[t._v("前面分析了SpringBoot内置的各种"),s("code",[t._v("Starter")]),t._v("的构建原理，理论联系实践，那么如果能够动手实践一下自定义"),s("code",[t._v("Starter")]),t._v("那就更好了。")]),t._v(" "),s("p",[t._v("下面提供一个自定义"),s("code",[t._v("Starter")]),t._v("的一个简单"),s("code",[t._v("Demo")]),t._v("，这个"),s("code",[t._v("Demo")]),t._v("完全模仿"),s("code",[t._v("SpringBoot")]),t._v("内置"),s("code",[t._v("Starter")]),t._v("的内部包结构来编写，对于进一步了解SpringBoot内置的各种"),s("code",[t._v("Starter")]),t._v("的构建原理很有帮助。")]),t._v(" "),s("p",[t._v("下面是这个"),s("code",[t._v("Demo")]),t._v("的github地址，推荐给有兴趣的小伙伴们。 "),s("a",{attrs:{href:"https://github.com/jinyue233/mock-spring-boot-autoconfiguration",target:"_blank",rel:"noopener noreferrer"}},[t._v("模仿springboot内部结构自定义Starter"),s("OutboundLink")],1),t._v("。此外，如何自定义一个"),s("code",[t._v("Starter")]),t._v("，可以参考下Mybatis的"),s("a",{attrs:{href:"https://github.com/mybatis/spring-boot-starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("spring-boot-starter"),s("OutboundLink")],1),t._v("是如何编写的。")]),t._v(" "),s("h2",{attrs:{id:"_6-小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-小结"}},[t._v("#")]),t._v(" 6 小结")]),t._v(" "),s("p",[t._v("好了，SpringBoot内置的各种"),s("code",[t._v("Starter")]),t._v("的构建原理分析就到此结束了，现将关键点总结下：")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("spring-boot-starter-xxx")]),t._v("起步依赖没有一行代码，而是直接或间接依赖了"),s("code",[t._v("xxx-autoconfigure")]),t._v("模块，而"),s("code",[t._v("xxx-autoconfigure")]),t._v("模块承担了"),s("code",[t._v("spring-boot-starter-xxx")]),t._v("起步依赖自动配置的实现；")]),t._v(" "),s("li",[s("code",[t._v("xxx-autoconfigure")]),t._v("自动配置模块引入了一些可选依赖，这些可选依赖不会被传递到"),s("code",[t._v("spring-boot-starter-xxx")]),t._v("起步依赖中，这是起步依赖构建的"),s("strong",[t._v("关键点")]),t._v("；")]),t._v(" "),s("li",[s("code",[t._v("spring-boot-starter-xxx")]),t._v("起步依赖"),s("strong",[t._v("显式")]),t._v("引入了一些对自动配置起作用的可选依赖；")]),t._v(" "),s("li",[t._v("经过前面3步的准备，我们项目只要引入了某个起步依赖后，就可以开箱即用了，而不用手动去创建一些"),s("code",[t._v("bean")]),t._v("等。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);