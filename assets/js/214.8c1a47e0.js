(window.webpackJsonp=window.webpackJsonp||[]).push([[214],{564:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"å­¦ä¹ æ–¹æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å­¦ä¹ æ–¹æ³•"}},[s._v("#")]),s._v(" "),a("strong",[s._v("å­¦ä¹ æ–¹æ³•")])]),s._v(" "),a("p",[s._v("ç”¨äºæ‰¿è½½ HTTP è¯·æ±‚è½¬æ¢åè®®æ³›åŒ–è°ƒç”¨ RPC æœåŠ¡çš„ç½‘å…³ç®—åŠ›ä¸å¯èƒ½åªæœ‰ä¸€ç»„æœåŠ¡ï¼Œè€Œæ˜¯ä¸€ä¸ªç½‘å…³ç®—åŠ›é›†ç¾¤åŒ–çš„è®¾è®¡å®ç°ã€‚è€Œå¯¹äºè¿™æ ·ä¸€ä¸ªè¯‰æ±‚çš„å®ç°ï¼ŒåŸºæœ¬çš„æ ¸å¿ƒæ¨¡å‹ç»“æ„å°±æ˜¯è´Ÿè½½çš„é…ç½®å’Œè½®è®­ç­–ç•¥çš„ä½¿ç”¨ã€‚è€Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šåœ¨ç¬¬25ç« å…ˆè¿›è¡Œ Nginx çš„è´Ÿè½½æ¨¡å‹æ„å»ºã€‚é‚£ä¹ˆåœ¨æœ¬ç« å°†ç»§ç»­å¸¦ç€å¤§å®¶æ‰©å±•è¿™éƒ¨åˆ†å†…å®¹ï¼Œè®©Nginxå¯ä»¥è¢«åŠ¨æ€çš„å˜æ›´å¹¶é‡è½½é…ç½®æ–‡ä»¶ã€‚è¿™æ ·å°±å¯ä»¥æ»¡è¶³å½“æœ‰æ–°çš„ç½‘å…³æ³¨å†Œã€ä¸‹çº¿ã€è°ƒæ•´æ—¶å¯ä»¥è‡ªåŠ¨çš„ç”Ÿæ•ˆNginxé…ç½®ã€‚")]),s._v(" "),a("h2",{attrs:{id:"æ–¹æ¡ˆè®¾è®¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆè®¾è®¡"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ–¹æ¡ˆè®¾è®¡")])]),s._v(" "),a("p",[s._v("åŠ¨æ€åˆ·æ–°è´Ÿè½½é…ç½®ç­–ç•¥çš„å®æ–½æ–¹æ¡ˆä¼šå—åˆ°æœåŠ¡éƒ¨ç½²æ–¹å¼çš„å½±å“ï¼Œæœ¬æ–‡ä»¥æœåŠ¡åœ¨Dockerå®¹å™¨ä¸­éƒ¨ç½²ä¸ºä¾‹ï¼Œé€šè¿‡Javaè°ƒç”¨å®¹å™¨å‘½ä»¤æ¥æ‰§è¡Œåˆ·æ–°æ“ä½œã€‚ä»¥ä¸‹æ˜¯æ–¹æ¡ˆçš„è¯¦ç»†è®¾è®¡ï¼š")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-blogs/image-20231007102813768.png",alt:"image-20231007102813768"}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("åœ¨è¿›è¡Œç½‘å…³ç®—åŠ›çš„åŠ¨æ€é…ç½®å’Œåˆ·æ–°æ—¶ï¼Œéœ€è¦è€ƒè™‘æ ¹æ®æœåŠ¡çš„æ³¨å†Œæ¥åŠ¨æ€æ›´æ–°Nginxé…ç½®æ–‡ä»¶å¹¶ä½¿å…¶ç”Ÿæ•ˆã€‚è¿™å°†æ¶‰åŠåˆ°Nginxé…ç½®æ–‡ä»¶çš„ä¿®æ”¹å’Œåˆ·æ–°ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡Javaç¨‹åºè¿›è¡Œæ§åˆ¶çš„é—®é¢˜ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("ä¸¾ä¾‹æ¥è¯´ï¼Œè€ƒè™‘å½“å‰çš„æœåŠ¡éƒ¨ç½²åœ¨Dockerå®¹å™¨ä¸­ã€‚Dockeræ˜¯åµŒå¥—åœ¨LinuxæœåŠ¡å™¨å†…çš„ï¼Œæ¯ä¸ªé•œåƒå®ä¾‹éƒ½åœ¨éš”ç¦»çš„ç¯å¢ƒä¸­è¿è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè§£å†³çš„å…³é”®é—®é¢˜æ˜¯å¦‚ä½•å®ç°é…ç½®æ–‡ä»¶çš„äº’é€šå’ŒæŒ‡ä»¤çš„è°ƒç”¨ã€‚")])])]),s._v(" "),a("h2",{attrs:{id:"æ–¹æ¡ˆå®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆå®ç°"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ–¹æ¡ˆå®ç°")])]),s._v(" "),a("p",[s._v("å¯¹äºæ–¹æ¡ˆè®¾è®¡ä¸­æåˆ°çš„é—®é¢˜ï¼Œæˆ‘ä»¬åšå‡ºå¯¹åº”çš„å®ç°ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("é—®é¢˜1ï¼šNginx çš„é…ç½®æ–‡ä»¶å¦‚ä½•è¢«å…¶ä»–åº”ç”¨ç¨‹åºè·å–å¹¶ä¿®æ”¹ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°æ–‡ä»¶æŒ‚è½½æ“ä½œã€‚æˆ‘ä»¬æŠŠå­˜æ”¾åœ¨ Linux æœåŠ¡å™¨ä¸Šçš„ "),a("a",{attrs:{href:"http://nginx.conf/",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx.conf"),a("OutboundLink")],1),s._v(" æ‰€åœ¨çš„æ–‡ä»¶å¤¹ğŸ“‚æŒ‚åœ¨åˆ° api-gateway-center ä¸Šï¼Œä¹‹åæŠŠ "),a("a",{attrs:{href:"http://nginx.conf/",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx.conf"),a("OutboundLink")],1),s._v(" é…ç½®æ–‡ä»¶æŒ‚åœ¨ Nginx æœåŠ¡ä¸Šã€‚è¿™æ ·å°±æ‰“é€šç¬¬ä¸€ä¸ªè¦è§£å†³çš„é…ç½®æ–‡ä»¶é—®é¢˜ã€‚ä¹‹åå† api-gateway-center æœåŠ¡ä¸Šå°±å¯ä»¥é€šè¿‡ IO æµæ›´æ–° "),a("a",{attrs:{href:"http://nginx.conf/",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx.conf"),a("OutboundLink")],1),s._v(" æ–‡ä»¶ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("é—®é¢˜2ï¼šå¦‚ä½•é€šè¿‡ api-gateway-center ç¨‹åºå¯¹ Nginx è¿›è¡Œè°ƒç”¨ã€‚è¿™é‡Œå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨ Docker åœºæ™¯ä¸‹ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡ Java æ§åˆ¶å¹¶è·å– Docker å®¹å™¨ä¸­ Nginx çš„æœåŠ¡ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ“ä½œã€‚è¿™é‡Œè¿˜ä¼šæ¶‰åŠåˆ°ç½‘ç»œçš„é—®é¢˜ï¼Œå¦åˆ™åœ¨å®¹å™¨ä¸­æœåŠ¡1ä¸èƒ½è°ƒç”¨æœåŠ¡2ã€‚")])])]),s._v(" "),a("h3",{attrs:{id:"nginx-é…ç½®æœåŠ¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-é…ç½®æœåŠ¡"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Nginx é…ç½®æœåŠ¡")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿è¡Œæ–°çš„å®¹å™¨")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" Nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /opt/api-gateway/api-gateway-center/doc/data/html:/usr/share/nginx/html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /opt/api-gateway/api-gateway-center/doc/data/nginx/nginx.conf:/etc/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),s._v(":80 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nnginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[s._v("nginx é…ç½®ä¸Šä¸€ç« å·²ç»è®²è§£è¿‡æ–‡ä»¶çš„æŒ‚è½½ï¼Œå¯ä»¥å›åˆ°å¯¹åº”ç« èŠ‚å‚è€ƒã€‚")])]),s._v(" "),a("h3",{attrs:{id:"åˆ·æ–°æ–‡ä»¶å»ºæ¨¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ·æ–°æ–‡ä»¶å»ºæ¨¡"}},[s._v("#")]),s._v(" "),a("strong",[s._v("åˆ·æ–°æ–‡ä»¶å»ºæ¨¡")])]),s._v(" "),a("p",[s._v("æ›´æ–°Nginxçš„é…ç½®ï¼Œéœ€è¦å…ˆé€šè¿‡Javaç¨‹åºåˆ›å»ºæˆ–è€…æ›´æ–°Nginxé…ç½®ï¼Œä¹‹åå†å¯åŠ¨åˆ·æ–°æŒ‡ä»¤ã€‚è¿™æ®µåŠŸèƒ½é€»è¾‘ä»£ç ä½¿ç”¨æ¨¡æ¿æ¨¡å¼ï¼Œæ¥å®šä¹‰æ ‡å‡†çš„æ‰§è¡Œæµç¨‹ï¼Œå¹¶åšå®ç°ã€‚")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("abstract")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AbstractLoadBalancing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ILoadBalancingService")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger")]),s._v(" logger "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LoggerFactory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getLogger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AbstractLoadBalancing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateNginxConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NginxConfig")]),s._v(" nginxConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1. åˆ›å»º Nginx é…ç½®æ–‡ä»¶")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" nginxConfigFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("createNginxConfigFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nginxConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"æ­¥éª¤1ï¼šåˆ›å»º Nginx é…ç½®æ–‡ä»¶ containerFilePathï¼š{}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nginxConfigFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2. å¤åˆ¶ Nginx é…ç½®æ–‡ä»¶")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// copyDockerFile(nginxConfig.getApplicationName(), containerFilePath, nginxConfig.getLocalNginxPath());")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// logger.info("æ­¥éª¤2ï¼šæ‹·è´ Nginx é…ç½®æ–‡ä»¶ localPathï¼š{}", nginxConfig.getLocalNginxPath());')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3. åˆ·æ–° Nginx é…ç½®æ–‡ä»¶")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("refreshNginxConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nginxConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getNginxName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"æ­¥éª¤2ï¼šåˆ·æ–° Nginx é…ç½®æ–‡ä»¶ Doneï¼"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("abstract")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("createNginxConfigFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NginxConfig")]),s._v(" nginxConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("abstract")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("copyDockerFile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" applicationName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" containerFilePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" localNginxPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("abstract")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("refreshNginxConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" nginxName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("å®ç°æµç¨‹åˆ†ä¸º3å—ï¼ŒåŒ…æ‹¬ï¼›æ–‡ä»¶çš„åˆ›å»ºã€æ–‡ä»¶çš„å¤åˆ¶ã€æ–‡ä»¶çš„åˆ·æ–°ã€‚ä½†é‰´äºæˆ‘ä»¬å·²ç»é€šè¿‡æ–‡ä»¶çš„æŒ‚åœ¨åˆ°ç›¸åŒç›®å½•ä¸‹ï¼Œè§£å†³äº†å¤åˆ¶ "),a("code",[s._v("Docker")]),s._v(" åº”ç”¨ç¨‹åºåˆ›å»ºå‡ºæ¥çš„ "),a("code",[s._v("Nginx")]),s._v("  é…ç½®æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸éœ€è¦è‡ªå·±åœ¨å¤åˆ¶äº†ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("æ–‡ä»¶åˆ·æ–°é…ç½®ä¼šæ¶‰åŠåˆ°é•œåƒå®¹å™¨éƒ¨ç½²çš„ä¸€äº›æŒ‡ä»¤ï¼Œåœ¨ä¸‹æ–‡ä¸­ä¼šæœ‰ä½“ç°ã€‚")])])]),s._v(" "),a("h3",{attrs:{id:"åˆ·æ–°æ–‡ä»¶å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ·æ–°æ–‡ä»¶å®ç°"}},[s._v("#")]),s._v(" "),a("strong",[s._v("åˆ·æ–°æ–‡ä»¶å®ç°")])]),s._v(" "),a("p",[s._v("æœ¬èº«éƒ¨ç½²åœ¨ Docker å®¹å™¨çš„ Nginx æ–‡ä»¶ï¼Œåœ¨åˆ·æ–°æ—¶å€™éœ€è¦é€šè¿‡æŒ‡ä»¤ï¼›"),a("code",[s._v("docker exec Nginx nginx -s rolad")]),s._v(" é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬é€šè¿‡ Java ç¨‹åºæ§åˆ¶ï¼Œå°±éœ€è¦è¿æ¥ Docker å®¹å™¨ï¼Œæ‰¾åˆ°å¯¹åº”çš„æœåŠ¡ï¼Œåœ¨æ‰§è¡Œå®¹å™¨æŒ‡ä»¤ã€‚")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("refreshNginxConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" nginxName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Docker client")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DockerClientConfig")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DefaultDockerClientConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("createDefaultConfigBuilder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("withDockerHost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix:///var/run/docker.sock"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DockerClient")]),s._v(" dockerClient "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DockerClientBuilder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" containerId "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dockerClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("listContainersCmd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("withNameFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nginxName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExecCreateCmdResponse")]),s._v(" execCreateCmdResponse "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dockerClient\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("execCreateCmd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("containerId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("withCmd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-s"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reload"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    dockerClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("execStartCmd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("execCreateCmdResponse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ResultCallback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Adapter")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awaitCompletion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    dockerClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("ul",[a("li",[s._v("è¿™ä¸€æ®µä»£ç ä¸­åŒ…æ‹¬äº†è¿æ¥çš„åˆ›å»ºã€æœåŠ¡çš„æŸ¥æ‰¾ã€æŒ‡ä»¤çš„æ‰§è¡Œå’Œå…³é—­è¿æ¥çš„æ“ä½œã€‚ä½ ä¹Ÿå¯ä»¥åªåšå•å…ƒæµ‹è¯•è¿›è¡Œã€‚NginxTest ç±»ä¸­æœ‰å¯¹åº”çš„ä»£ç ã€‚")])]),s._v(" "),a("h3",{attrs:{id:"åº”ç”¨å®¹å™¨éƒ¨ç½²"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åº”ç”¨å®¹å™¨éƒ¨ç½²"}},[s._v("#")]),s._v(" "),a("strong",[s._v("åº”ç”¨å®¹å™¨éƒ¨ç½²")])]),s._v(" "),a("p",[s._v("è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œä¸ºäº†å¼€å¯Dockerå®¹å™¨ä¸­çš„Javaåº”ç”¨è¿æ¥Dockerï¼Œéœ€è¦å¼€å¯å¯¹åº”çš„ç½‘ç»œæœåŠ¡ã€‚è¿™ä¸ªæœåŠ¡åœ¨é…ç½®å®¹å™¨æ—¶å³å¯å¼€å¯ï¼›")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#å¯åŠ¨")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8001")]),s._v(":8001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /opt/api-gateway/api-gateway-center/doc/data/nginx:/data/nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /var/run/docker.sock:/var/run/docker.sock "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" api-gateway-center "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.19/api-gateway/api-gateway-center:1.0.0 CP4-LISTEN:8001,fork,reuseaddr UNIX-CONNECT:/var/run/docker.sock TCP4-LISTEN:8001,fork,reuseaddr UNIX-CONNECT:/var/run/docker.sock\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#åœæ­¢å¹¶åˆ é™¤å®¹å™¨å’Œå®¹å™¨é•œåƒ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop api-gateway-center "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" api-gateway-center "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.19/api-gateway/api-gateway-center:1.0.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("-v è®¾ç½®å¯¹åº”çš„æŒ‚åœ¨æ–‡ä»¶å¤¹å’Œdockerçš„æ˜ å°„æ–‡ä»¶")])]),s._v(" "),a("li",[a("p",[s._v("å¦å¤–è¿˜éœ€è¦å¼€å¯ç›‘å¬ç«¯å£ï¼Œå¦åˆ™ä¸èƒ½åœ¨dockerå®¹å™¨ä¸­çš„javaåº”ç”¨å¯¹å¦å¤–ä¸€ä¸ªæœåŠ¡æ“ä½œã€‚")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("CP4-LISTEN")]),s._v("ï¼šè¿™ä¸ªå‘½ä»¤é€šå¸¸ç”¨äºè®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œç›‘å¬ç«¯å£ï¼Œä»¥ä¾¿å®¹å™¨å†…çš„åº”ç”¨ç¨‹åºå¯ä»¥æ¥å—ä¼ å…¥çš„è¿æ¥ã€‚å®ƒçš„è¯­æ³•å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CP4-LISTEN:<ç«¯å£å·>,<é€‰é¡¹>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("code",[s._v("<ç«¯å£å·>")]),s._v("ï¼šæŒ‡å®šè¦ç›‘å¬çš„ç«¯å£å·ã€‚")]),s._v(" "),a("li",[a("code",[s._v("<é€‰é¡¹>")]),s._v('ï¼šå¯ä»¥åŒ…æ‹¬ä¸€äº›é€‰é¡¹ï¼Œå¦‚ "fork"ï¼ˆåˆ†å‰å¤„ç†è¿æ¥ï¼‰å’Œ "reuseaddr"ï¼ˆé‡ç”¨åœ°å€ï¼‰ã€‚è¿™äº›é€‰é¡¹é€šå¸¸æ ¹æ®åº”ç”¨ç¨‹åºçš„éœ€æ±‚è¿›è¡Œè®¾ç½®ã€‚')])]),s._v(" "),a("p",[s._v("ç¤ºä¾‹ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("CP4-LISTEN:8000,fork,reuseaddr\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("TCP4-LISTEN")]),s._v("ï¼šä¸ "),a("code",[s._v("CP4-LISTEN")]),s._v(" ç±»ä¼¼ï¼Œè¿™ä¸ªå‘½ä»¤ç”¨äºè®¾ç½®TCPç½‘ç»œç›‘å¬ã€‚å®ƒçš„è¯­æ³•ä¹ŸåŒ…æ‹¬ç«¯å£å·å’Œé€‰é¡¹ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("TCP4-LISTEN:<ç«¯å£å·>,<é€‰é¡¹>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("code",[s._v("<ç«¯å£å·>")]),s._v("ï¼šæŒ‡å®šè¦ç›‘å¬çš„TCPç«¯å£å·ã€‚")]),s._v(" "),a("li",[a("code",[s._v("<é€‰é¡¹>")]),s._v('ï¼šå¯ä»¥åŒ…æ‹¬ä¸€äº›é€‰é¡¹ï¼Œå¦‚ "fork"ï¼ˆåˆ†å‰å¤„ç†è¿æ¥ï¼‰å’Œ "reuseaddr"ï¼ˆé‡ç”¨åœ°å€ï¼‰ï¼Œæ ¹æ®åº”ç”¨ç¨‹åºçš„éœ€æ±‚è¿›è¡Œè®¾ç½®ã€‚')])]),s._v(" "),a("p",[s._v("ç¤ºä¾‹ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("TCP4-LISTEN:8080,reuseaddr\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("blockquote",[a("p",[s._v("Docker å¼€å¯ 2375 ç«¯å£ï¼Œå¹¶ä¸”åªå…è®¸æŸäº›æŒ‡å®šçš„ip æ‰èƒ½è®¿é—®ã€‚")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/lib/systemd/system/docker.service\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("notify\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the default is not to use systemd for cgroups because the delegate issues still")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exists and systemd currently does not support the cgroup feature set required")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# for containers run by docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock # æ³¨æ‰")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" tcp://0.0.0.0:2375 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" unix:///var/run/docker.sock    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ–°å¢  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecReload")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/bin/kill "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" HUP "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MAINPID")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TimeoutSec")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("RestartSec")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#é‡å¯")]),s._v("\nsystemctl daemon-reload\nsystemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker -H tcp://192.168.1.19:2375 version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("ä¸€ç§å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨"),a("code",[s._v("iptables-save")]),s._v("å’Œ"),a("code",[s._v("iptables-restore")]),s._v("å‘½ä»¤æ¥ä¿å­˜å’ŒåŠ è½½è§„åˆ™ã€‚ä¸‹é¢æ˜¯å¦‚ä½•æ‰§è¡Œè¿™äº›æ“ä½œçš„æ­¥éª¤ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" INPUT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dport")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4610")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.107 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" INPUT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dport")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4610")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.216 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" INPUT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dport")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4610")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.218 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" INPUT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dport")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4610")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.18 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" ACCEPT\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" INPUT "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dport")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4610")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j")]),s._v(" DROP\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",[a("li",[a("p",[a("strong",[s._v("ä¿å­˜è§„åˆ™")]),s._v("ï¼š")]),s._v(" "),a("p",[s._v("ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†å½“å‰çš„"),a("code",[s._v("iptables")]),s._v("è§„åˆ™ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables-save "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/iptables/rules.v4  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# IPv4è§„åˆ™")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ip6tables-save "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/iptables/rules.v6  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# IPv6è§„åˆ™ï¼ˆå¦‚æœé€‚ç”¨ï¼‰")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("è¿™å°†æŠŠè§„åˆ™ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("åŠ è½½è§„åˆ™")]),s._v("ï¼š")]),s._v(" "),a("p",[s._v("å½“ç³»ç»Ÿé‡æ–°å¯åŠ¨åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†ä¿å­˜çš„è§„åˆ™åŠ è½½å›æ¥ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables-restore "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /etc/iptables/rules.v4  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# IPv4è§„åˆ™")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ip6tables-restore "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /etc/iptables/rules.v6  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# IPv6è§„åˆ™ï¼ˆå¦‚æœé€‚ç”¨ï¼‰")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("è¿™å°†ä»æŒ‡å®šçš„æ–‡ä»¶ä¸­åŠ è½½è§„åˆ™ï¼Œä»¥ä¾¿å®ƒä»¬åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åº”ç”¨ã€‚")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("è‡ªåŠ¨åŠ è½½è§„åˆ™")]),s._v("ï¼š")]),s._v(" "),a("p",[s._v("è¦åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½è§„åˆ™ï¼Œä½ å¯ä»¥å°†åŠ è½½è§„åˆ™çš„å‘½ä»¤æ·»åŠ åˆ°å¯åŠ¨è„šæœ¬ä¸­ã€‚åœ¨ä¸åŒçš„Linuxå‘è¡Œç‰ˆä¸Šï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ–¹æ³•æ¥å®ç°è‡ªåŠ¨åŠ è½½è§„åˆ™ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("Ubuntu")]),s._v("ï¼šä½¿ç”¨"),a("code",[s._v("iptables-persistent")]),s._v("è½¯ä»¶åŒ…æ¥ä¿å­˜å’ŒåŠ è½½è§„åˆ™ã€‚")]),s._v(" "),a("p",[s._v("å®‰è£…è½¯ä»¶åŒ…ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" iptables-persistent\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œä½ å°†è¢«æç¤ºä¿å­˜å½“å‰çš„è§„åˆ™ã€‚ä»¥åï¼Œè§„åˆ™å°†åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ã€‚")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("CentOS/RHEL")]),s._v("ï¼šåœ¨"),a("code",[s._v("/etc/rc.d/rc.local")]),s._v("æ–‡ä»¶ä¸­æ·»åŠ åŠ è½½è§„åˆ™çš„å‘½ä»¤ï¼Œç¡®ä¿æ–‡ä»¶å…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v(" /etc/rc.d/rc.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åŠ è½½iptablesè§„åˆ™")]),s._v("\n/sbin/iptables-restore "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /etc/iptables/rules.v4\n/sbin/ip6tables-restore "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /etc/iptables/rules.v6\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("ç„¶åï¼Œä¸ºæ–‡ä»¶èµ‹äºˆå¯æ‰§è¡Œæƒé™ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/rc.d/rc.local\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])]),s._v(" "),a("p",[s._v("è¯·æ ¹æ®ä½ ä½¿ç”¨çš„Linuxå‘è¡Œç‰ˆé€‰æ‹©é€‚åˆçš„æ–¹æ³•ï¼Œå¹¶æ ¹æ®éœ€è¦è°ƒæ•´è§„åˆ™æ–‡ä»¶çš„è·¯å¾„å’Œåç§°ã€‚")])])])])])]),s._v(" "),a("h2",{attrs:{id:"æµ‹è¯•éªŒè¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æµ‹è¯•éªŒè¯"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æµ‹è¯•éªŒè¯")])]),s._v(" "),a("p",[s._v("å‡†å¤‡äº‹é¡¹ï¼›")]),s._v(" "),a("ol",[a("li",[s._v("ä½¿ç”¨ "),a("code",[s._v("Java WebSocke")]),s._v("t æ¨¡æ‹Ÿ3ç»„ API æœåŠ¡ã€‚ä¸ªäººæµ‹è¯•æ³¨æ„IPå˜æ›´")]),s._v(" "),a("li",[s._v("åœ¨ Docker å®¹å™¨é…ç½®å¥½ Nginx æœåŠ¡ï¼Œå¹¶ç¡®å®šæŒ‚è½½æ–‡ä»¶ "),a("a",{attrs:{href:"http://nginx.conf/",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx.conf"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("åœ¨ Docker å®¹å™¨ï¼Œæ‰“åŒ…ã€éƒ¨ç½² api-gateway-center æœåŠ¡ï¼Œè®°å¾—è¦åšå…ˆæ„å»ºå†æ‰“åŒ…å†éƒ¨ç½²ã€‚éƒ¨ç½²çš„æ—¶å€™ä½¿ç”¨ä¸Šæ–‡æåˆ°çš„æŒ‡ä»¤ã€‚")])]),s._v(" "),a("h3",{attrs:{id:"_3å¥—-api-æ¨¡æ‹ŸæœåŠ¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3å¥—-api-æ¨¡æ‹ŸæœåŠ¡"}},[s._v("#")]),s._v(" "),a("strong",[s._v("3å¥— API æ¨¡æ‹ŸæœåŠ¡")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-blogs/image-20231007150649656.png",alt:"image-20231007150649656"}})]),s._v(" "),a("h3",{attrs:{id:"nginx-åˆå§‹é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-åˆå§‹é…ç½®"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Nginx åˆå§‹é…ç½®")])]),s._v(" "),a("div",{staticClass:"language-nginx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v("  nginx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_processes")]),s._v("  auto")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_log")]),s._v("  /var/log/nginx/error.log notice")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pid")]),s._v("        /var/run/nginx.pid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("events")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_connections")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("http")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v("       /etc/nginx/mime.types")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default_type")]),s._v("  application/octet-stream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("log_format")]),s._v("  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_addr")]),s._v(" - "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_user")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$time_local]")]),s._v(' "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$request")]),s._v("\" '")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$status")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$body_bytes_sent")]),s._v(' "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_referer")]),s._v("\" '")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\""),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_user_agent")]),s._v('" "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_x_forwarded_for")]),s._v("\"'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("access_log")]),s._v("  /var/log/nginx/access.log  main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sendfile")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#tcp_nopush     on;")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keepalive_timeout")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#gzip  on;")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" /etc/nginx/conf.d/*.conf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è®¾å®šè´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨åˆ—è¡¨")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("upstream")]),s._v(" api01")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("least_conn")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.1.216:9001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#server 192.168.1.216:9002;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è®¾å®šè´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨åˆ—è¡¨")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("upstream")]),s._v(" api02")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")]),s._v(" 192.168.1.216:9003")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# HTTPæœåŠ¡å™¨")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç›‘å¬80ç«¯å£ï¼Œç”¨äºHTTPåè®®")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å®šä¹‰ä½¿ç”¨IP/åŸŸåè®¿é—®")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v(" 192.168.1.19")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é¦–é¡µ")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" index.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åå‘ä»£ç†çš„è·¯å¾„ï¼ˆupstreamç»‘å®šï¼‰ï¼Œlocation åé¢è®¾ç½®æ˜ å°„çš„è·¯å¾„")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v(" http://192.168.1.216:9001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /api01/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v(" http://api01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n         "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /api02/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v(" http://api02")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br")])]),a("ul",[a("li",[s._v("upstream api01 é¦–æ¬¡é…ç½®ä¸­åªç”Ÿæ•ˆäº†ä¸€ç»„ IP æ­¤æ—¶è®¿é—®ï¼›http://192.168.1.19:8090/api01/ éƒ½åªä¼šè¿”å› api101 success")])]),s._v(" "),a("h3",{attrs:{id:"åˆ·æ–°é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ·æ–°é…ç½®"}},[s._v("#")]),s._v(" "),a("strong",[s._v("åˆ·æ–°é…ç½®")])]),s._v(" "),a("p",[s._v("åœ¨ api-gateway-center ä¸­æä¾›äº†æ¥å£ï¼šhttp://192.168.1.19:8001/cactus/admin/load/updateNginxConfig")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * http://localhost:8001/cactus/admin/load/updateNginxConfig\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"updateNginxConfig"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" produces "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"application/json;charset=utf-8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateNginxConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UpstreamVO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" upstreamList "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    upstreamList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UpstreamVO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"api01"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"least_conn;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("asList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.1.216:9001;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.1.216:9002;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    upstreamList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UpstreamVO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"api02"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"least_conn;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("asList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.1.216:9003;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocationVO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" locationList "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    locationList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocationVO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/api01/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://api01;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    locationList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocationVO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/api02/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://api02;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NginxConfig")]),s._v(" nginxConfig "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NginxConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("upstreamList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" locationList"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"åˆ·æ–°Nginxé…ç½®æ–‡ä»¶å¼€å§‹ nginxConfigï¼š{}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toJSONString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nginxConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        loadBalancingService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateNginxConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nginxConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"åˆ·æ–°Nginxé…ç½®æ–‡ä»¶å®Œæˆ"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"åˆ·æ–°Nginxé…ç½®æ–‡ä»¶å¤±è´¥"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("é€šè¿‡æ­¤é…ç½®æ¥åŠ¨æ€è°ƒæ•´Nginxçš„è´Ÿè½½å‡è¡¡é…ç½®ï¼Œä¹Ÿå°±æ˜¯æ¨¡æ‹Ÿå½“æœ‰ API æœåŠ¡å˜æ›´æ—¶ï¼Œæ¥åŠ¨æ€å˜æ›´ Nginx è´Ÿè½½ä¿¡æ¯ã€‚")])]),s._v(" "),a("li",[a("p",[s._v("æ­¤æ—¶è®¿é—®æ¥å£ï¼šhttp://192.168.1.19:8001/cactus/admin/load/updateNginxConfig Nginx æ–‡ä»¶ä¼šå‘ç”Ÿå˜æ›´ä»¥åŠåˆ·æ–°æ“ä½œã€‚")])])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-blogs/image-20231007181056393.png",alt:"image-20231007181056393"}})]),s._v(" "),a("h2",{attrs:{id:"æ‰©å±•ä»‹ç»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‰©å±•ä»‹ç»"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ‰©å±•ä»‹ç»")])]),s._v(" "),a("p",[s._v("å¦‚æœæˆ‘ä»¬å‰é¢æ‰€æåˆ°ï¼Œå› ä¸ºä½¿ç”¨äº†æ–‡ä»¶æŒ‚åœ¨çš„æ–¹å¼æ‰€ä»¥ä¸éœ€è¦åœ¨é€šè¿‡æŒ‡ä»¤cpæ–‡ä»¶çš„æ“ä½œã€‚ä½†åœ¨ Docker ä¸­æ˜¯æœ‰å¯¹åº”çš„ä»£ç æ¥æ“ä½œæ–‡ä»¶çš„æ‹·è´çš„ï¼›")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('@Test\npublic void test_nginx_file() throws InterruptedException, IOException {\n    // Docker client\n    DockerClientConfig config = DefaultDockerClientConfig.createDefaultConfigBuilder()\n            .withDockerHost("unix:///var/run/docker.sock").build();\n    DockerClient dockerClient = DockerClientBuilder.getInstance(config).build();\n    // Copy file from container\n    try (TarArchiveInputStream tarStream = new TarArchiveInputStream(\n            dockerClient.copyArchiveFromContainerCmd("api-gateway-center",\n                    "/nginx.conf").exec())) {\n        unTar(tarStream, new File("/opt/api-gateway/api-gateway-center/doc/data/nginx/nginx.conf"));\n    }\n    dockerClient.close();\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("ul",[a("li",[s._v("æ­¤å†…å®¹æ¥è‡ªäº docker-java https://github.com/docker-java/docker-java/issues/991 å¯ä»¥æ‰©å±•å­¦ä¹ ")])]),s._v(" "),a("h2",{attrs:{id:"æœ¬ç« å°ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æœ¬ç« å°ç»“"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æœ¬ç« å°ç»“")])]),s._v(" "),a("p",[s._v("æœ¬èŠ‚å†…å®¹æ¶µç›–äº†ä»¥ä¸‹æ ¸å¿ƒä¸»é¢˜ï¼š")]),s._v(" "),a("p",[a("strong",[s._v("æ–‡ä»¶æŒ‚è½½ä¸è®¿é—®")]),s._v("ï¼šæˆ‘ä»¬æ·±å…¥ç ”ç©¶äº†å¦‚ä½•åœ¨ Docker å®¹å™¨ä¸­æŒ‚è½½æ–‡ä»¶ï¼Œä»¥åŠå¦‚ä½•ç¡®ä¿å…¶ä»–åº”ç”¨ç¨‹åºå¯ä»¥è®¿é—®è¿™äº›æŒ‚è½½çš„æ–‡ä»¶ã€‚è¿™å¯¹äºå®¹å™¨å†…å¤–çš„æ•°æ®å…±äº«å’Œåä½œè‡³å…³é‡è¦ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("Java æŒ‡ä»¤ä¸ Docker å®¹å™¨")]),s._v("ï¼šæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Java æŒ‡ä»¤æ¥å®ç°å¯¹åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œçš„æœåŠ¡è¿›è¡ŒåŠ¨æ€æ“ä½œã€‚è¿™ç§æŠ€èƒ½åœ¨ DevOps æµç¨‹ä¸­éå¸¸æ™®éï¼Œæœ‰åŠ©äºå¼€å‘å›¢é˜Ÿæ›´é«˜æ•ˆåœ°ç®¡ç†æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚")]),s._v(" "),a("p",[a("strong",[s._v("æ™ºèƒ½åŒ–æ“ä½œä¸ DevOps")]),s._v("ï¼šå®é™…ä¸Šï¼Œç±»ä¼¼è‡ªåŠ¨åŒ–å’Œæ™ºèƒ½åŒ–æ“ä½œåœ¨å¤§å‹ç»„ç»‡ä¸­éå¸¸å¸¸è§ï¼Œå°¤å…¶æ˜¯åœ¨æœåŠ¡ä¸Šçº¿å’Œ DevOps æµç¨‹ä¸­ã€‚é€šè¿‡ç®€å•çš„é…ç½®å’Œè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œå¯ä»¥å®Œæˆå„ç§å¤æ‚çš„ä»»åŠ¡ï¼Œä»è€Œè§£æ”¾äº†ç ”å‘å›¢é˜Ÿçš„åŒæ‰‹ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("æ·±å…¥äº†è§£æ ¸å¿ƒåŸç†")]),s._v("ï¼šç„¶è€Œï¼Œå¦‚æœç ”å‘äººå‘˜æ²¡æœ‰å¯¹åº•å±‚åŸç†æœ‰è¶³å¤Ÿçš„äº†è§£ï¼Œå¯èƒ½ä¼šå—é™äºä»–ä»¬å¯ä»¥æ‰§è¡Œçš„ä»»åŠ¡å’Œåšå‡ºçš„å†³ç­–ã€‚å› æ­¤ï¼Œäº†è§£åº•å±‚å·¥ä½œåŸç†å¯¹äºèŒä¸šå‘å±•è‡³å…³é‡è¦ï¼Œä»¥é¿å…æˆä¸ºçº¯ç²¹çš„â€œå·¥å…·äººâ€ã€‚")]),s._v(" "),a("h2",{attrs:{id:"æ‰©å±•å†…å®¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‰©å±•å†…å®¹"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ‰©å±•å†…å®¹")])]),s._v(" "),a("p",[s._v("å¦‚æœä¸æ˜¯éƒ¨ç½²åˆ° Docker å®¹å™¨ï¼Œé‚£ä¹ˆé€šè¿‡Javaç¨‹åºæ“ä½œNginxä¼šæ›´ç®€å•ï¼›")]),s._v(" "),a("ol",[a("li",[a("p",[s._v('åœ¨ Java ç¨‹åºä¸­è¯»å– Nginx çš„é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚ "/etc/nginx/'),a("a",{attrs:{href:"http://nginx.conf/",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx.conf"),a("OutboundLink")],1),s._v('" æ–‡ä»¶ã€‚')]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("File")]),s._v(" configFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/nginx/nginx.conf"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" configContent "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("readAllBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("configFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toPath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("ä¿®æ”¹é…ç½®æ–‡ä»¶å†…å®¹ï¼Œæ¯”å¦‚æ·»åŠ ä¸€æ¡æ–°çš„åå‘ä»£ç†é…ç½®ã€‚")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" newConfig "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" configContent "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\n"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"location /app {\\n"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  proxy_pass http://localhost:8080/app;\\n"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v('å°†ä¿®æ”¹åçš„é…ç½®æ–‡ä»¶å†™å…¥åˆ° Nginx é…ç½®ç›®å½•ä¸‹çš„ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚ "/etc/nginx/'),a("a",{attrs:{href:"http://nginx.conf.new/",target:"_blank",rel:"noopener noreferrer"}},[s._v("nginx.conf"),a("OutboundLink")],1),s._v('" æ–‡ä»¶ã€‚')]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("File")]),s._v(" newConfigFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/nginx/nginx.conf.new"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("newConfigFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toPath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" newConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("é€šè¿‡æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤æ¥é‡è½½ Nginx é…ç½®ã€‚")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProcessBuilder")]),s._v(" pb "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProcessBuilder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-t"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\npb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("redirectErrorStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Process")]),s._v(" process "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nprocess"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("waitFor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("exitValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProcessBuilder")]),s._v(" pbReload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProcessBuilder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-s"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reload"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   pbReload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("redirectErrorStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Process")]),s._v(" processReload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pbReload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   processReload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("waitFor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v('ä»¥ä¸Šä»£ç ä¸­ï¼Œé¦–å…ˆä½¿ç”¨ "nginx -t" å‘½ä»¤æ¥æ£€æŸ¥æ–°çš„é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼Œå¦‚æœæ£€æŸ¥é€šè¿‡ï¼Œåˆ™ä½¿ç”¨ "nginx -s reload" å‘½ä»¤æ¥é‡è½½ Nginx é…ç½®ã€‚æ³¨æ„ï¼Œè¿™äº›å‘½ä»¤éœ€è¦åœ¨æ‰§è¡Œ Java ç¨‹åºçš„æ“ä½œç³»ç»Ÿä¸­å·²ç»å®‰è£…äº† Nginxã€‚')])]),s._v(" "),a("li",[a("p",[s._v("æœ€åï¼Œæ‚¨å¯ä»¥å°†æ–°çš„é…ç½®æ–‡ä»¶é‡å‘½åä¸ºåŸæ¥çš„æ–‡ä»¶åï¼Œä»¥è¦†ç›–åŸæ¥çš„é…ç½®æ–‡ä»¶ã€‚")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("configFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("delete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nnewConfigFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("renameTo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("configFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå°±å¯ä»¥é€šè¿‡ Java ç¨‹åºæ›´æ–° Nginx é…ç½®æ–‡ä»¶å¹¶é‡è½½é…ç½®äº†ã€‚å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„å®ç°ï¼Œæ‚¨è¿˜éœ€è¦è€ƒè™‘ä¸€äº›å¼‚å¸¸æƒ…å†µï¼Œæ¯”å¦‚åœ¨å†™å…¥æ–°é…ç½®æ–‡ä»¶æ—¶å‡ºç°é”™è¯¯ç­‰ç­‰ã€‚")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);