(window.webpackJsonp=window.webpackJsonp||[]).push([[219],{567:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"二、命令复习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、命令复习"}},[s._v("#")]),s._v(" 二、命令复习")]),s._v(" "),a("h2",{attrs:{id:"_1、常见命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、常见命令"}},[s._v("#")]),s._v(" 1、常见命令")]),s._v(" "),a("p",[s._v("所有Docker命令手册")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://docs.docker.com/engine/reference/commandline/docker/",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[s._v("https://docs.docker.com/engine/reference/commandline/docker/")]),a("OutboundLink")],1)]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("命令")])]),s._v(" "),a("th",[a("strong",[s._v("作用")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("attach")]),s._v(" "),a("td",[s._v("绑定到运行中容器的 标准输入, 输出,以及错误流（这样似乎也能进入容器内容，但是一定小心，他们操作的就是控制台，控制台的退出命令会生效，比如redis,nginx...）")])]),s._v(" "),a("tr",[a("td",[s._v("build")]),s._v(" "),a("td",[s._v("从一个 Dockerfile 文件构建镜像")])]),s._v(" "),a("tr",[a("td",[s._v("commit")]),s._v(" "),a("td",[s._v("把容器的改变 提交创建一个新的镜像")])]),s._v(" "),a("tr",[a("td",[s._v("cp")]),s._v(" "),a("td",[s._v("容器和本地文件系统间 复制 文件/文件夹")])]),s._v(" "),a("tr",[a("td",[s._v("create")]),s._v(" "),a("td",[s._v("创建新容器，但并不启动（注意与docker run 的区分）需要手动启动。start\\stop")])]),s._v(" "),a("tr",[a("td",[s._v("diff")]),s._v(" "),a("td",[s._v("检查容器里文件系统结构的更改【A：添加文件或目录 D：文件或者目录删除 C：文件或者目录更改】")])]),s._v(" "),a("tr",[a("td",[s._v("events")]),s._v(" "),a("td",[s._v("获取服务器的实时事件")])]),s._v(" "),a("tr",[a("td",[s._v("exec")]),s._v(" "),a("td",[s._v("在运行时的容器内运行命令")])]),s._v(" "),a("tr",[a("td",[s._v("export")]),s._v(" "),a("td",[s._v("导出"),a("strong",[s._v("容器")]),s._v("的文件系统为一个tar文件。commit是直接提交成镜像，export是导出成文件方便传输")])]),s._v(" "),a("tr",[a("td",[s._v("history")]),s._v(" "),a("td",[s._v("显示镜像的历史")])]),s._v(" "),a("tr",[a("td",[s._v("images")]),s._v(" "),a("td",[s._v("列出所有镜像")])]),s._v(" "),a("tr",[a("td",[s._v("import")]),s._v(" "),a("td",[s._v("导入tar的内容创建一个镜像，再导入进来的镜像直接启动不了容器。/docker-entrypoint.sh nginx -g 'daemon off;'docker ps --no-trunc 看下之前的完整启动命令再用他")])]),s._v(" "),a("tr",[a("td",[s._v("info")]),s._v(" "),a("td",[s._v("显示系统信息")])]),s._v(" "),a("tr",[a("td",[s._v("inspect")]),s._v(" "),a("td",[s._v("获取docker对象的底层信息")])]),s._v(" "),a("tr",[a("td",[s._v("kill")]),s._v(" "),a("td",[s._v("杀死一个或者多个容器")])]),s._v(" "),a("tr",[a("td",[s._v("load")]),s._v(" "),a("td",[s._v("从 tar 文件加载镜像")])]),s._v(" "),a("tr",[a("td",[s._v("login")]),s._v(" "),a("td",[s._v("登录Docker registry")])]),s._v(" "),a("tr",[a("td",[s._v("logout")]),s._v(" "),a("td",[s._v("退出Docker registry")])]),s._v(" "),a("tr",[a("td",[s._v("logs")]),s._v(" "),a("td",[s._v("获取容器日志；容器以前在前台控制台能输出的所有内容，都可以看到")])]),s._v(" "),a("tr",[a("td",[s._v("pause")]),s._v(" "),a("td",[s._v("暂停一个或者多个容器")])]),s._v(" "),a("tr",[a("td",[s._v("port")]),s._v(" "),a("td",[s._v("列出容器的端口映射")])]),s._v(" "),a("tr",[a("td",[s._v("ps")]),s._v(" "),a("td",[s._v("列出所有容器")])]),s._v(" "),a("tr",[a("td",[s._v("pull")]),s._v(" "),a("td",[s._v("从registry下载一个image 或者repository")])]),s._v(" "),a("tr",[a("td",[s._v("push")]),s._v(" "),a("td",[s._v("给registry推送一个image或者repository")])]),s._v(" "),a("tr",[a("td",[s._v("rename")]),s._v(" "),a("td",[s._v("重命名一个容器")])]),s._v(" "),a("tr",[a("td",[s._v("restart")]),s._v(" "),a("td",[s._v("重启一个或者多个容器")])])])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("命令")])]),s._v(" "),a("th",[a("strong",[s._v("作用")])])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("rm")]),s._v(" "),a("td",[s._v("移除一个或者多个容器")])]),s._v(" "),a("tr",[a("td",[s._v("rmi")]),s._v(" "),a("td",[s._v("移除一个或者多个镜像")])]),s._v(" "),a("tr",[a("td",[s._v("run")]),s._v(" "),a("td",[s._v("创建并启动容器")])]),s._v(" "),a("tr",[a("td",[s._v("save")]),s._v(" "),a("td",[s._v("把一个或者多个"),a("strong",[s._v("镜像")]),s._v("保存为tar文件")])]),s._v(" "),a("tr",[a("td",[s._v("search")]),s._v(" "),a("td",[s._v("去docker hub寻找镜像")])]),s._v(" "),a("tr",[a("td",[s._v("start")]),s._v(" "),a("td",[s._v("启动一个或者多个容器")])]),s._v(" "),a("tr",[a("td",[s._v("stats")]),s._v(" "),a("td",[s._v("显示容器资源的实时使用状态")])]),s._v(" "),a("tr",[a("td",[s._v("stop")]),s._v(" "),a("td",[s._v("停止一个或者多个容器")])]),s._v(" "),a("tr",[a("td",[s._v("tag")]),s._v(" "),a("td",[s._v("给源镜像创建一个新的标签，变成新的镜像")])]),s._v(" "),a("tr",[a("td",[s._v("top")]),s._v(" "),a("td",[s._v("显示正在运行容器的进程")])]),s._v(" "),a("tr",[a("td",[s._v("unpause")]),s._v(" "),a("td",[s._v("pause的反操作")])]),s._v(" "),a("tr",[a("td",[s._v("update")]),s._v(" "),a("td",[s._v("更新一个或者多个docker容器配置")])]),s._v(" "),a("tr",[a("td",[s._v("version")]),s._v(" "),a("td",[s._v("Show the Docker version information")])]),s._v(" "),a("tr",[a("td",[s._v("container")]),s._v(" "),a("td",[s._v("管理容器")])]),s._v(" "),a("tr",[a("td",[s._v("image")]),s._v(" "),a("td",[s._v("管理镜像")])]),s._v(" "),a("tr",[a("td",[s._v("network")]),s._v(" "),a("td",[s._v("管理网络")])]),s._v(" "),a("tr",[a("td",[s._v("volume")]),s._v(" "),a("td",[s._v("管理卷")])])])]),s._v(" "),a("p",[s._v("根据正在运行的容器制作出相关的镜像：反向")]),s._v(" "),a("p",[s._v("根据镜像启动一个容器：正向")]),s._v(" "),a("p",[s._v("有了Docker：")]),s._v(" "),a("ol",[a("li",[s._v("先去软件市场搜镜像： "),a("a",{attrs:{href:"https://registry.hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[s._v("https://registry.hub.docker.com/")]),a("OutboundLink")],1),s._v(" docker hub")]),s._v(" "),a("li",[s._v("下载镜像 docker pull xxx")]),s._v(" "),a("li",[s._v("启动软件 docker run 镜像名；")])]),s._v(" "),a("blockquote",[a("p",[s._v("对于镜像的所有管理操作都在这一个命令：docker image --help")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/docker-3.png",alt:""}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis:latest（最新版）\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 阿里云的镜像是从docker hub来的，我们配置了加速，默认是从阿里云（缓存）下载")]),s._v("\nREPOSITORY（名）  SIZE     TAG （标签）         IMAGE ID（镜像id）  CREATED（镜像的创建时间）\nredis            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(".3MB   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v(".12-alpine3.13  50ae27fed589       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" days ago\nredis            104MB    latest             621ceef7494a       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" days ago\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像是怎么做成的。基础环境+软件")]),s._v("\nredis的完整镜像应该是： linux系统+redis软件\nalpine：超级经典版的linux 5mb；+ redis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(".0mb \n没有alpine3的：就是centos基本版\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以后自己选择下载镜像的时候尽量使用")]),s._v("\nalpine： slim：\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aq")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除全部镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image prune "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#移除游离镜像  dangling：游离镜像（没有镜像名字的）")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag 原镜像:标签  新镜像名:标签  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重命名")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" create "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" IMAGE "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("COMMAND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ARG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" create "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("设置项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 镜像名 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("启动"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("启动参数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" create redis: 按照redis:latest镜像启动一个容器\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" 是强制kill -9（直接拔电源）；\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop 可以允许优雅停机"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("当前正在运行中的程序处理完所有事情后再停止"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" create "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" myredis "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("（主机的端口）:6379（容器的端口） redis \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" port1:port2\nport1是必须唯一的，那个是没关系的。\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" myredis2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":6379 redis ：默认是前台启动的，一般加上-d 让他后台悄悄启动, 虚拟机的很多端口绑定容器的一个端口是允许的\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" create + "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动了nginx；一个容器。docker   容器里面安装了nginx，要对nginx的所有修改都要进容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进容器：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach 绑定的是控制台. 可能导致容器停止。不要用这个\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":0 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),s._v(" mynginx4 /bin/bash： "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("用户，以特权方式进入容器\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container inspect 容器名 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect 容器名\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect image/network/volume "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 一般运行中的容器会常年修改，我们要使用最终的新镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" leifengyang "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first commit"')]),s._v(" mynginx4 mynginx:v4 \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把新的镜像放到远程docker hub，方便后来在其他机器下载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------export操作容器/import-------------------")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("   export导出的文件被import导入以后变成镜像，并不能直接启动容器，需要知道之前的启动命令\n（docker "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" --no-trunc），然后再用下面启动。\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v(" mynginx:v6 /docker-entrypoint.sh nginx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'daemon off;'")]),s._v(" \n\n或者docker image inspect 看之前的镜像，把 之前镜像的 Entrypoint的所有和 Cmd的连接起来就\n能得到启动命令\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#----save/load--操作镜像--")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" save "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" busybox.tar busybox:latest 把busybox镜像保存成tar文件\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" load "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" busybox.tar\t把压缩包里面的内容直接导成镜像\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#-------------------\t")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#镜像为什么能长久运行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#镜像启动一定得有一个阻塞的进程，一直干活，在这里代理。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" IMAGE "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("COMMAND"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ARG\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" myredis2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":6379 redis\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#镜像启动以后做镜像里面默认规定的活。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" busybox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#交互模式进入当前镜像启动的容")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#----产生镜像-----")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、基于已经存在的容器，提取成镜像\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、人家给了我tar包，导入成镜像\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、做出镜像\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("、准备一个文件Dockerfile\n      FROM busybox\n      CMD "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v(" baidu.com\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("、编写Dockerfile\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("、构建镜像\n     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" mybusy66:v6 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" Dockerfile "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n     \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---做redis的镜像--- ")]),s._v("\nFROM alpine（基础镜像）\n//下载安装包\n//解压\n//准备配置文件\nCMD redis-server redis.conf\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#-------")]),s._v("\n\nbuild 是根据一个Dockerfile构建出镜像\ncommit 是正在运行中的容器提交成一个镜像\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/docker-4.png",alt:""}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("容器的状态")]),s._v(" "),a("ul",[a("li",[s._v("Created（新建）、Up（运行中）、Pause（暂停）、Exited（退出）")])])]),s._v(" "),a("li",[a("p",[s._v("docker run的立即启动，docker create得稍后自己启动")])]),s._v(" "),a("li",[a("p",[s._v("推送镜像")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("注册docker hub并登录")])]),s._v(" "),a("li",[a("p",[s._v("可以创建一个仓库，选为public")])]),s._v(" "),a("li",[a("p",[s._v("docker push leifengyang/mynginx:tagname")])]),s._v(" "),a("li",[a("p",[s._v("docker hub一个完整镜像的全路径是 ：docker.io/library/redis:alpine3.13  我们的 docker.io/leifengyang/mynginx:tagname")])]),s._v(" "),a("li",[a("p",[s._v("docker images的时候镜像缩略了全名 默认官方镜像没有docker.io/library/")])]),s._v(" "),a("li",[a("p",[s._v("docker.io/ rediscommander / redis-commander:latest")])]),s._v(" "),a("li",[a("p",[s._v("docker.io/leifengyang/mynginx:v4 我的镜像的全称")])]),s._v(" "),a("li",[a("p",[s._v("登录远程docker仓库")])]),s._v(" "),a("li",[a("p",[s._v("当前会话登录以后 docker login 。所有的东西都会push到这个人的仓库")])]),s._v(" "),a("li",[a("p",[s._v("docker push leifengyang/mynginx:tagname")])]),s._v(" "),a("li",[a("p",[s._v("上面命令的完整版 docker push docker.io/leifengyang/mynginx:v4")])]),s._v(" "),a("li",[a("p",[s._v("怎么知道是否登录了 cat ~/.docker/config.json 有没有 auth的值，没有就是没有登录docker hub太慢了，用阿里云的镜像仓库，或者以后的habor仓库")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ImageId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" registry.cn-hangzhou.aliyuncs.com/lfy/mynginx: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像版sudo "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push registry.cn-hangzhou.aliyuncs.com/lfy/mynginx:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("镜像版本号"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n仓库网址/名称空间"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lfy/leifengyang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("/仓库名:版本号\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])])])]),s._v(" "),a("h2",{attrs:{id:"_2、典型命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、典型命令"}},[s._v("#")]),s._v(" 2、典型命令")]),s._v(" "),a("h3",{attrs:{id:"_1、docker-run"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、docker-run"}},[s._v("#")]),s._v(" 1、docker run")]),s._v(" "),a("p",[s._v("常用关键参数 "),a("font",{attrs:{color:"red"}},[s._v("OPTIONS")]),s._v(" 说明：")],1),s._v(" "),a("ul",[a("li",[a("font",{attrs:{color:"red"}},[s._v("-d: 后台运行容器，并返回容器ID；")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v("-i: 以交互模式运行容器，通常与 -t 同时使用；")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v("-P: 随机端口映射，容器内部端口随机映射到主机的端口")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v("-p:指定端口映射，格式为：主机(宿主)端口:容器端口")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v("-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v('--name="nginx-lb":为容器指定一个名称；')])],1),s._v(" "),a("li",[s._v("--dns 8.8.8.8: 指定容器使用的DNS服务器，默认和宿主一致；")]),s._v(" "),a("li",[s._v("--dns-search example.com: 指定容器DNS搜索域名，默认和宿主一致；")]),s._v(" "),a("li",[s._v('-h "mars": 指定容器的hostname；')]),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v('-e username="ritchie": 设置环境变量；')])],1),s._v(" "),a("li",[a("strong",[s._v("--env-file")]),s._v("=[]:从指定文件读入环境变量；")]),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v('--cpuset="0-2" or --cpuset="0,1,2": 绑定容器到指定CPU运行；')])],1),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v("-m :设置容器使用内存最大值；")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v('--net="bridge": 指定容器的网络连接类型，支持 bridge/host/none/container: 四种类型；')])],1),s._v(" "),a("li",[s._v("--link=[]: 添加链接到另一个容器；\n--expose=[]: 开放一个端口或一组端口")]),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v("--restart , 指定重启策略，可以写--restart=awlays 总是故障重启")])],1),s._v(" "),a("li",[a("font",{attrs:{color:"red"}},[s._v("--volume , -v: 绑定一个卷。一般格式 主机文件或文件夹:虚拟机文件或文件夹")])],1)]),s._v(" "),a("blockquote",[a("p",[s._v("-v： 在存储章节详细解释")]),s._v(" "),a("p",[s._v("--net: 在网络章节详细解析")])]),s._v(" "),a("p",[a("strong",[s._v("如何使用Docker部署组件")])]),s._v(" "),a("ol",[a("li",[s._v("先去找组件的镜像")]),s._v(" "),a("li",[s._v("查看镜像文档，了解组件的可配置内容")]),s._v(" "),a("li",[s._v("docker run进行部署")])]),s._v(" "),a("p",[a("strong",[s._v("常见部署案例")])]),s._v(" "),a("h4",{attrs:{id:"_1、部署nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、部署nginx"}},[s._v("#")]),s._v(" 1、部署Nginx")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意 外部的/nginx/conf下面的内容必须存在，否则挂载会覆盖")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" nginx-app "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/nginx/html:/usr/share/nginx/html:ro "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/nginx/conf:/etc/nginx\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"_2、部署mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、部署mysql"}},[s._v("#")]),s._v(" 2、部署MySQL")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5.7版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql57-app "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/mysql/log:/var/log/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/mysql/data:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/mysql/conf:/etc/mysql/conf.d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql:5.7\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#8.x版本,引入了 secure-file-priv 机制，磁盘挂载将没有权限读写data数据，所以需要将权限透传，或者chmod -R 777 /app/mysql/data")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --privileged 特权容器，容器内使用真正的root用户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql8-app "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/mysql/conf:/etc/mysql/conf.d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/mysql/log:/var/log/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/mysql/data:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h4",{attrs:{id:"_3、部署redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、部署redis"}},[s._v("#")]),s._v(" 3、部署Redis")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提前准备好redis.conf文件，创建好相应的文件夹。如：")]),s._v("\nport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" \nappendonly "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#更多配置参照    https://raw.githubusercontent.com/redis/redis/6.0/redis.conf")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" redis "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/redis/redis.conf:/etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/redis/data:/data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" redis:6.2.1-alpine3.13 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nredis-server /etc/redis/redis.conf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--appendonly")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"_4、部署elasticsearch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、部署elasticsearch"}},[s._v("#")]),s._v(" 4、部署ElasticSearch")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#准备文件和文件夹，并chmod -R 777 xxx ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置文件内容，参照")]),s._v("\nhttps://www.elastic.co/guide/en/elasticsearch/reference/7.5/node.name.html "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#搜索相关配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 考虑为什么挂载使用esconfig ...")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("elasticsearch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovery.type=single-node"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ES_JAVA_OPTS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Xms300m -Xmx300m"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/es/data:/usr/share/elasticsearch/data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /app/es/plugins:/usr/shrae/elasticsearch/plugins "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" esconfig:/usr/share/elasticsearch/config "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" elasticsearch:7.12.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h4",{attrs:{id:"_5、部署tomcat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、部署tomcat"}},[s._v("#")]),s._v(" 5、部署Tomcat")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 考虑，如果我们每次 -v 都是指定磁盘路径，是不是很麻烦？")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tomcat-app "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" tomcatconf:/usr/local/tomcat/conf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" tomcatwebapp:/usr/local/tomcat/webapps "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" tomcat:jdk8-openjdk-slim-buster\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"_6、重启策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、重启策略"}},[s._v("#")]),s._v(" 6、重启策略")]),s._v(" "),a("ul",[a("li",[s._v("no，默认策略，在容器退出时不重启容器")]),s._v(" "),a("li",[s._v("on-failure，在容器非正常退出时（退出状态非0），才会重启容器")]),s._v(" "),a("li",[s._v("on-failure:3，在容器非正常退出时重启容器，最多重启3次always，在容器退出时总是重启容器")]),s._v(" "),a("li",[s._v("unless-stopped，在容器退出时总是重启容器，但是不考虑在Docker守护进程启动时就已经停止了的容器")])]),s._v(" "),a("h3",{attrs:{id:"_2、docker-exec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、docker-exec"}},[s._v("#")]),s._v(" 2、docker exec")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" alpine "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3、docker-build"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、docker-build"}},[s._v("#")]),s._v(" 3、docker build")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" imageName "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" DockerfileName "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_4、docker-push"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、docker-push"}},[s._v("#")]),s._v(" 4、docker push")])])}),[],!1,null,null,null);a.default=e.exports}}]);