(window.webpackJsonp=window.webpackJsonp||[]).push([[282],{629:function(s,t,n){"use strict";n.r(t);var a=n(0),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"四、kubernetes基础其他项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、kubernetes基础其他项"}},[s._v("#")]),s._v(" 四、Kubernetes基础其他项")]),s._v(" "),t("h2",{attrs:{id:"_1、查看kubernetes适配的docker版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、查看kubernetes适配的docker版本"}},[s._v("#")]),s._v(" 1、查看Kubernetes适配的docker版本")]),s._v(" "),t("p",[s._v("https://github.com/kubernetes/kubernetes/releases   查看他的changelog，搜索适配的docker版本即可。")]),s._v(" "),t("h2",{attrs:{id:"_2、弃用dockershim的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、弃用dockershim的问题"}},[s._v("#")]),s._v(" 2、弃用dockershim的问题")]),s._v(" "),t("p",[s._v("https://kubernetes.io/zh/blog/2020/12/02/dockershim-faq/")]),s._v(" "),t("ul",[t("li",[s._v("使用containerd： https://kubernetes.io/zh/docs/setup/production-environment/container-runtimes/#containerd")]),s._v(" "),t("li",[s._v("配置docker：https://kubernetes.io/zh/docs/setup/production-environment/container-runtimes/#docker")])]),s._v(" "),t("h2",{attrs:{id:"_3、部署dashboard"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、部署dashboard"}},[s._v("#")]),s._v(" 3、部署dashboard")]),s._v(" "),t("p",[s._v("https://github.com/kubernetes/dashboard")]),s._v(" "),t("p",[s._v("type: NodePort")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#访问测试")]),s._v("\n每次访问都需要令牌\nkubectl "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" kubernetes-dashboard describe secret "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("kubectl "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" kubernetes-dashboard get secret "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" admin-user "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $1}'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("需要在下载来的文件中改这个")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1619274681271.png",alt:"1619274681271"}})]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 运行这个给个权限")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" rbac.authorization.k8s.io/v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterRoleBinding\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("roleRef")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiGroup")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" rbac.authorization.k8s.io\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterRole\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("admin\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("subjects")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ServiceAccount\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kubernetes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("dashboard\n    \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h2",{attrs:{id:"_4、master初始化的日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、master初始化的日志"}},[s._v("#")]),s._v(" 4、master初始化的日志")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@i-iqrlgkwc ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm init \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --apiserver-advertise-address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.170")]),s._v(".11.8 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --image-repository registry.cn-hangzhou.aliyuncs.com/lfy_k8s_images "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --kubernetes-version v1.21.0 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --service-cidr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".0.0/16 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --pod-network-cidr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.0/16\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("init"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using Kubernetes version: v1.21.0\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("preflight"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Running pre-flight checks\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("WARNING IsDockerSystemdCheck"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": detected "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cgroupfs"')]),s._v(" as the Docker cgroup driver. The recommended driver is "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"systemd"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" Please follow the guide at https://kubernetes.io/docs/setup/cri/\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("preflight"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Pulling images required "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" setting up a Kubernetes cluster\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("preflight"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" This might take a minute or two, depending on the speed of your internet connection\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("preflight"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" You can also perform this action "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" beforehand using "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubeadm config images pull'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using certificateDir folder "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/kubernetes/pki"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ca"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"apiserver"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" apiserver serving cert is signed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" DNS names "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s-01 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" and IPs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.170")]),s._v(".11.8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"apiserver-kubelet-client"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"front-proxy-ca"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"front-proxy-client"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"etcd/ca"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"etcd/server"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" etcd/server serving cert is signed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" DNS names "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s-01 localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" and IPs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.170")]),s._v(".11.8 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 ::1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"etcd/peer"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" etcd/peer serving cert is signed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" DNS names "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("k8s-01 localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" and IPs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.170")]),s._v(".11.8 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 ::1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"etcd/healthcheck-client"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"apiserver-etcd-client"')]),s._v(" certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Generating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sa"')]),s._v(" key and public key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubeconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using kubeconfig folder "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/kubernetes"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubeconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin.conf"')]),s._v(" kubeconfig "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubeconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubelet.conf"')]),s._v(" kubeconfig "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubeconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"controller-manager.conf"')]),s._v(" kubeconfig "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubeconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scheduler.conf"')]),s._v(" kubeconfig "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing kubelet environment "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" with flags to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/kubelet/kubeadm-flags.env"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing kubelet configuration to "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/kubelet/config.yaml"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Starting the kubelet\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("control-plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using manifest folder "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/kubernetes/manifests"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("control-plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Creating static Pod manifest "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-apiserver"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("control-plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Creating static Pod manifest "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-controller-manager"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("control-plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Creating static Pod manifest "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-scheduler"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("etcd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Creating static Pod manifest "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" etcd "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/kubernetes/manifests"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("wait-control-plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Waiting "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the kubelet to boot up the control plane as static Pods from directory "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/kubernetes/manifests"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" This can take up to 4m0s\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-check"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Initial "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" of 40s passed.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("apiclient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" All control plane components are healthy after "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("66.504822")]),s._v(" seconds\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("upload-config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Storing the configuration used "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" ConfigMap "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubeadm-config"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-system"')]),s._v(" Namespace\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Creating a ConfigMap "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubelet-config-1.21"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" namespace kube-system with the configuration "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the kubelets "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the cluster\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("upload-certs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Skipping phase. Please see --upload-certs\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mark-control-plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Marking the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" k8s-01 as control-plane by adding the labels: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node-role.kubernetes.io/master"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("deprecated"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" node-role.kubernetes.io/control-plane node.kubernetes.io/exclude-from-external-load-balancers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mark-control-plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Marking the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" k8s-01 as control-plane by adding the taints "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node-role.kubernetes.io/master:NoSchedule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bootstrap-token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Using token: os234q.tqr5fxmvapgu0b71\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bootstrap-token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bootstrap-token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" configured RBAC rules to allow Node Bootstrap tokens to get nodes\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bootstrap-token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" configured RBAC rules to allow Node Bootstrap tokens to post CSRs "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" order "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" nodes to get long term certificate credentials\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bootstrap-token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bootstrap-token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" configured RBAC rules to allow certificate rotation "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" all "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" client certificates "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the cluster\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bootstrap-token"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Creating the "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster-info"')]),s._v(" ConfigMap "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-public"')]),s._v(" namespace\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("kubelet-finalize"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Updating "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/kubernetes/kubelet.conf"')]),s._v(" to point to a rotatable kubelet client certificate and key\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("addons"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Applied essential addon: CoreDNS\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("addons"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Applied essential addon: kube-proxy\n\nYour Kubernetes control-plane has initialized successfully"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" /etc/kubernetes/admin.conf "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n\nAlternatively, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" you are the root user, you can run:\n\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("KUBECONFIG")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/kubernetes/admin.conf\n\nYou should now deploy a pod network to the cluster.\nRun "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubectl apply -f [podnetwork].yaml"')]),s._v(" with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nThen you can "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" any number of worker nodes by running the following on each as root:\n\nkubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.170")]),s._v(".11.8:6443 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--token")]),s._v(" os234q.tqr5fxmvapgu0b71 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t--discovery-token-ca-cert-hash sha256:68251032e1f77a7356e784bdeb8e1f7f728cb0fb31c258dc7b44befc9f516f85 \n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);