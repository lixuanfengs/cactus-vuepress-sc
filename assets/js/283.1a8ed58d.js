(window.webpackJsonp=window.webpackJsonp||[]).push([[283],{633:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("strong",[s._v("Kubernetes 概念")])]),s._v(" "),t("h2",{attrs:{id:"一、基础概念理解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、基础概念理解"}},[s._v("#")]),s._v(" 一、基础概念理解")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("集群")]),s._v(" "),t("ul",[t("li",[s._v("master")]),s._v(" "),t("li",[s._v("worker\n"),t("ul",[t("li",[s._v("Node")])])])])]),s._v(" "),t("li",[t("p",[s._v("Pod")]),s._v(" "),t("ul",[t("li",[s._v("应用最终以Pod为一个基本单位部署")])])]),s._v(" "),t("li",[t("p",[s._v("Label")]),s._v(" "),t("ul",[t("li",[s._v("很多资源都可以打标签")])])]),s._v(" "),t("li",[t("p",[s._v("Deployment")]),s._v(" "),t("ul",[t("li",[s._v("应用部署用它，deployment最终会产生Pod")])])]),s._v(" "),t("li",[t("p",[s._v("Service")]),s._v(" "),t("ul",[t("li",[s._v("负载均衡机制")])])])]),s._v(" "),t("h2",{attrs:{id:"二、kubernetes-objects-k8s对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、kubernetes-objects-k8s对象"}},[s._v("#")]),s._v(" 二、kubernetes Objects（k8s对象）")]),s._v(" "),t("h3",{attrs:{id:"_1、什么是k8s对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、什么是k8s对象"}},[s._v("#")]),s._v(" 1、什么是k8s对象")]),s._v(" "),t("p",[s._v("https://kubernetes.io/zh/docs/concepts/overview/working-with-objects/kubernetes-objects/")]),s._v(" "),t("ul",[t("li",[s._v("k8s里面操作的资源实体，就是k8s的对象，可以使用yaml来声明对象。然后让k8s根据yaml的声明 创建出这个对象；kubectl create/run /expose.....")]),s._v(" "),t("li",[s._v("操作 Kubernetes 对象 —— 无论是创建、修改，或者删除 —— 需要使用 Kubernetes API 。比如，当使用命令行接口时，CLI 会执行必要的 Kubernetes API 调用")]),s._v(" "),t("li",[s._v("Kubernetes对象指的是Kubernetes系统的持久化实体，所有这些对象合起来，代表了你集群的实际 情况。常规的应用里，我们把应用程序的数据存储在数据库中，Kubernetes将其数据以Kubernetes 对象的形式通过 api server存储在 etcd 中。具体来说，这些数据（Kubernetes对象）描述了：\n"),t("ul",[t("li",[s._v("集群中运行了哪些容器化应用程序（以及在哪个节点上运行）")]),s._v(" "),t("li",[s._v("集群中对应用程序可用的资源（网络，存储等）")]),s._v(" "),t("li",[s._v("应用程序相关的策略定义，例如，重启策略、升级策略、容错策略")]),s._v(" "),t("li",[s._v("其他Kubernetes管理应用程序时所需要的信息")]),s._v(" "),t("li",[s._v("scheduler先计算应该去哪个节点部署")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("对象的spec和status")]),s._v(" "),t("p",[s._v("每一个 Kubernetes 对象都包含了两个重要的字段：")]),s._v(" "),t("ul",[t("li",[s._v("spec 必须由您来提供，描述了您对该对象所期望的 "),t("strong",[s._v("目标状态")])]),s._v(" "),t("li",[s._v("status 只能由 Kubernetes 系统来修改，描述了该对象在 Kubernetes 系统中的 "),t("strong",[s._v("实际状态")]),s._v("Kubernetes通过对应的 "),t("strong",[s._v("控制器")]),s._v("，"),t("strong",[s._v("不断地使实际状态趋向于您期望的目标状态")])])])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### kubectl create deployment my-nginx --image=nginx")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("annotations")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deployment.kubernetes.io/revision")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("creationTimestamp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-05-06T05:59:07Z"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("generation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("resourceVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"23501946"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("uid")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" e27baef5"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("c3c4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("46f6"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("8bb3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("54db2f2407fe\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###期望状态")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("progressDeadlineSeconds")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 副本数量")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("revisionHistoryLimit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("strategy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("rollingUpdate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxSurge")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 25%\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxUnavailable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 25%\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" RollingUpdate\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("creationTimestamp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token null important"}},[s._v("null")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###使用这个镜像创建容器")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("imagePullPolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Always\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("resources")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("terminationMessagePath")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /dev/termination"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("log\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("terminationMessagePolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" File\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dnsPolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterFirst\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restartPolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Always\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("schedulerName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("scheduler\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("securityContext")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("terminationGracePeriodSeconds")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("status")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###当前状态")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("availableReplicas")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 当前集群可用的")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("conditions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("lastTransitionTime")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-05-06T05:59:28Z"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("lastUpdateTime")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-05-06T05:59:28Z"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("message")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment has minimum availability.\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("reason")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MinimumReplicasAvailable\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("status")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"True"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Available\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("lastTransitionTime")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-05-06T05:59:07Z"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("lastUpdateTime")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2022-05-06T05:59:28Z"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("message")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(' ReplicaSet "my'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v('c54945c55" has successfully progressed.\n    '),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("reason")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" NewReplicaSetAvailable\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("status")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"True"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Progressing\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("observedGeneration")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("readyReplicas")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("updatedReplicas")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  \n  \n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("### 最终一致。 ")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## etcd保存的创建资源期望的状态和最终这个资源的状态要是一致的；spec和status要最终一致 ")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1、kubectl create deployment my-nginx --image=nginx ")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 2、api-server保存etcd，controller-manager最终解析数据，知道集群要my-nginx一份，保 存到etcd ")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 3、kubelet就做一件事情，spec状态和最终状态一致")]),s._v("\n\nwhile(true)"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n    if(my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx.replicas "),t("span",{pre:!0,attrs:{class:"token tag"}},[s._v("!=")]),s._v(" spec.replicas) "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \tkubelet.startPod(); \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br")])]),t("h3",{attrs:{id:"_2、描述k8s对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、描述k8s对象"}},[s._v("#")]),s._v(" 2、描述k8s对象")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##自己编写任意资源的yaml都可以创建出他")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###如何会写任意资源的yaml，比如Pod")]),s._v("\n\t\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#################编写yaml的黑科技#########################")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## kubectl run my-nginx666 --image=nginx #启动一个Pod")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1、kubectl get pod my-nginx666 -oyaml 集群中挑一个同类资源，获取出他的yaml。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 2、kubectl run my-tomcat --image=tomcat --dry-run -oyaml 干跑一遍")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#资源类型 kubectl api-resources:可以获取到所有资源")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod \t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#同一个资源有可能有多个版本。看 kubectl api-resources提示的。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#每一个资源定义一些元数据信息")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("creationTimestamp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token null important"}},[s._v("null")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#每一个资源定义一些元数据信息")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" tomcat\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tomcat\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("resources")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dnsPolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ClusterFirst\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restartPolicy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Always\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("status")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("p",[s._v("当您在 Kubernetes 中创建一个对象时，您必须提供")]),s._v(" "),t("ul",[t("li",[s._v("该对象的 spec 字段，通过该字段描述您期望的 目标状态")]),s._v(" "),t("li",[s._v("该对象的一些基本信息，例如名字")])]),s._v(" "),t("p",[s._v("可以使用 kubectl 命令行创建对象，业可以编写 "),t("Badge",{attrs:{text:".yaml",type:"warning"}}),s._v("格式的文件进行创建")],1),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apps/v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Deployment\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("deployment\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###期望状态")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicas")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行 2 个容器化应用程序副本")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("creationTimestamp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token null important"}},[s._v("null")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###使用这个镜像创建容器")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n \t\t"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n \t\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1、部署")]),s._v("\nkubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" deployment.yaml\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2、移除")]),s._v("\nkubectl delete "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" deployment.yaml\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("集群中所有的资源，都在那里？\nk8s只依赖一个存储就是etcd。")])]),s._v(" "),t("h3",{attrs:{id:"_3、k8s对象yaml的结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、k8s对象yaml的结构"}},[s._v("#")]),s._v(" 3、k8s对象yaml的结构")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/506143503.png",alt:"对象yaml的构成"}})]),s._v(" "),t("p",[t("strong",[s._v("必填字段")]),s._v("\n在上述的文件中 "),t("font",{attrs:{color:"FF9933"}},[s._v(".yaml")]),s._v("，如下字段是必须填写的：")],1),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("apiVersion")]),s._v(" 用来创建对象时所使用的Kubernetes API版本")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("kind")]),s._v(" 被创建对象的类型")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("metadata")]),s._v(" 用于唯一确定该对象的元数据：包括"),t("font",{attrs:{color:"FF9933"}},[s._v("name")]),s._v("和"),t("font",{attrs:{color:"FF9933"}},[s._v("namespace")]),s._v(", 如果 "),t("font",{attrs:{color:"FF9933"}},[s._v("namespace")]),s._v("则默认值为空，则默认值为"),t("font",{attrs:{color:"FF9933"}},[s._v("default")])],1)]),s._v(" "),t("li",[t("p",[t("strong",[s._v("spec")]),s._v(" 描述您对该对象的期望状态")])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("不同类型的 Kubernetes，其"),t("font",{attrs:{color:"FF9933"}},[s._v(" spec")]),s._v(" 对象的格式不同（含有不同的内嵌字段），通过 "),t("a",{attrs:{href:"https://kubernetes.io/docs/reference/#api-reference",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("API")]),s._v(" "),t("strong",[s._v("手册")]),s._v(" "),t("OutboundLink")],1),s._v("可以查看 Kubernetes 对象的字段和描述。例如，假设您想了解 Pod 的"),t("font",{attrs:{color:"FF9933"}},[s._v(" spec")]),s._v(" 定义，可以在 "),t("a",{attrs:{href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.16/#podspec-v1-core",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("这里")]),t("OutboundLink")],1),s._v("找到，Deployment 的 "),t("font",{attrs:{color:"FF9933"}},[s._v("spec ")]),s._v("定义可以在 "),t("a",{attrs:{href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.16/#deploymentspec-v1-apps",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("这里")]),s._v(" "),t("OutboundLink")],1),s._v("找到.")],1),s._v(" "),t("p",[t("a",{attrs:{href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.21/",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.21/")]),t("OutboundLink")],1),s._v(" 这就是我们以后要完全参照的文档。")])]),s._v(" "),t("h3",{attrs:{id:"_4、管理k8s对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、管理k8s对象"}},[s._v("#")]),s._v(" 4、管理k8s对象")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[s._v("管理方式")])]),s._v(" "),t("th",[t("strong",[s._v("操作对象")])]),s._v(" "),t("th",[t("strong",[s._v("推荐的环境")])]),s._v(" "),t("th",[t("strong",[s._v("参与编辑的人数")])]),s._v(" "),t("th",[t("strong",[s._v("学习曲线")])])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("指令性的命令行")]),s._v(" "),t("td",[s._v("Kubernetes对象;kubectl xxxxx。 cka")]),s._v(" "),t("td",[s._v("开发环境")]),s._v(" "),t("td",[s._v("1+")]),s._v(" "),t("td",[s._v("最低")])]),s._v(" "),t("tr",[t("td",[s._v("指令性的对象配置")]),s._v(" "),t("td",[s._v("单个 yaml 文件")]),s._v(" "),t("td",[s._v("生产环境")]),s._v(" "),t("td",[s._v("1")]),s._v(" "),t("td",[s._v("适中")])]),s._v(" "),t("tr",[t("td",[s._v("声明式的对象配置")]),s._v(" "),t("td",[s._v("包含多个 yaml 文件的多个目录。kustomize")]),s._v(" "),t("td",[s._v("生产环境")]),s._v(" "),t("td",[s._v("1+")]),s._v(" "),t("td",[s._v("最高")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("同一个Kubernetes对象应该只使用一种方式管理，否则可能会出现不可预期的结果")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1、命令式")]),s._v("\nkubectl run nginx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--image")]),s._v(" nginx\n\nkubectl create deployment nginx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--image")]),s._v(" nginx\n\napply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" ： 没有就创建，有就修改\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2、指令性")]),s._v("\n- 使用指令性的对象配置（imperative object configuration）时，需要向 kubectl 命令指定具体的操作（create,replace,apply,delete等），可选参数以及至少一个配置文件的名字。配置文件中必须 包括一个完整的对象的定义，可以是 yaml 格式，也可以是 json 格式。\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建对象")]),s._v("\nkubectl create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" nginx.yaml\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除对象")]),s._v("\nkubectl delete "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" nginx.yaml "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" redis.yaml\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#替换对象")]),s._v("\nkubectl replace "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" nginx.yaml \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3、声明式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#处理 configs 目录中所有配置文件中的Kubernetes对象，根据情况创建对象、或更新Kubernetes中已经存在的对象。可以先执行 diff 指令查看具体的变更，然后执行 apply 指令执行变更；")]),s._v("\nkubectl "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" configs/\nkubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" configs/\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#递归处理目录中的内容： kubectl diff -R -f configs/")]),s._v("\nkubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" configs/\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#移除")]),s._v("\nkubectl delete "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" configs/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"_5、对象名称"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、对象名称"}},[s._v("#")]),s._v(" 5、对象名称")]),s._v(" "),t("p",[t("strong",[s._v("Kubernetes REST API")]),s._v(" 中，所有的对象都是通过"),t("font",{attrs:{color:"FF9933"}},[s._v("name")]),s._v("和"),t("font",{attrs:{color:"FF9933"}},[s._v("UID")]),s._v("唯一性确定\n可以通过\t"),t("font",{attrs:{color:"FF9933"}},[s._v("namespace")]),s._v("  +\t"),t("font",{attrs:{color:"FF9933"}},[s._v("name")]),s._v(" 唯一性地确定一个 RESTFUL 对象，例如：")],1),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("/api/v1/namespaces/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("namespace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/pods/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("font",{attrs:{color:" 33CC33"}},[t("strong",[s._v("Names")])])],1),s._v(" "),t("p",[s._v("同一个名称空间下，同一个类型的对象，可以通过"),t("font",{attrs:{color:"FF9933"}},[s._v("name")]),s._v(" 唯一性确定。如果删除该对象之后，可以再重新创建一个同名对象。\n依据命名规则，"),t("strong",[s._v("Kubernetes")]),s._v(" 对象的名字应该：")],1),s._v(" "),t("ul",[t("li",[s._v("最长不超过 253个字符")]),s._v(" "),t("li",[s._v("必须由小写字母、数字、减号 "),t("font",{attrs:{color:"FF9933"}},[s._v("- ")]),s._v("、、小数点 "),t("font",{attrs:{color:"FF9933"}},[s._v("·")]),s._v("组成")],1),s._v(" "),t("li",[s._v("某些资源类型有更具体的要求")])]),s._v(" "),t("p",[s._v("例如，下面的配置文件定义了一个 name 为 "),t("font",{attrs:{color:"FF9933"}},[s._v("nginx-demo")]),s._v(" 容器：的 Pod，该 Pod 包含一个 name 为"),t("font",{attrs:{color:"FF9933"}},[s._v("nginx")]),s._v("\t的容器：")],1),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##pod的名字")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.7.9 \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[t("font",{attrs:{color:" 33CC33"}},[t("strong",[s._v("UID")])])],1),s._v(" "),t("p",[s._v("UID 是由 Kubernetes 系统生成的，唯一标识某个 Kubernetes 对象的字符串。")]),s._v(" "),t("p",[s._v("Kubernetes集群中，每创建一个对象，都有一个唯一的 UID。用于区分多次创建的同名对象（如前所述，按照名字删除对象后，重新再创建同名对象时，两次创建的对象 name 相同，但是 UID 不同。）")]),s._v(" "),t("h3",{attrs:{id:"_6、名称空间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6、名称空间"}},[s._v("#")]),s._v(" 6、名称空间")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[s._v("kubectl get namespaces\n\nkubectl describe namespaces <name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#隔离 mysql mapper.xml--》dao.")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("Kubernetes 安装成功后，默认有初始化了三个名称空间：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("default")]),s._v(" 默认名称空间，如果 Kubernetes 对象中不定义 "),t("font",{attrs:{color:"FF9933"}},[s._v("metadata.namespace")]),s._v(" 字段，该对象将放在此名称空间下")],1),s._v(" "),t("li",[t("strong",[s._v("kube-system")]),s._v(" Kubernetes系统创建的对象放在此名称空间下")]),s._v(" "),t("li",[t("strong",[s._v("kube-public")]),s._v(" 此名称空间自动在安装集群是自动创建，并且所有用户都是可以读取的（即使是那些未登录的用户）。主要是为集群预留的，例如，某些情况下，某些Kubernetes对象应该被所有集群用户看到。")])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("名称空间未来如何隔离")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("基于环境隔离（prod,test）")]),s._v(" "),t("p",[s._v("prod：部署的所有应用")]),s._v(" "),t("p",[s._v("test：部署的所有应用")])]),s._v(" "),t("li",[t("p",[s._v("基于产品线的名称空间（商城，android，ios，backend）；")])]),s._v(" "),t("li",[t("p",[s._v("基于团队隔离")])])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("访问其他名称空间的东西？(名称空间资源隔离，网络不隔离)")]),s._v(" "),t("p",[s._v("配置直接拿来用。不行")]),s._v(" "),t("p",[s._v("网络访问，可以。")]),s._v(" "),t("p",[s._v("Pod-Pod；\nserviceName来访问，找本名称空间的Service负载均衡\nserviceName.名称空间，可以访问别的名称空间的")])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("创建名称空间")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1 \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Namespace \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" <名称空间的名字"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1 \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Namespace \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("creationTimestamp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token null important"}},[s._v("null")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("03")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("status")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#执行创建资源")]),s._v("\nkubectl create "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" ./my-namespace.yaml\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#直接用命令")]),s._v("\nkubectl create namespace "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("名称空间的名字"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除")]),s._v("\nkubectl delete namespaces "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("名称空间的名字"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])]),s._v(" "),t("p",[s._v("名称空间的名字必须与 DNS 兼容：")]),s._v(" "),t("ul",[t("li",[s._v("不能带小数 "),t("font",{attrs:{color:"FF9933"}},[s._v(".")])],1),s._v(" "),t("li",[s._v("点不能带下划线"),t("font",{attrs:{color:"FF9933"}},[s._v("_")])],1),s._v(" "),t("li",[s._v("使用数字、小写字母和减号 "),t("font",{attrs:{color:"FF9933"}},[s._v("-")]),s._v(" 组成的字符串")],1)]),s._v(" "),t("p",[s._v("默认情况下，安装Kubernetes集群时，会初始化一个 "),t("font",{attrs:{color:"FF9933"}},[s._v("default")]),s._v(" 空间的 Pod、Service、Deployment等对象")],1),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("为请求设置命名空间")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#要为当前请求设置命名空间，请使用 --namespace 参数。")]),s._v("\nkubectl run nginx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("image=nginx "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("namespace=<insert"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("namespace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("here"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\nkubectl get pods "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("namespace=<insert"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("namespace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("here"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在对象yaml中使用命名空间")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("Pod metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##pod的名字")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不写就是default ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##容器的名字")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("当您创建一个 "),t("a",{attrs:{href:"https://kubernetes.io/docs/user-guide/services",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("Service")]),s._v(" "),t("OutboundLink")],1),s._v("时，Kubernetes 会创建一个相应的 "),t("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("DNS")]),s._v(" "),t("strong",[s._v("条目")]),t("OutboundLink")],1),s._v("。该条目的形式是 ..svc.cluster.local ，这意味着如果容器只使用 ``，它将被解析到本地命名空间的服务。这对于跨多个命名空间（如开发、分级和生产）使用相同的配置非常有用。如果您希望跨 命名空间访问，则需要使用完全限定域名（FQDN）")])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建Pod kind:Pod")]),s._v("\nk8s底层最小的部署单元是Pod。Service，Deploy，ReplicaSet\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Deploy:直接指定Pod模板（） kind: Deploy")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[s._v("并非所有对象都在命名空间中")])]),s._v(" "),t("p",[s._v("大多数 kubernetes 资源（例如 Pod、Service、副本控制器等）都位于某些命名空间中。但是命名空间资源本身并不在命名空间中。而且底层资源，例如 "),t("a",{attrs:{href:"https://kubernetes.io/docs/admin/node",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("nodes")]),s._v(" "),t("OutboundLink")],1),s._v("和持久化卷不属于任何命名空间。")]),s._v(" "),t("p",[s._v("查看哪些 Kubernetes 资源在命名空间中，哪些不在命名空间中：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# In a namespace")]),s._v("\nkubectl api-resources "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespaced")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Not in a namespace")]),s._v("\nkubectl api-resources "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--namespaced")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("fals\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_7、标签和选择器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7、标签和选择器"}},[s._v("#")]),s._v(" 7、标签和选择器")]),s._v(" "),t("p",[s._v("标签（Label）是附加在Kubernetes对象上的一组名值对，其意图是按照对用户有意义的方式来标识Kubernetes对象，同时，又不对Kubernetes的核心逻辑产生影响。标签可以用来组织和选择一组Kubernetes对象。您可以在创建Kubernetes对象时为其添加标签，也可以在创建以后再为其添加标签。每个Kubernetes对象可以有多个标签，同一个对象的标签的 Key 必须唯一，例如：")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" value1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" value2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("使用标签（Label）可以高效地查询和监听Kubernetes对象，在Kubernetes界面工具（如 Kubenetes Dashboard 或 Kuboard）和 kubectl 中，标签的使用非常普遍。那些非标识性的信息应该记录在 "),t("strong",[s._v("注解（annotation）")])]),s._v(" "),t("p",[t("font",{attrs:{color:" 33CC33"}},[s._v("为什么要使用标签？")])],1),s._v(" "),t("p",[s._v("使用标签，用户可以按照自己期望的形式组织 Kubernetes 对象之间的结构，而无需对 Kubernetes 有任何修改。\n应用程序的部署或者批处理程序的部署通常都是多维度的（例如，多个高可用分区、多个程序版本、多 个微服务分层）。管理这些对象时，很多时候要针对某一个维度的条件做整体操作，例如，将某个版本 的程序整体删除，这种情况下，如果用户能够事先规划好标签的使用，再通过标签进行选择，就会非常 地便捷。\n标签的例子有：")]),s._v(" "),t("ul",[t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("release: stable 、 release: canary")])],1),s._v(" "),t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("environment: dev 、 environment: qa 、 environment: production ")])],1),s._v(" "),t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("tier: frontend 、 tier: backend 、 tier: cache")])],1),s._v(" "),t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("partition: customerA 、 partition: customerB")])],1),s._v(" "),t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("track: daily 、 track: weekly")])],1)]),s._v(" "),t("p",[s._v("上面只是一些使用比较普遍的标签，您可以根据您自己的情况建立合适的使用标签的约定。")]),s._v(" "),t("p",[t("font",{attrs:{color:" 33CC33"}},[s._v("句法和字符集")])],1),s._v(" "),t("p",[s._v("标签是一组名值对（key/value pair）。标签的 key 可以有两个部分：可选的前缀和标签名，通过 "),t("font",{attrs:{color:"FF9933"}},[s._v(" / ")]),s._v(" 分隔。")],1),s._v(" "),t("ul",[t("li",[t("p",[s._v("标签名：")]),s._v(" "),t("ul",[t("li",[s._v("标签名部分是必须的不能多于 63 个字符")]),s._v(" "),t("li",[s._v("必须由字母、数字开始和结尾")]),s._v(" "),t("li",[s._v("可以包含字母、数字、减号"),t("font",{attrs:{color:"FF9933"}},[s._v(" - ")]),s._v(" 、下划线 "),t("font",{attrs:{color:"FF9933"}},[s._v(" _  ")]),s._v("、小数点 "),t("font",{attrs:{color:"FF9933"}},[s._v(".")])],1)])]),s._v(" "),t("li",[t("p",[s._v("标签前缀")]),s._v(" "),t("ul",[t("li",[s._v("标签前缀部分是可选的")]),s._v(" "),t("li",[s._v("如果指定，必须是一个DNS的子域名，例如：k8s.eip.work")]),s._v(" "),t("li",[s._v("不能多于 253 个字符")]),s._v(" "),t("li",[s._v("使用"),t("font",{attrs:{color:"FF9933"}},[s._v(" / ")]),s._v(" 和标签名分隔")],1)])])]),s._v(" "),t("p",[s._v("如果省略标签前缀，则标签的 key 将被认为是专属于用户的。Kubernetes的系统组件（例如，kube- scheduler、kube-controller-manager、kube-apiserver、kubectl 或其他第三方组件）向用户的Kubernetes对象添加标签时，必须指定一个前缀。"),t("font",{attrs:{color:"FF9933"}},[s._v("kubernetes.io/")]),s._v(" 和 "),t("font",{attrs:{color:"FF9933"}},[s._v("k8s.io")]),s._v(" 这两个前缀是 Kubernetes 核心组件预留的。")],1),s._v(" "),t("p",[s._v("标签的 value 必须：")]),s._v(" "),t("ul",[t("li",[s._v("不能多于 63 个字符")]),s._v(" "),t("li",[s._v("可以为空字符串")]),s._v(" "),t("li",[s._v("如果不为空，则\n"),t("ul",[t("li",[s._v("必须由字母、数字开始和结尾")]),s._v(" "),t("li",[s._v("可以包含字母、数字、减号"),t("font",{attrs:{color:"FF9933"}},[s._v(" - ")]),s._v(" 、下划线 "),t("font",{attrs:{color:"FF9933"}},[s._v(" _  ")]),s._v("、小数点 "),t("font",{attrs:{color:"FF9933"}},[s._v(".")])],1)])])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" label"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" production\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("1.7.9\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[t("strong",[s._v("标签选择器")]),s._v("\n通常来讲，会有多个"),t("strong",[s._v("Kubernetes")]),s._v("对象包含相同的标签。通过使用标签选择器（label selector），用户/客户端可以选择一组对象。标签选择器（label selector）是 Kubernetes 中最主要的分类和筛选手段。\n"),t("strong",[s._v("Kubernetes api serve")]),s._v("r支持两种形式的标签选择器，"),t("font",{attrs:{color:"FF9933"}},[s._v(" equality-based 基于等式的 ")]),s._v("和"),t("font",{attrs:{color:"FF9933"}},[s._v("set-based 基于集合的 ")]),s._v("。标签选择器可以包含多个条件，并使用逗号分隔，此时只有满足所有条件的 Kubernetes 对象才会被选中")],1),s._v(" "),t("blockquote",[t("p",[s._v("使用基于等式的选择方式,可以使用三种操作符 =、==、!=。前两个操作符含义是一样的，都代表相等，后一个操作符代表不相等")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl get pods "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("production,tier"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("frontend\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选择了标签名为 `environment` 且 标签值为 `production` 的Kubernetes对象")]),s._v("\nenvironment "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" production\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选择了标签名为 `tier` 且标签值不等于 `frontend` 的对象，以及不包含标签 `tier` 的对象")]),s._v("\ntier "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" frontend\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("使用基于集合的选择方式")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("Set-based   标签选择器可以根据标签名的一组值进行筛选。支持的操作符有三种：in、notin、\nexists。例如\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选择所有的包含 `environment` 标签且值为 `production` 或 `qa` 的对象")]),s._v("\nenvironment "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("production, qa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选择所有的 `tier` 标签不为 `frontend` 和 `backend`的对象，或不含 `tier` 标签的对象")]),s._v("\ntier notin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("frontend, backend"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选择所有包含 `partition` 标签的对象")]),s._v("\npartition\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选择所有不包含 `partition` 标签的对象")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("partition\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 选择包含 `partition` 标签（不检查标签值）且 `environment` 不是 `qa` 的对象")]),s._v("\npartition,environment notin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("qa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\nkubectl get pods "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'environment in (production),tier in (frontend)'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Job、Deployment、ReplicaSet 和 DaemonSet 同时支持基于等式的选择方式和基于集合的选择方式。例如:")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchLabels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("component")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("matchExpressions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" tier"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" In"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("cache"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" environment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("operator")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" NotIn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("values")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dev"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# matchLabels 是一个 {key,value} 组成的 map。map 中的一个 {key,value} 条目相当于matchExpressions 中的一个元素，其 key 为 map 的 key，operator 为 In， values 数组则只包含 value 一个元素。matchExpression 等价于基于集合的选择方式，支持的 operator 有 In、NotIn、Exists 和 DoesNotExist。当 operator 为 In 或 NotIn 时，values 数组不能为空。所有的选择条件都以 AND 的形式合并计算，即所有的条件都满足才可以算是匹配")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("#添加或者修改标签\nkubectl label --help\n# Update pod 'foo' with the label 'unhealthy' and the value 'true'.\nkubectl label pods foo unhealthy=true \n\n# Update pod 'foo' with the label 'status' and the value 'unhealthy', overwriting any existing value.\nkubectl label --overwrite pods foo status=unhealthy\n\n# Update all pods in the namespace kubectl label pods --all status=unhealthy\n\n# Update a pod identified by the type and name in \"pod.json\" kubectl label -f pod.json status=unhealthy\n\n# Update pod 'foo' only if the resource is unchanged from version 1. kubectl label pods foo status=unhealthy --resource-version=1\n\n# Update pod 'foo' by removing a label named 'bar' if it exists. # Does not require the --overwrite flag.\nkubectl label pods foo bar-\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h3",{attrs:{id:"_8、注解annotation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8、注解annotation"}},[s._v("#")]),s._v(" 8、注解annotation")]),s._v(" "),t("p",[s._v("注解（annotation）可以用来向 Kubernetes 对象的 "),t("font",{attrs:{color:"FF9933"}},[s._v("metadata.annotations")]),s._v(" 字段添加任意的信息。Kubernetes 的客户端或者自动化工具可以存取这些信息以实现其自定义的逻辑。")],1),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("annotations")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" value1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("key2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" value2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"_9、字段选择器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9、字段选择器"}},[s._v("#")]),s._v(" 9、字段选择器")]),s._v(" "),t("p",[s._v("字段选择器 （ Field selectors ）允许您根据一个或多个资源字段的值"),t("font",{attrs:{color:" 33CC33"}},[s._v(" 筛选 Kubernetes 资源。")]),s._v(" 下面是一些使用字段选择器查询的例子：")],1),s._v(" "),t("ul",[t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("metadata.name=my-service ")])],1),s._v(" "),t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("metadata.namespace!=default")])],1),s._v(" "),t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("status.phase=Pending")])],1)]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl get pods --field-selector "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status.phase")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Running\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("三个命令玩转所有的yaml写法")]),s._v(" "),t("ul",[t("li",[s._v("kubectl get xxx -oyaml")]),s._v(" "),t("li",[s._v("kubectl create deploy xxxxx --dry-run-client -oyaml")]),s._v(" "),t("li",[s._v("kubectl explain pod.spec.xx")])]),s._v(" "),t("p",[s._v("写完yaml kubectl apply -f 即可")])]),s._v(" "),t("h3",{attrs:{id:"_10、给vscode安装插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10、给vscode安装插件"}},[s._v("#")]),s._v(" 10、给vscode安装插件")]),s._v(" "),t("p",[s._v("搜索kubernetes ， 安装 "),t("font",{attrs:{color:"FF9933"}},[s._v("yaml ")]),s._v("和 "),t("font",{attrs:{color:"FF9933"}},[s._v("kubernetes template")]),s._v(" 插件即可")],1),s._v(" "),t("h3",{attrs:{id:"_11、认识kubectl和kubelet"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_11、认识kubectl和kubelet"}},[s._v("#")]),s._v(" 11、认识kubectl和kubelet")]),s._v(" "),t("ul",[t("li",[s._v("kubeadm安装的集群。二进制后来就是 yum install etcd api-server\n"),t("ul",[t("li",[s._v("认识核心文件夹 /etc/kubernetes . 以Pod方式安装的核心组件。\n"),t("ul",[t("li",[s._v("etcd，api-server，scheduler。（安装k8s的时候，yum kubeadm kubelet kubectl）")])])]),s._v(" "),t("li",[s._v("回顾集群安装的时候， 为什么只有master节点的kubectl可以操作集群")]),s._v(" "),t("li",[s._v("kubelet额外参数配置 /etc/sysconfig/kubelet；kubelet配置位置 /var/lib/kubelet/config.yaml")])])])]),s._v(" "),t("p",[t("strong",[s._v("kubectl的所有命令参考：")]),s._v("\n命令参考：  https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands\npdf命令实战： https://github.com/dennyzhang/cheatsheet-kubernetes-A4/blob/master/cheatsheet-kubernetes-A4.pdf")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl controls the Kubernetes cluster manager.\n\n Find "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" information at: https://kubernetes.io/docs/reference/kubectl/overview/\n\nBasic Commands "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Beginner"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初学者掌握的命令")]),s._v("\n  create        Create a resource from a "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" or from stdin\n  expose        Take a replication controller, service, deployment or pod and expose it as a new Kubernetes "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v("\n  run           在集群中运行一个指定的镜像\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v("           为 objects 设置一个指定的特征\n\nBasic Commands "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Intermediate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#基础命令")]),s._v("\n  explain       Get documentation "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a resource\n  get           显示一个或更多 resources\n  edit          在服务器上编辑一个资源\n  delete        Delete resources by "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" names, stdin, resources and names, or by resources and label selector\n\nDeploy Commands: "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#部署用的命令")]),s._v("\n  rollout       Manage the rollout of a resource\n  scale         Set a new size "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a deployment, replica set, or replication controller\n  autoscale     Auto-scale a deployment, replica set, stateful set, or replication controller\n\nCluster Management Commands: "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#集群管理的命令")]),s._v("\n  certificate   修改 certificate 资源.\n  cluster-info  Display cluster information\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v("           Display resource "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CPU/memory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" usage\n  cordon        标记 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" 为 unschedulable\n  uncordon      标记 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" 为 schedulable\n  drain         Drain "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" preparation "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" maintenance\n  taint         更新一个或者多个 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" 上的 taints\n\nTroubleshooting and Debugging Commands:  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# debug的命令")]),s._v("\n  describe      显示一个指定 resource 或者 group 的 resources 详情\n  logs          输出容器在 pod 中的日志\n  attach        Attach 到一个运行中的 container\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("          在一个 container 中执行一个命令\n  port-forward  Forward one or "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" ports to a pod\n  proxy         运行一个 proxy 到 Kubernetes API server\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v("            Copy files and directories to and from containers\n  auth          Inspect authorization\n  debug         Create debugging sessions "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" troubleshooting workloads and nodes\n\nAdvanced Commands:  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 高阶命令")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v("          Diff the live version against a would-be applied version\n  apply         Apply a configuration to a resource by "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" name or stdin\n  patch         Update fields of a resource\n  replace       Replace a resource by "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" name or stdin\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wait")]),s._v("          Experimental: Wait "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a specific condition on one or many resources\n  kustomize     Build a kustomization target from a directory or URL.\n\nSettings Commands:  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置")]),s._v("\n  label         更新在这个资源上的 labels\n  annotate      更新一个资源的注解\n  completion    Output shell completion code "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the specified shell "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bash, "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("zsh")]),s._v(" or fish"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nOther Commands: "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#其他")]),s._v("\n  alpha         Commands "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("features")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" alpha\n  api-resources Print the supported API resources on the server\n  api-versions  Print the supported API versions on the server, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the form of "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group/version"')]),s._v("\n  config        修改 kubeconfig 文件\n  plugin        Provides utilities "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" interacting with plugins\n  version       输出 client 和 server 的版本信息\n\nUsage:\n  kubectl "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("flags"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nUse "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubectl <command> --help"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" information about a given command.\nUse "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubectl options"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" a list of global command-line options "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("applies to all commands"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br")])]),t("h3",{attrs:{id:"_12、自动补全"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_12、自动补全"}},[s._v("#")]),s._v(" 12、自动补全")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://kubernetes.io/zh/docs/tasks/tools/included/optional-kubectl-configs-bash-linux/",target:"_blank",rel:"noopener noreferrer"}},[t("strong",[s._v("https://kubernetes.io/zh/docs/tasks/tools/included/optional-kubectl-configs-bash-linux/")]),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" bash-completion\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自动补全")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'source <(kubectl completion bash)'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("~/.bashrc \nkubectl completion "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/etc/bash_completion.d/kubectl \n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /usr/share/bash-completion/bash_completion\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"三、万物基础-容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、万物基础-容器"}},[s._v("#")]),s._v(" 三、万物基础-容器")]),s._v(" "),t("blockquote",[t("p",[s._v("思考：我们在k8s里面的容器和docker的容器有什么异同？")])]),s._v(" "),t("p",[s._v("k8s的"),t("strong",[s._v("Pod")]),s._v("是最小单位，Pod中容器的配置需要注意以下常用的 Pod里面的容器内容可以写的东西:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl explain pod.spec.containers")]),s._v("\nKIND:     Pod\nVERSION:  v1\n\nRESOURCE: containers "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nDESCRIPTION:\n     List of containers belonging to the pod. Containers cannot currently be\n     added or removed. There must be at least one container "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a Pod. Cannot be\n     updated.\n\n     A single application container that you want to run within a pod.\n\nFIELDS:\n   args\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("string"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n     Arguments to the entrypoint. The "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s CMD is used if this is not\n     provided. Variable references $(VAR_NAME) are expanded using the\n     container'")]),s._v("s environment. If a variable cannot be resolved, the reference "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n     the input string will be unchanged. Double "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$$")]),s._v(" are reduced to a single $,\n     "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" allows "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" escaping the "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("VAR_NAME"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" syntax: i.e. "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("VAR_NAME"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" will\n     produce the string literal "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("VAR_NAME"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" Escaped references will never be\n     expanded, regardless of whether the variable exists or not. Cannot be\n     updated. More info:\n     https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#running-a-command-in-a-shell")]),s._v("\n\n   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("string"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n     Entrypoint array. Not executed within a shell. The "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s\n     ENTRYPOINT is used if this is not provided. Variable references $(VAR_NAME)\n     are expanded using the container'")]),s._v("s environment. If a variable cannot be\n     resolved, the reference "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the input string will be unchanged. Double "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$$")]),s._v("\n     are reduced to a single $, "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" allows "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" escaping the "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("VAR_NAME"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n     syntax: i.e. "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("VAR_NAME"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" will produce the string literal "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("VAR_NAME"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n     Escaped references will never be expanded, regardless of whether the\n     variable exists or not. Cannot be updated. More info:\n     https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#running-a-command-in-a-shell")]),s._v("\n\n   "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##容器要用的环境变量")]),s._v("\n     List of environment variables to "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the container. Cannot be updated.\n\n   envFrom\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n     List of sources to populate environment variables "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the container. The\n     keys defined within a "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" must be a C_IDENTIFIER. All invalid keys will\n     be reported as an event when the container is starting. When a key exists\n     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" multiple sources, the value associated with the last "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" will take\n     precedence. Values defined by an Env with a duplicate key will take\n     precedence. Cannot be updated.\n\n   image\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("string"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##写镜像的名字")]),s._v("\n     Docker image name. More info:\n     https://kubernetes.io/docs/concepts/containers/images This field is\n     optional to allow higher level config management to default or override\n     container images "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" workload controllers like Deployments and StatefulSets.\n\n   imagePullPolicy\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("string"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n   \t\t下载策略：\n        Always：总是去下载： 【默认】\n               先看网上有没有，有了就下载，（本机也有，docker就相当于不用下载了）\n        Never：总不去下载，一定保证当前Pod所在的机器有这个镜像   ；直接看本机\n        IfNotPresent：如果本机没有就去下载；先看本机，再看远程\n     Image pull policy. One of Always, Never, IfNotPresent. Defaults to Always\n     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" :latest tag is specified, or IfNotPresent otherwise. Cannot be updated.\n     More info:\n     https://kubernetes.io/docs/concepts/containers/images"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#updating-images")]),s._v("\n\n\n\n   lifecycle\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##生命周期钩子")]),s._v("\n     Actions that the management system should take "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" response to container\n     lifecycle events. Cannot be updated.\n\n   livenessProbe\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n     Periodic probe of container liveness. Container will be restarted "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" the\n     probe fails. Cannot be updated. More info:\n     https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#container-probes")]),s._v("\n\n   name\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("string"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -required- "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##容器的名字")]),s._v("\n     Name of the container specified as a DNS_LABEL. Each container "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a pod\n     must have a unique name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DNS_LABEL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(". Cannot be updated.\n\n   ports\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##端口：")]),s._v("\n     List of ports to expose from the container. Exposing a port here gives the\n     system additional information about the network connections a container\n     uses, but is primarily informational. Not specifying a port here DOES NOT\n     prevent that port from being exposed. Any port "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" is listening on the\n     default "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0"')]),s._v(" address inside a container will be accessible from the\n     network. Cannot be updated.\n\n   readinessProbe\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n     Periodic probe of container "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" readiness. Container will be removed\n     from "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" endpoints "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" the probe fails. Cannot be updated. More info:\n     https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#container-probes")]),s._v("\n\n   resources\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n     Compute Resources required by this container. Cannot be updated. More info:\n     https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/\n\n   securityContext\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n     SecurityContext defines the security options the container should be run\n     with. If set, the fields of SecurityContext override the equivalent fields\n     of PodSecurityContext. More info:\n     https://kubernetes.io/docs/tasks/configure-pod-container/security-context/\n\n   startupProbe\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Object"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n     StartupProbe indicates that the Pod has successfully initialized. If\n     specified, no other probes are executed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("until")]),s._v(" this completes successfully.\n     If this probe fails, the Pod will be restarted, just as "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" the\n     livenessProbe failed. This can be used to provide different probe\n     parameters at the beginning of a Pod"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s lifecycle, when it might take a long\n     time to load data or warm a cache, than during steady-state operation. This\n     cannot be updated. More info:\n     https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle#container-probes\n\n   stdin\t<boolean>\n     Whether this container should allocate a buffer for stdin in the container\n     runtime. If this is not set, reads from stdin in the container will always\n     result in EOF. Default is false.\n\n   stdinOnce\t<boolean>\n     Whether the container runtime should close the stdin channel after it has\n     been opened by a single attach. When stdin is true the stdin stream will\n     remain open across multiple attach sessions. If stdinOnce is set to true,\n     stdin is opened on container start, is empty until the first client\n     attaches to stdin, and then remains open and accepts data until the client\n     disconnects, at which time stdin is closed and remains closed until the\n     container is restarted. If this flag is false, a container processes that\n     reads from stdin will never receive an EOF. Default is false\n\n   terminationMessagePath\t<string>\n     Optional: Path at which the file to which the container'")]),s._v("s termination\n     message will be written is mounted into the container"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s filesystem. Message\n     written is intended to be brief final status, such as an assertion failure\n     message. Will be truncated by the node if greater than 4096 bytes. The\n     total message length across all containers will be limited to 12kb.\n     Defaults to /dev/termination-log. Cannot be updated.\n\n   terminationMessagePolicy\t<string>\n     Indicate how the termination message should be populated. File will use the\n     contents of terminationMessagePath to populate the container status message\n     on both success and failure. FallbackToLogsOnError will use the last chunk\n     of container log output if the termination message file is empty and the\n     container exited with an error. The log output is limited to 2048 bytes or\n     80 lines, whichever is smaller. Defaults to File. Cannot be updated.\n\n\n\n   tty\t<boolean>\n     Whether this container should allocate a TTY for itself, also requires\n     '")]),s._v("stdin"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' to be true. Default is false.\n\n   volumeDevices\t<[]Object>\n     volumeDevices is the list of block devices to be used by the container.\n\n   volumeMounts\t<[]Object>\n     Pod volumes to mount into the container'")]),s._v("s filesystem. Cannot be updated.\n\n   workingDir\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("string"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##指定进容器的工作目录")]),s._v("\n     Container"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s working directory. If not specified, the container runtime'")]),s._v("s\n     default will be used, "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" might be configured "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the container image.\n     Cannot be updated.\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br"),t("span",{staticClass:"line-number"},[s._v("76")]),t("br"),t("span",{staticClass:"line-number"},[s._v("77")]),t("br"),t("span",{staticClass:"line-number"},[s._v("78")]),t("br"),t("span",{staticClass:"line-number"},[s._v("79")]),t("br"),t("span",{staticClass:"line-number"},[s._v("80")]),t("br"),t("span",{staticClass:"line-number"},[s._v("81")]),t("br"),t("span",{staticClass:"line-number"},[s._v("82")]),t("br"),t("span",{staticClass:"line-number"},[s._v("83")]),t("br"),t("span",{staticClass:"line-number"},[s._v("84")]),t("br"),t("span",{staticClass:"line-number"},[s._v("85")]),t("br"),t("span",{staticClass:"line-number"},[s._v("86")]),t("br"),t("span",{staticClass:"line-number"},[s._v("87")]),t("br"),t("span",{staticClass:"line-number"},[s._v("88")]),t("br"),t("span",{staticClass:"line-number"},[s._v("89")]),t("br"),t("span",{staticClass:"line-number"},[s._v("90")]),t("br"),t("span",{staticClass:"line-number"},[s._v("91")]),t("br"),t("span",{staticClass:"line-number"},[s._v("92")]),t("br"),t("span",{staticClass:"line-number"},[s._v("93")]),t("br"),t("span",{staticClass:"line-number"},[s._v("94")]),t("br"),t("span",{staticClass:"line-number"},[s._v("95")]),t("br"),t("span",{staticClass:"line-number"},[s._v("96")]),t("br"),t("span",{staticClass:"line-number"},[s._v("97")]),t("br"),t("span",{staticClass:"line-number"},[s._v("98")]),t("br"),t("span",{staticClass:"line-number"},[s._v("99")]),t("br"),t("span",{staticClass:"line-number"},[s._v("100")]),t("br"),t("span",{staticClass:"line-number"},[s._v("101")]),t("br"),t("span",{staticClass:"line-number"},[s._v("102")]),t("br"),t("span",{staticClass:"line-number"},[s._v("103")]),t("br"),t("span",{staticClass:"line-number"},[s._v("104")]),t("br"),t("span",{staticClass:"line-number"},[s._v("105")]),t("br"),t("span",{staticClass:"line-number"},[s._v("106")]),t("br"),t("span",{staticClass:"line-number"},[s._v("107")]),t("br"),t("span",{staticClass:"line-number"},[s._v("108")]),t("br"),t("span",{staticClass:"line-number"},[s._v("109")]),t("br"),t("span",{staticClass:"line-number"},[s._v("110")]),t("br"),t("span",{staticClass:"line-number"},[s._v("111")]),t("br"),t("span",{staticClass:"line-number"},[s._v("112")]),t("br"),t("span",{staticClass:"line-number"},[s._v("113")]),t("br"),t("span",{staticClass:"line-number"},[s._v("114")]),t("br"),t("span",{staticClass:"line-number"},[s._v("115")]),t("br"),t("span",{staticClass:"line-number"},[s._v("116")]),t("br"),t("span",{staticClass:"line-number"},[s._v("117")]),t("br"),t("span",{staticClass:"line-number"},[s._v("118")]),t("br"),t("span",{staticClass:"line-number"},[s._v("119")]),t("br"),t("span",{staticClass:"line-number"},[s._v("120")]),t("br"),t("span",{staticClass:"line-number"},[s._v("121")]),t("br"),t("span",{staticClass:"line-number"},[s._v("122")]),t("br"),t("span",{staticClass:"line-number"},[s._v("123")]),t("br"),t("span",{staticClass:"line-number"},[s._v("124")]),t("br"),t("span",{staticClass:"line-number"},[s._v("125")]),t("br"),t("span",{staticClass:"line-number"},[s._v("126")]),t("br"),t("span",{staticClass:"line-number"},[s._v("127")]),t("br"),t("span",{staticClass:"line-number"},[s._v("128")]),t("br"),t("span",{staticClass:"line-number"},[s._v("129")]),t("br"),t("span",{staticClass:"line-number"},[s._v("130")]),t("br"),t("span",{staticClass:"line-number"},[s._v("131")]),t("br"),t("span",{staticClass:"line-number"},[s._v("132")]),t("br"),t("span",{staticClass:"line-number"},[s._v("133")]),t("br"),t("span",{staticClass:"line-number"},[s._v("134")]),t("br"),t("span",{staticClass:"line-number"},[s._v("135")]),t("br"),t("span",{staticClass:"line-number"},[s._v("136")]),t("br"),t("span",{staticClass:"line-number"},[s._v("137")]),t("br"),t("span",{staticClass:"line-number"},[s._v("138")]),t("br"),t("span",{staticClass:"line-number"},[s._v("139")]),t("br"),t("span",{staticClass:"line-number"},[s._v("140")]),t("br"),t("span",{staticClass:"line-number"},[s._v("141")]),t("br"),t("span",{staticClass:"line-number"},[s._v("142")]),t("br"),t("span",{staticClass:"line-number"},[s._v("143")]),t("br"),t("span",{staticClass:"line-number"},[s._v("144")]),t("br"),t("span",{staticClass:"line-number"},[s._v("145")]),t("br"),t("span",{staticClass:"line-number"},[s._v("146")]),t("br"),t("span",{staticClass:"line-number"},[s._v("147")]),t("br"),t("span",{staticClass:"line-number"},[s._v("148")]),t("br"),t("span",{staticClass:"line-number"},[s._v("149")]),t("br"),t("span",{staticClass:"line-number"},[s._v("150")]),t("br"),t("span",{staticClass:"line-number"},[s._v("151")]),t("br"),t("span",{staticClass:"line-number"},[s._v("152")]),t("br"),t("span",{staticClass:"line-number"},[s._v("153")]),t("br"),t("span",{staticClass:"line-number"},[s._v("154")]),t("br"),t("span",{staticClass:"line-number"},[s._v("155")]),t("br"),t("span",{staticClass:"line-number"},[s._v("156")]),t("br"),t("span",{staticClass:"line-number"},[s._v("157")]),t("br"),t("span",{staticClass:"line-number"},[s._v("158")]),t("br"),t("span",{staticClass:"line-number"},[s._v("159")]),t("br"),t("span",{staticClass:"line-number"},[s._v("160")]),t("br"),t("span",{staticClass:"line-number"},[s._v("161")]),t("br")])]),t("h3",{attrs:{id:"_1、镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、镜像"}},[s._v("#")]),s._v(" 1、镜像")]),s._v(" "),t("p",[s._v("在 Kubernetes 的 Pod 中使用容器镜像之前，我们必须将其推送到一个镜像仓库（或者使用仓库中已经有的容器镜像）。在 Kubernetes 的 Pod 定义中定义容器时，必须指定容器所使用的镜像，容器中的 "),t("font",{attrs:{color:"FF9933"}},[s._v("image")]),s._v("\n字段支持与 "),t("font",{attrs:{color:"FF9933"}},[s._v("docker")]),s._v("  命令一样的语法，包括私有镜像仓库和标签。")],1),s._v(" "),t("p",[t("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/_20220506170033.png",alt:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/_20220506170033.png"}})]),s._v(" "),t("p",[s._v("如果使用 "),t("font",{attrs:{color:"FF9933"}},[s._v("hub.dokcer.com")]),s._v(" "),t("strong",[s._v("Registry")]),s._v(" 中的镜像，可以省略 registry 地址和 registry 端口。例如：\n"),t("font",{attrs:{color:"FF9933"}},[s._v("nginx:latest")])],1),s._v(" "),t("p",[s._v("Kubernetes中，默认的镜像抓取策略是 "),t("font",{attrs:{color:"FF9933"}},[s._v("IfNotPresent")]),s._v(" ，使用此策略，kubelet在发现本机有镜像的情况下，不会向镜像仓库抓取镜像。如果您期望每次启动 Pod 时，都强制从镜像仓库抓取镜像，可以尝试如下方式：")],1),s._v(" "),t("ul",[t("li",[s._v("设置 container 中的\timagePullPolicy 为 Always")]),s._v(" "),t("li",[s._v("省略 "),t("font",{attrs:{color:"FF9933"}},[s._v("imagePullPolicy ")]),s._v("字段，并使用 "),t("font",{attrs:{color:"FF9933"}},[s._v(":latest")]),s._v("  tag 的镜像\n省略 "),t("font",{attrs:{color:"FF9933"}},[s._v("imagePullPolicy ")]),s._v(" 字段和镜像的 tag")],1),s._v(" "),t("li",[s._v("激活 AlwaysPullImages 管理控制器")])]),s._v(" "),t("p",[s._v("docker pull redis")]),s._v(" "),t("p",[s._v("docker.io/library/redis:latest")]),s._v(" "),t("p",[t("strong",[s._v("下载私有仓库镜像")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这个秘钥默认在default名称空间，不能被hello名称空间共享")]),s._v("\nkubectl create secret "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" hello docker-registry my-aliyun "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --docker-server"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("registry.cn-hangzhou.aliyuncs.com "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --docker-username"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("forsumlove "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --docker-password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cactusli\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 那个镜像对应哪个仓库没有任何问题")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" foo\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" foo\n\t"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" registry.cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("zhangjiakou.aliyuncs.com/cactuslidocker/cactusli"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" img"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1.0\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("imagePullSecrets")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mydocker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"_2、启动命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、启动命令"}},[s._v("#")]),s._v(" 2、启动命令")]),s._v(" "),t("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/20220506175831.png",alt:"启动命令"}}),s._v(" "),t("h3",{attrs:{id:"_3、环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、环境变量"}},[s._v("#")]),s._v(" 3、环境变量")]),s._v(" "),t("p",[s._v("env指定即可")]),s._v(" "),t("h3",{attrs:{id:"_4、生命周期容器钩子"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、生命周期容器钩子"}},[s._v("#")]),s._v(" 4、生命周期容器钩子")]),s._v(" "),t("p",[s._v("Kubernetes中为容器提供了两个 hook（钩子函数）：")]),s._v(" "),t("ul",[t("li",[t("font",{attrs:{color:"FF9933"}},[s._v("PostStart")])],1)]),s._v(" "),t("p",[s._v("此钩子函数在容器创建后将立刻执行。但是，并不能保证该钩子函数在容器的 "),t("font",{attrs:{color:"FF9933"}},[s._v(" ENTRYPOINT ")]),s._v("之前执行。该钩子函数没有输入参数。")],1),s._v(" "),t("ul",[t("li",[t("p",[t("font",{attrs:{color:"FF9933"}},[s._v("PreStop")])],1)]),s._v(" "),t("li",[t("p",[s._v("此钩子函数在容器被 terminate（终止）之前执行，例如：")]),s._v(" "),t("ul",[t("li",[s._v("通过接口调用删除容器所在 Pod")]),s._v(" "),t("li",[s._v("某些管理事件的发生：健康检查失败、资源紧缺等")])])])]),s._v(" "),t("p",[s._v("如果容器已经被关闭或者进入了  "),t("font",{attrs:{color:"FF9933"}},[s._v("completed")]),s._v(" 状态，preStop 钩子函数的调用将失败。该函数的执\n行是同步的，即，kubernetes   将在该函数完成执行之后才删除容器。该钩子函数没有输入参数。")],1),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" lifecycle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" lifecycle"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("container\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" alpine\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo hello; "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumeMounts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mount1\n         "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mountPath")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /app\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("lifecycle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("postStart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("exec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo world;"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preStop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("exec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\t    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo 66666;"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("ul",[t("li",[s._v("Kubernetes 在容器启动后立刻发送 postStart 事件，但是并不能确保 postStart 事件处理程序在容器的 EntryPoint 之前执行。postStart 事件处理程序相对于容器中的进程来说是异步的（同时执行）， 然而，Kubernetes 在管理容器时，将一直等到 postStart 事件处理程序结束之后，才会将容器的状态标记为 Running。")]),s._v(" "),t("li",[s._v("Kubernetes 在决定关闭容器时，立刻发送 preStop 事件，并且，将一直等到 preStop 事件处理程序结束或者 Pod 的   "),t("font",{attrs:{color:"FF9933"}},[s._v("--grace-period")]),s._v("\t超时，才删除容器。")],1)]),s._v(" "),t("h3",{attrs:{id:"_5、资源限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、资源限制"}},[s._v("#")]),s._v(" 5、资源限制")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[s._v("pods/qos/qos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("pod.yaml\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1 \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" qos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo \n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" qos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("example\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" qos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("demo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ctr \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx \n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("resources")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("limits")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 限制最大大小")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200Mi"')]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cpu")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"700m"')]),s._v("    \n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("requests")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动默认给分配的大小")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200Mi"')]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cpu")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"700m"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"_5、其他"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、其他"}},[s._v("#")]),s._v(" 5、其他")]),s._v(" "),t("p",[s._v("kubectl explain 解析一个资源Pod改怎么编写yaml")]),s._v(" "),t("p",[s._v("kubectl describe 用来排错的，看资源的状态")])])}),[],!1,null,null,null);t.default=e.exports}}]);