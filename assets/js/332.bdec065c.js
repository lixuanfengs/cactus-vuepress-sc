(window.webpackJsonp=window.webpackJsonp||[]).push([[332],{683:function(n,s,t){"use strict";t.r(s);var e=t(0),a=Object(e.a)({},(function(){var n=this,s=n._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h2",{attrs:{id:"架构预览"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#架构预览"}},[n._v("#")]),n._v(" 架构预览")]),n._v(" "),s("p",[n._v("在这一章节中，我们需要搭建如下所示的系统架构:")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/31/mxKKHI.png",alt:"A01.png"}})]),n._v(" "),s("p",[n._v("上面的架构中，主要包含了以下节点：")]),n._v(" "),s("ol",[s("li",[n._v("FEBS-Register：微服务注册中心，用于统一控制各个微服务实例的注册与发现；")]),n._v(" "),s("li",[n._v("FEBS-Gateway：微服务网关，统一处理外部请求，是客户端和众多微服务连接的桥梁；")]),n._v(" "),s("li",[n._v("FEBS-Auth：微服务认证服务器，用于令牌（Token）生成和令牌校验，是整个权限系统的核心所在；")]),n._v(" "),s("li",[n._v("FEBS-Server-System：微服务提供者（资源服务器）A，对外提供系统模块的CRUD服务；")]),n._v(" "),s("li",[n._v("FEBS-Server-Test：微服务提供者（资源服务器）B。")])]),n._v(" "),s("p",[n._v("本质上FEBS-Server-Test和FEBS-Server-System没有区别，构建FEBS-Server-Test的目的主要有如下三点：")]),n._v(" "),s("ol",[s("li",[n._v("演示一台认证服务器和多台资源服务器之间如何交互；")]),n._v(" "),s("li",[n._v("微服务间如何通过Feign Client来互相访问受保护的资源；")]),n._v(" "),s("li",[n._v("演示如何往FEBS Cloud微服务权限系统中接入自己的微服务模块；")])]),n._v(" "),s("p",[n._v("由于模块较多，所以开始之前我们先对各个微服务的端口做出如下约定：")]),n._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[n._v("微服务")]),n._v(" "),s("th",{staticStyle:{"text-align":"left"}},[n._v("端口号")])])]),n._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[n._v("FEBS-Register")]),n._v(" "),s("td",{staticStyle:{"text-align":"left"}},[n._v("8001")])]),n._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[n._v("FEBS-Auth")]),n._v(" "),s("td",{staticStyle:{"text-align":"left"}},[n._v("8101")])]),n._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[n._v("FEBS-Server-System")]),n._v(" "),s("td",{staticStyle:{"text-align":"left"}},[n._v("8201")])]),n._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[n._v("FEBS-Server-Test")]),n._v(" "),s("td",{staticStyle:{"text-align":"left"}},[n._v("8202")])]),n._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[n._v("FEBS-Gateway")]),n._v(" "),s("td",{staticStyle:{"text-align":"left"}},[n._v("8301")])])])]),n._v(" "),s("p",[n._v("下面我们正式开始框架的搭建。")]),n._v(" "),s("h2",{attrs:{id:"maven父模块搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#maven父模块搭建"}},[n._v("#")]),n._v(" Maven父模块搭建")]),n._v(" "),s("p",[n._v("首先我们使用IDEA创建一个名称为FEBS-Cloud的 Maven模块，该模块为整个工程的服务模块，用于聚合各个微服务子系统。")]),n._v(" "),s("p",[n._v("在D盘根目录创建一个名称为febs的文件夹，然后打开IDEA，点击Create New Project新建一个Maven项目，Project SDK选择JDK 1.8：")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2DY0P.png",alt:"1.png"}})]),n._v(" "),s("p",[n._v("点击Next，如下图所示填写GroupId和ArtifactId：")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2DJmt.png",alt:"2.png"}})]),n._v(" "),s("p",[n._v("点击Next，按照下图所示填写相关内容，路径选择D盘根目录下的febs：")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2D36A.png",alt:"3.png"}})]),n._v(" "),s("p",[n._v("点击Finish完成创建。创建好后，项目如下所示:")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2D8OI.png",alt:"4.png"}})]),n._v(" "),s("p",[n._v("因为febs-cloud模块是项目的父模块，仅用于聚合子模块，所以我们可以把src目录下的内容全部删了，保留pom.xml和febs-cloud.iml，然后修改pom.xml，引入Spring Boot和Spring Cloud：")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <modelVersion>4.0.0</modelVersion>\n\n    <groupId>cc.mrbird</groupId>\n    <artifactId>febs-cloud</artifactId>\n    <version>1.0-SNAPSHOT</version>\n    <packaging>pom</packaging>\n\n    <name>FEBS-Cloud</name>\n    <description>FEBS-Cloud：Spring Cloud，Spring Security OAuth2 微服务权限管理系统</description>\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.6.RELEASE</version>\n        <relativePath/> \x3c!-- lookup parent from repository --\x3e\n    </parent>\n\n    <properties>\n        <spring-cloud.version>Greenwich.SR1</spring-cloud.version>\n    </properties>\n\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>org.springframework.cloud</groupId>\n                <artifactId>spring-cloud-dependencies</artifactId>\n                <version>${spring-cloud.version}</version>\n                <type>pom</type>\n                <scope>import</scope>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n</project>\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br")])]),s("p",[n._v("上面的pom配置中，我们指定了packaging为pom，表示这是一个纯聚合模块，无需打包为jar或者war；name指定为FEBS-Cloud；引入了Spring Boot 2.1.6.RELEASE和Spring Cloud Greenwich.SR1。")]),n._v(" "),s("p",[n._v("至此，父模块搭建完毕，接下来开始搭建通用模块。")]),n._v(" "),s("h2",{attrs:{id:"通用模块搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通用模块搭建"}},[n._v("#")]),n._v(" 通用模块搭建")]),n._v(" "),s("p",[n._v("通用模块主要用于定义一些各个微服务通用的实体类，工具类或者第三方依赖等。")]),n._v(" "),s("p",[n._v("点击File -> New -> Module...，新建一个Maven模块，Module SDK选择JDK 1.8：")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2DlSH.png",alt:"5.png"}})]),n._v(" "),s("p",[n._v("点击Next：")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2DtTf.png",alt:"6.png"}})]),n._v(" "),s("p",[n._v("父模块选择我们上面创建好的febs-cloud，ArtifactId填febs-common，然后点击Next：")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2DUk8.png",alt:"7.png"}})]),n._v(" "),s("p",[n._v("填写内容如上图所示（注意febs-common和febs-cloud都位于febs目录下，它们在目录结构上是平级的关系），点击Finish完成创建。创建好后，项目结构如下所示：")]),n._v(" "),s("p",[s("a",{attrs:{href:"https://imgchr.com/i/e2DatS",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2DatS.png",alt:"8.png"}}),s("OutboundLink")],1)]),n._v(" "),s("p",[n._v("这时候我们查看febs-cloud的pom文件，会发现它新增了如下内容：")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("<modules>\n    <module>../febs-common</module>\n</modules>\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br")])]),s("p",[n._v("因为我们刚刚在创建febs-common模块的时候选择febs-cloud作为父模块。")]),n._v(" "),s("p",[n._v("我们往febs-common模块的pom里添加一些后续要用到的依赖：")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>febs-cloud</artifactId>\n        <groupId>cc.mrbird</groupId>\n        <version>1.0-SNAPSHOT</version>\n        <relativePath>../febs-cloud/pom.xml</relativePath>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>febs-common</artifactId>\n    <name>FEBS-Common</name>\n    <description>FEBS-Common通用模块</description>\n\n    <dependencies>\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.alibaba</groupId>\n            <artifactId>fastjson</artifactId>\n            <version>1.2.51</version>\n        </dependency>\n        <dependency>\n            <groupId>org.apache.commons</groupId>\n            <artifactId>commons-lang3</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-oauth2</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-security</artifactId>\n        </dependency>\n    </dependencies>\n</project>\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br"),s("span",{staticClass:"line-number"},[n._v("39")]),s("br"),s("span",{staticClass:"line-number"},[n._v("40")]),s("br"),s("span",{staticClass:"line-number"},[n._v("41")]),s("br"),s("span",{staticClass:"line-number"},[n._v("42")]),s("br"),s("span",{staticClass:"line-number"},[n._v("43")]),s("br"),s("span",{staticClass:"line-number"},[n._v("44")]),s("br")])]),s("p",[n._v("lombok的使用需要安装相关插件（lombok可以通过注解自动生成get，set等方法，不懂的同学可以自行百度lombok），双击Shift，然后输入plugins：")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2Ddfg.png",alt:"9.png"}})]),n._v(" "),s("p",[n._v("选择第一个，然后按Enter键，输入lombok，安装列表中的第一个，然后重启IDEA即可：")]),n._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/08/05/e2D0pQ.png",alt:"10.png"}})]),n._v(" "),s("p",[n._v("至此，通用模块也搭建完毕了，接下来开始搭建微服务注册中心。")])])}),[],!1,null,null,null);s.default=a.exports}}]);