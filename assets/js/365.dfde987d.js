(window.webpackJsonp=window.webpackJsonp||[]).push([[365],{721:function(s,n,a){"use strict";a.r(n);var e=a(0),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("这节的目的是搭建一个多维度监控微服务的可视化平台，包括Docker容器监控、MySQL监控、Redis监控和微服务JVM监控等，并且在必要的情况下可以发送预警邮件。")]),s._v(" "),n("p",[s._v("这节主要用到的组件有Prometheus、Grafana、alertmanager、node_exporter、mysql_exporter、redis_exporter、cadvisor。各自作用如下所示：")]),s._v(" "),n("ol",[n("li",[s._v("Prometheus：获取、存储监控数据，供第三方查询；")]),s._v(" "),n("li",[s._v("Grafana：提供Web页面，从Prometheus获取监控数据可视化展示；")]),s._v(" "),n("li",[s._v("alertmanager：定义预警规则，发送预警信息；")]),s._v(" "),n("li",[s._v("node_exporter：收集微服务端点监控数据；")]),s._v(" "),n("li",[s._v("mysql_exporter：收集MySQL数据库监控数据；")]),s._v(" "),n("li",[s._v("redis_exporter：收集Redis监控数据；")]),s._v(" "),n("li",[s._v("cadvisor：收集Docker容器监控数据。")])]),s._v(" "),n("h2",{attrs:{id:"准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[s._v("#")]),s._v(" 准备工作")]),s._v(" "),n("p",[s._v("传统方式部署这么多软件比较麻烦，所以我们还是在之前Vagrant搭建的centos虚拟机（我的虚拟机IP为192.168.33.10）里使用Docker来安装。")]),s._v(" "),n("p",[s._v("因为本节涉及到MySQL和Redis的监控，如果你的linux机器上还没有安装MySQL和Redis，可以使用docker compose创建并运行这两个容器：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("version: '3'\n\nservices:\n  mysql:\n    image: mysql:5.7.24\n    container_name: mysql\n    environment:\n      MYSQL_ROOT_PASSWORD: 123456\n    ports:\n      - 3306:3306\n    volumes:\n      - /febs/mysql/data:/var/lib/mysql #挂载 MySQL数据\n  redis:\n    image: redis:4.0.14\n    container_name: redis\n    command: redis-server /usr/local/etc/redis/redis.conf --appendonly yes\n    volumes:\n      - /febs/redis/data:/data #挂载 Redis数据\n      - /febs/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf #挂载 Redis配置\n    ports:\n      - 6379:6379\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZ8n54.png",alt:"360.png"}})]),s._v(" "),n("h2",{attrs:{id:"接入prometheus"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#接入prometheus"}},[s._v("#")]),s._v(" 接入Prometheus")]),s._v(" "),n("p",[s._v("微服务接入Pormetheus只需要在febs-common模块引入下面这个依赖即可：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("<dependency>\n    <groupId>io.micrometer</groupId>\n    <artifactId>micrometer-registry-prometheus</artifactId>\n</dependency>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("Prometheus端点的暴露依赖于"),n("code",[s._v("spring-boot-starter-actuator")]),s._v("，因为我们之前在febs common模块里引入了"),n("code",[s._v("spring-boot-admin-client")]),s._v("依赖，该依赖包含"),n("code",[s._v("spring-boot-starter-actuator")]),s._v("，所以无需再额外引入了。")]),s._v(" "),n("p",[s._v("启动febs-auth、febs-server-system和febs-server-test，然后通过IDEA查看是否已经包含/actuator/prometheus端点：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZYQ2j.png",alt:"361.png"}})]),s._v(" "),n("p",[s._v("接着回到虚拟机，因为接下来需要创建的服务较多，所以先约定下各个服务的端口号：")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"left"}},[s._v("服务")]),s._v(" "),n("th",{staticStyle:{"text-align":"left"}},[s._v("端口")])])]),s._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("prometheus")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("8403")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("grafana")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("8404")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("node_exporter")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("8405")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("alertmanager")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("8406")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("cadvisor")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("8407")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("redis_exporter")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("8408")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[s._v("mysql_exporter")]),s._v(" "),n("td",{staticStyle:{"text-align":"left"}},[s._v("8409")])])])]),s._v(" "),n("p",[s._v("在创建这些服务之前，我们需要创建相关挂载目录和配置文件。")]),s._v(" "),n("p",[s._v("在虚拟机中创建Prometheus挂载目录和配置文件：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#创建Prometheus挂载目录\nmkdir -p /febs/prometheus\n\n#在该目录下创建Prometheus配置文件\nvim /febs/prometheus/prometheus.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("promethues.yml配置文件内容如下所示：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("global:\n  scrape_interval:     15s\n  evaluation_interval: 15s\n\nscrape_configs:\n  - job_name: 'prometheus'\n    static_configs:\n      - targets: ['192.168.33.10:8403']\n  - job_name: 'node_exporter'\n    static_configs:\n      - targets: ['192.168.33.10:8405']\n        labels:\n          instance: 'node_exporter'\n  - job_name: 'redis_exporter'\n    static_configs:\n      - targets: ['192.168.33.10:8408']\n        labels:\n          instance: 'redis_exporter'\n  - job_name: 'mysql_exporter'\n    static_configs:\n      - targets: ['192.168.33.10:8409']\n        labels:\n          instance: 'mysql_exporter'\n  - job_name: 'cadvisor'\n    static_configs:\n      - targets: ['192.168.33.10:8407']\n        labels:\n          instance: 'cadvisor'\n\n  - job_name: 'febs-server-system-actuator'\n    metrics_path: '/actuator/prometheus'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['192.168.73.42:8201']\n        labels:\n          instance: 'febs-server-system'\n  - job_name: 'febs-server-auth-actuator'\n    metrics_path: '/actuator/prometheus'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['192.168.73.42:8101']\n        labels:\n          instance: 'febs-auth'\n  - job_name: 'febs-server-test-actuator'\n    metrics_path: '/actuator/prometheus'\n    scrape_interval: 5s\n    static_configs:\n      - targets: ['192.168.73.42:8202']\n        labels:\n          instance: 'febs-server-test'\nrule_files:\n  - 'memory_over.yml'\n  - 'server_down.yml'\nalerting:\n  alertmanagers:\n    - static_configs:\n        - targets: [\"192.168.33.10:8406\"]\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br")])]),n("p",[s._v("配置的具体含义如下图所示：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZU6Zq.png",alt:"362.png"}})]),s._v(" "),n("p",[s._v("值得注意的是，每个服务的targets都是一个数组，言外之意就是可以收集多个服务器下的exporter提供的监控数据。")]),s._v(" "),n("p",[s._v("接着创建上面提到的两个监控规则memory_over.yml和server_down.yml：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 创建memory_over.yml\nvim /febs/prometheus/memory_over.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("内容如下所示：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('groups:\n  - name: memory_over\n    rules:\n      - alert: NodeMemoryUsage\n        expr: (node_memory_MemTotal_bytes - (node_memory_MemFree_bytes+node_memory_Buffers_bytes+node_memory_Cached_bytes )) / node_memory_MemTotal_bytes * 100 > 80\n        for: 20s\n        labels:\n          user: MrBird\n        annotations:\n          summary: "{{$labels.instance}}: High Memory usage detected"\n          description: "{{$labels.instance}}: Memory usage is above 80% (current value is:{{ $value }})"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("含义是，当某个节点的内存使用率大于80%，并且持续时间大于20秒后，触发监控预警。")]),s._v(" "),n("p",[s._v("接着创建server_down.yml：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 创建server_down.yml\nvim /febs/prometheus/server_down.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("内容如下所示：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('groups:\n  - name: server_down\n    rules:\n      - alert: InstanceDown\n        expr: up == 0\n        for: 20s\n        labels:\n          user: MrBird\n        annotations:\n          summary: "Instance {{ $labels.instance }} down"\n          description: "{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 20 s."\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("含义是，当某个节点宕机（up==0表示宕机，1表示正常运行）超过20秒后，则触发监控。")]),s._v(" "),n("p",[s._v("接着创建alertmanager相关挂载目录和配置：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 创建alertmanager挂载目录 /febs/alertmanager\nmkdir -p /febs/alertmanager\n\n# 创建alertmanager配置文件alertmanager.yml\nvim /febs/alertmanager/alertmanager.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("alertmanager.yml内容如下所示：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("global:\n  smtp_smarthost: 'smtp.126.com:465'\n  smtp_from: 'wuyouzhuguli@126.com'\n  smtp_auth_username: 'wuyouzhuguli'\n  smtp_auth_password: '123456'\n  smtp_require_tls: false\n\n#templates:\n#  - '/alertmanager/template/*.tmpl'\n\nroute:\n  group_by: ['alertname']\n  group_wait: 10s\n  group_interval: 5m\n  repeat_interval: 5m\n  receiver: 'default-receiver'\n\nreceivers:\n  - name: 'default-receiver'\n    email_configs:\n      - to: '852252810@qq.com'\n        send_resolved: true\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("配置文件的含义如下所示：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZwSat.png",alt:"363.png"}})]),s._v(" "),n("p",[s._v("其中，"),n("code",[s._v("smtp_auth_password")]),s._v("并不是邮件的密码，而是授权码，以126为例，授权码可以在下面这个页面定义：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZwNIx.png",alt:"364.png"}})]),s._v(" "),n("p",[s._v("创建好后，我们接着在/febs目录下创建一个docker-compose.yml文件，用于构建上面提到的那些服务：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 创建docker-compose.yml\nvim /febs/docker-compose.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("内容如下所示：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("version: '3'\n\nservices:\n  prometheus:\n    image: prom/prometheus\n    container_name: prometheus\n    volumes:\n      - /febs/prometheus/:/etc/prometheus/\n    ports:\n      - 8403:9090\n    restart: on-failure\n  node_exporter:\n    image: prom/node-exporter\n    container_name: node_exporter\n    ports:\n      - 8405:9100\n  redis_exporter:\n    image: oliver006/redis_exporter\n    container_name: redis_exporter\n    command:\n      - '--redis.addr=redis://192.168.33.10:6379'\n    ports:\n      - 8408:9121\n    restart: on-failure\n  mysql_exporter:\n    image: prom/mysqld-exporter\n    container_name: mysql_exporter\n    environment:\n      - DATA_SOURCE_NAME=root:123456@(192.168.33.10:3306)/\n    ports:\n      - 8409:9104\n  cadvisor:\n    image: google/cadvisor\n    container_name: cadvisor\n    volumes:\n      - /:/rootfs:ro\n      - /var/run:/var/run:rw\n      - /sys:/sys:ro\n      - /var/lib/docker/:/var/lib/docker:ro\n    ports:\n      - 8407:8080\n  alertmanager:\n    image: prom/alertmanager\n    container_name: alertmanager\n    volumes:\n      - /febs/alertmanager/alertmanager.yml:/etc/alertmanager/alertmanager.yml\n    ports:\n      - 8406:9093\n  grafana:\n    image: grafana/grafana\n    container_name: grafana\n    ports:\n      - 8404:3000\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br")])]),n("p",[s._v("其中，在创建redis_exporter和mysql_exporter的时候需要指定它们的IP、端口和密码等配置。")]),s._v(" "),n("p",[s._v("然后在/febs目录下使用"),n("code",[s._v("docker-compose up -d")]),s._v("启动这些容器：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZsp36.png",alt:"365.png"}})]),s._v(" "),n("p",[s._v("容器运行成功后，在浏览器里访问：http://192.168.33.10:8403/alerts：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZsavT.png",alt:"366.png"}})]),s._v(" "),n("p",[s._v("可以看的刚刚定义的两个告警规则已经成功加载。")]),s._v(" "),n("p",[s._v("访问http://192.168.33.10:8403/targets，观察在Prometheus配置文件里定义的各个job的状态：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZsLxf.png",alt:"367.png"}})]),s._v(" "),n("p",[s._v("可以看的都是监控的UP状态。")]),s._v(" "),n("p",[s._v("还可以点击上面这个页面的各个xxx_exporter的链接，如果页面显示出了收集的数据，则说明各个exporter已经成功采集到了数据，以mysql_exporter为例子，访问http://192.168.33.10:8409/metrics：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZysOS.png",alt:"368.png"}})]),s._v(" "),n("p",[s._v("访问http://192.168.33.10:8406/#/status看看我们在alertmanager.yml配置的规则是否已经生效:")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZ6Vpt.png",alt:"369.png"}})]),s._v(" "),n("p",[s._v("现在监控数据都准备好了，接下来使用grafana以图形化的方式呈现它们。")]),s._v(" "),n("h2",{attrs:{id:"grafana使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#grafana使用"}},[s._v("#")]),s._v(" Grafana使用")]),s._v(" "),n("p",[s._v("使用浏览器访问"),n("a",{attrs:{href:"http://192.168.33.10:8404/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://192.168.33.10:8404"),n("OutboundLink")],1),s._v("，用户名密码为admin/admin，首次登录需要修改密码。")]),s._v(" "),n("p",[s._v("进入主页后，我们修改下主题，让接下来的演示更为清晰：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZ6vNj.png",alt:"370"}})]),s._v(" "),n("p",[s._v("然后回到主页点击Add data source添加数据源：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZcJ5d.png",alt:"371.png"}})]),s._v(" "),n("p",[s._v("选择Prometheus，URL填写"),n("a",{attrs:{href:"http://192.168.33.10:8403/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://192.168.33.10:8403"),n("OutboundLink")],1),s._v(":")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZRCvt.png",alt:"372.png"}})]),s._v(" "),n("p",[s._v("然后点击页面下方的save & test即可。")]),s._v(" "),n("p",[s._v("数据源添加好后，就可以继续添加监控面板了，如下图所示创建一个新的监控：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZWQWd.png",alt:"373.png"}})]),s._v(" "),n("p",[s._v("点击Add Query：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZf9nP.png",alt:"374.png"}})]),s._v(" "),n("p",[s._v("这样创建监控面板比较麻烦，可以到Grafana官方市场选择别人配置好的模板：https://grafana.com/grafana/dashboards。")]),s._v(" "),n("p",[s._v("别人的模板也未必一定就100%适合，这里我准备好了四个监控面板，你只需要导入即可：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZftj1.png",alt:"375.png"}})]),s._v(" "),n("p",[s._v("这四个文件我已经上传到了百度云: https://pan.baidu.com/s/1ybTg8NEvGSsAaunpvzZyMg&shfl=shareset 提取码: fh3t")]),s._v(" "),n("p",[s._v("下面演示如何导入。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZf54g.png",alt:"376.png"}})]),s._v(" "),n("p",[s._v("然后点击页面的Upload .json file按钮选择上面的json文件，比如导入Docker容器监控面板：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZfx5F.png",alt:"377.png"}})]),s._v(" "),n("p",[s._v("点击Import后，效果如下所示：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZhkb6.png",alt:"378.png"}})]),s._v(" "),n("p",[s._v("页面将显示Docker容器数量，每个容器CPU使用率，容量等等信息。剩下的三个模板自己导入即可，这里就不再演示了。")]),s._v(" "),n("h2",{attrs:{id:"测试告警"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试告警"}},[s._v("#")]),s._v(" 测试告警")]),s._v(" "),n("p",[s._v("我们在IDEA中关停febs auth服务，然后使用浏览器访问http://192.168.33.10:8403/alerts：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZ4PJg.png",alt:"379.png"}})]),s._v(" "),n("p",[s._v("可以看到，页面显示该端点已经处于PENDING（等待）状态，20秒后（server_down.yml里定义的时间）应用还是不可用的话，则认为该服务已经是（宕机）状态，则会触发server_down预警：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZ47mq.png",alt:"380.png"}})]),s._v(" "),n("p",[s._v("使用浏览器访问http://192.168.33.10:8406/#/alerts可以看到alertmanager已经收到了这笔预警：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZ4zc9.png",alt:"381.png"}})]),s._v(" "),n("p",[s._v("过一会（5秒的扫描时间+20秒的等待确认时间+10秒的分组等待时间）你的邮箱将收到如下所示的邮件：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZ5C0x.png",alt:"382.png"}})]),s._v(" "),n("p",[s._v("重新启动febs auth服务，不久后你将收到resolved（告警已解决）邮件：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.ax1x.com/2019/10/18/KZIwMd.png",alt:"383.png"}})]),s._v(" "),n("p",[s._v("memory_over不太好测试，这里就不演示了。")]),s._v(" "),n("h2",{attrs:{id:"附录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[s._v("#")]),s._v(" 附录")]),s._v(" "),n("p",[s._v("到这里我们已经成功搭建了一套完善的监控系统，并实现了预警功能。alertmanager支持非常丰富的预警配置，下面列举一些：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('groups:\n- name: example #定义规则组\n  rules:\n  - alert: InstanceDown  #定义报警名称\n    expr: up == 0   #Promql语句，触发规则\n    for: 1m            # 一分钟\n    labels:       #标签定义报警的级别和主机\n      name: instance\n      severity: Critical\n    annotations:  #注解\n      summary: " {{ $labels.appname }}" #报警摘要，取报警信息的appname名称\n      description: " 服务停止运行 "   #报警信息\n      value: "{{ $value }}%"  # 当前报警状态值\n- name: Host\n  rules:\n  - alert: HostMemory Usage\n    expr: (node_memory_MemTotal_bytes - (node_memory_MemFree_bytes + node_memory_Buffers_bytes + node_memory_Cached_bytes)) / node_memory_MemTotal_bytes * 100 >  80\n    for: 1m\n    labels:\n      name: Memory\n      severity: Warning\n    annotations:\n      summary: " {{ $labels.appname }} "\n      description: "宿主机内存使用率超过80%."\n      value: "{{ $value }}"\n  - alert: HostCPU Usage\n    expr: sum(avg without (cpu)(irate(node_cpu_seconds_total{mode!=\'idle\'}[5m]))) by (instance,appname) > 0.65\n    for: 1m\n    labels:\n      name: CPU\n      severity: Warning\n    annotations:\n      summary: " {{ $labels.appname }} "\n      description: "宿主机CPU使用率超过65%."\n      value: "{{ $value }}"\n  - alert: HostLoad \n    expr: node_load5 > 4\n    for: 1m\n    labels:\n      name: Load\n      severity: Warning\n    annotations:\n      summary: "{{ $labels.appname }} "\n      description: " 主机负载5分钟超过4."\n      value: "{{ $value }}"\n  - alert: HostFilesystem Usage\n    expr: 1-(node_filesystem_free_bytes / node_filesystem_size_bytes) >  0.8\n    for: 1m\n    labels:\n      name: Disk\n      severity: Warning\n    annotations:\n      summary: " {{ $labels.appname }} "\n      description: " 宿主机 [ {{ $labels.mountpoint }} ]分区使用超过80%."\n      value: "{{ $value }}%"\n  - alert: HostDiskio\n    expr: irate(node_disk_writes_completed_total{job=~"Host"}[1m]) > 10\n    for: 1m\n    labels:\n      name: Diskio\n      severity: Warning\n    annotations:\n      summary: " {{ $labels.appname }} "\n      description: " 宿主机 [{{ $labels.device }}]磁盘1分钟平均写入IO负载较高."\n      value: "{{ $value }}iops"\n  - alert: Network_receive\n    expr: irate(node_network_receive_bytes_total{device!~"lo|bond[0-9]|cbr[0-9]|veth.*|virbr.*|ovs-system"}[5m]) / 1048576  > 3 \n    for: 1m\n    labels:\n      name: Network_receive\n      severity: Warning\n    annotations:\n      summary: " {{ $labels.appname }} "\n      description: " 宿主机 [{{ $labels.device }}] 网卡5分钟平均接收流量超过3Mbps."\n      value: "{{ $value }}3Mbps"\n  - alert: Network_transmit\n    expr: irate(node_network_transmit_bytes_total{device!~"lo|bond[0-9]|cbr[0-9]|veth.*|virbr.*|ovs-system"}[5m]) / 1048576  > 3\n    for: 1m\n    labels:\n      name: Network_transmit\n      severity: Warning\n    annotations:\n      summary: " {{ $labels.appname }} "\n      description: " 宿主机 [{{ $labels.device }}] 网卡5分钟内平均发送流量超过3Mbps."\n      value: "{{ $value }}3Mbps"\n- name: Container\n  rules:\n  - alert: ContainerCPU Usage\n    expr: (sum by(name,instance) (rate(container_cpu_usage_seconds_total{image!=""}[5m]))*100) > 60\n    for: 1m\n    labels:\n      name: CPU\n      severity: Warning\n    annotations:\n      summary: "{{ $labels.name }} "\n      description: " 容器CPU使用超过60%."\n      value: "{{ $value }}%"\n  - alert: ContainerMem Usage\n#    expr: (container_memory_usage_bytes - container_memory_cache)  / container_spec_memory_limit_bytes   * 100 > 10  \n    expr:  container_memory_usage_bytes{name=~".+"}  / 1048576 > 1024\n    for: 1m\n    labels:\n      name: Memory\n      severity: Warning\n    annotations:\n      summary: "{{ $labels.name }} "\n      description: " 容器内存使用超过1GB."\n      value: "{{ $value }}G"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br")])]),n("p",[s._v("复制")]),s._v(" "),n("p",[s._v("预警除了使用邮件外，也可以使用企业微信接收，可以参考：https://songjiayang.gitbooks.io/prometheus/content/alertmanager/wechat.html")])])}),[],!1,null,null,null);n.default=t.exports}}]);