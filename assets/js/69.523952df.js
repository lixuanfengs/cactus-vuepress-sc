(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{421:function(s,a,t){"use strict";t.r(a);var e=t(0),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"rancher搭建k8s集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rancher搭建k8s集群"}},[s._v("#")]),s._v(" rancher搭建k8s集群")]),s._v(" "),a("h3",{attrs:{id:"rancher简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rancher简介"}},[s._v("#")]),s._v(" rancher简介")]),s._v(" "),a("p",[s._v("rancher是一套容器管理平台,它可以帮助组织在生产环境中轻松快捷的部署和管理容器,rancher可以轻松地管理各种环境的kubernetes,满足IT需求并为devops团队提供支持")]),s._v(" "),a("p",[s._v("Kubernetes 不仅已经成为的容器编排标准，它也正在迅速成为各类云和虚拟化厂商提供的标")]),s._v(" "),a("p",[s._v("准基础架构。Rancher 用户可以选择使用 Rancher Kubernetes Engine(RKE)创建 Kubernetes")]),s._v(" "),a("p",[s._v("集群，也可以使用 GKE，AKS 和 EKS 等云 Kubernetes 服务。 Rancher 用户还可以导入和管理")]),s._v(" "),a("p",[s._v("现有的 Kubernetes 集群")]),s._v(" "),a("h3",{attrs:{id:"rancher的作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rancher的作用"}},[s._v("#")]),s._v(" rancher的作用")]),s._v(" "),a("p",[s._v("Rancher 支持各类集中式身份验证系统来管理 Kubernetes 集群。例如，大型企业的员工可以")]),s._v(" "),a("p",[s._v("使用其公司 Active Directory 凭证访问 GKE 中的 Kubernetes 集群。IT 管理员可以在用户，组，")]),s._v(" "),a("p",[s._v("项目，集群和云中设置访问控制和安全策略。 IT 管理员可以在单个页面对所有 Kubernetes 集群")]),s._v(" "),a("p",[s._v("的健康状况和容量进行监控")]),s._v(" "),a("p",[s._v("Rancher 为 DevOps 工程师提供了一个直观的用户界面来管理他们的服务容器，用户不需要深")]),s._v(" "),a("p",[s._v("入了解 Kubernetes 概念就可以开始使用 Rancher。 Rancher 包含应用商店，支持一键式部署")]),s._v(" "),a("p",[s._v("Helm 和 Compose 模板。Rancher 通过各种云、本地生态系统产品认证，其中包括安全工具，监")]),s._v(" "),a("p",[s._v("控系统，容器仓库以及存储和网络驱动程序。下图说明了 Rancher 在 IT 和 DevOps 组织中扮演的")]),s._v(" "),a("p",[s._v("角色。每个团队都会在他们选择的公共云或私有云上部署应用程序")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/image20.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"初始化环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化环境"}},[s._v("#")]),s._v(" 初始化环境")]),s._v(" "),a("h4",{attrs:{id:"环境说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境说明"}},[s._v("#")]),s._v(" 环境说明")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 虚拟主机至少要4c4g的配置")]),s._v("\nxiaomao5   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.11   部署master    centos7\nxiaomao8   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.12   部署rancher\nxiaomao7   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.9    部署k8s-node\nxiaomao6   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.10   部署k8s-node\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"关闭防火墙"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭防火墙"}},[s._v("#")]),s._v(" 关闭防火墙")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭selinux和防火墙")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop firewalld.service && systemctl disable firewalld.service ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sudo sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"配置hosts解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置hosts解析"}},[s._v("#")]),s._v(" 配置hosts解析")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其他机器操作一样")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/hosts")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat !$")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/hosts\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.12   xiaomao8\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.11   xiaomao5\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.9    xiaomao7\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.10   xiaomao6\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"部署docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署docker"}},[s._v("#")]),s._v(" 部署docker")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其他台配置一样")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install -y yum-utils device-mapper-persistent-data lvm2")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置docker的yum源")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  yum-config-manager --add-repo  http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装docker")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install docker-ce docker-ce-cli containerd.io -y")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker镜像加速")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  sudo mkdir -p /etc/docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["https://wlwmxdoi.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"时间同步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#时间同步"}},[s._v("#")]),s._v(" 时间同步")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其他台配置一样")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将硬件时钟调整为与本地时钟一致, 0 为设置为 UTC 时间")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#timedatectl set-local-rtc 1 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# timedatectl set-timezone Asia/Shanghai # 设置系统时区为上海")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install ntpdate")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ntpdate -u cn.pool.ntp.org")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "*/20 * * * * /usr/sbin/ntpdate -u ntp1.aliyun.com >/dev/null &" >> /var/spool/cron/root')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"安装rancher"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装rancher"}},[s._v("#")]),s._v(" 安装rancher")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --restart=unless-stopped   -p 80:80 -p 443:443   --privileged   rancher/rancher:v2.5.9")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器是否启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8_rancher ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -a")]),s._v("\nCONTAINER ID   IMAGE                    COMMAND           CREATED         STATUS         PORTS                                                                      NAMES\n3789f3955e2f   rancher/rancher:v2.5.9   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"entrypoint.sh"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" minutes ago   Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" minutes   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:80-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::80-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:443-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/tcp, :::443-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("443")]),s._v("/tcp   busy_agnesi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#访问"}},[s._v("#")]),s._v(" 访问")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/image21.png",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/image22.png",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/image23.png",alt:""}})]),s._v(" "),a("h4",{attrs:{id:"进到主界面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进到主界面"}},[s._v("#")]),s._v(" 进到主界面")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/image24.png",alt:""}})]),s._v(" "),a("h4",{attrs:{id:"修改语言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改语言"}},[s._v("#")]),s._v(" 修改语言")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/image25.png",alt:""}})]),s._v(" "),a("h4",{attrs:{id:"添加集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加集群"}},[s._v("#")]),s._v(" 添加集群")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/image26.png",alt:""}})]),s._v(" "),a("p",[a("img",{attrs:{src:"G:/BaiduNetdiskDownload/%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/%E7%BB%9F%E4%B8%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/images/image27.png",alt:""}})]),s._v(" "),a("p",[s._v("添加集群名称")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/image28.png",alt:""}})]),s._v(" "),a("p",[s._v("选择k8s版本")]),s._v(" "),a("p",[a("img",{attrs:{src:"G:/BaiduNetdiskDownload/%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/%E7%BB%9F%E4%B8%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/images/image29.png",alt:""}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("下一步保存即可\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"添加master"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加master"}},[s._v("#")]),s._v(" 添加master")]),s._v(" "),a("p",[a("img",{attrs:{src:"G:/BaiduNetdiskDownload/%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/%E7%BB%9F%E4%B8%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/images/image30.png",alt:""}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao5 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sudo docker run -d --privileged --restart=unless-stopped --net=host -v /etc/kubernetes:/etc/kubernetes -v /var/run:/var/run  rancher/rancher-agent:v2.5.9 --server https://10.2.32.12 --token 8sqr27gr47bp7n9xhpl4dwr49qxb5pdcfcr7tfkqrmpd6bv55nkb8b --ca-checksum c42f05546d568808c61f5507d5e85a7a3ff328ed27bf48c3ee09013c594dc60b --etcd --controlplane --worker")]),s._v("\nUnable to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" image "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rancher/rancher-agent:v2.5.9'")]),s._v(" locally\nv2.5.9: Pulling from rancher/rancher-agent\ne7ae86ffe2df: Already exists\n0714db40c98d: Pull complete\nb333df598dd1: Pull complete\n53181d4e7750: Pull complete\n4ba329d15c04: Pull complete\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("181703478924")]),s._v(": Pull complete\nd0add02860ad: Pull complete\nc7118343d245: Pull complete\n428cad6e906b: Pull complete\nDigest: sha256:fee10940c61c36055120ca9ef624810a740647cff4751d0b21266939c9da4b93\nStatus: Downloaded newer image "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" rancher/rancher-agent:v2.5.9\nd9dcf6283a6eda52212520d20ea9c30d1bbf9945a857b242f366b3dfcfb895a9\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"添加node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加node"}},[s._v("#")]),s._v(" 添加node")]),s._v(" "),a("p",[s._v("看到注册后不要着急点完成,继续添加work才行")]),s._v(" "),a("p",[a("img",{attrs:{src:"G:/BaiduNetdiskDownload/%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/%E7%BB%9F%E4%B8%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/images/image31.png",alt:""}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 来个node执行以下命令加入集群,看到注册完后在点击完成")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("unless-stopped "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--net")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("host "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /etc/kubernetes:/etc/kubernetes "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /var/run:/var/run  rancher/rancher-agent:v2.5.9 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--server")]),s._v(" https://10.2.32.12 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--token")]),s._v(" qhfpwfqfm4pglqf7pccfjl8n52c5m8l5fp8np4hs7qshb8lz5vdm58 --ca-checksum c42f05546d568808c61f5507d5e85a7a3ff328ed27bf48c3ee09013c594dc60b "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--worker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"集群部署完成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群部署完成"}},[s._v("#")]),s._v(" 集群部署完成")]),s._v(" "),a("p",[s._v("等待10来分钟后集群就注册完成了")]),s._v(" "),a("p",[a("img",{attrs:{src:"G:/BaiduNetdiskDownload/%E6%96%87%E6%A1%A3%E7%AC%94%E8%AE%B0/%E7%BB%9F%E4%B8%80%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/images/image32.png",alt:""}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果在搭建的过程中失败,重新搭建过的话，记得要删除干净原先的文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /var/lib/kubelet/* "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /etc/kubernetes/* "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /etc/cni/* "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /var/lib/rancher/* "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /var/lib/etcd/* "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /var/lib/cni/* "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /opt/cni/* "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后重启docker即可")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);