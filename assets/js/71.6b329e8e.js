(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{430:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"jenkins部署使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins部署使用"}},[s._v("#")]),s._v(" Jenkins部署使用")]),s._v(" "),a("h3",{attrs:{id:"环境的基本概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境的基本概念"}},[s._v("#")]),s._v(" 环境的基本概念")]),s._v(" "),a("p",[s._v("一个软件产品从开发到用户使用涉及的开发环境、测试环境、预发布环境、生产环境;")]),s._v(" "),a("h4",{attrs:{id:"测试环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试环境"}},[s._v("#")]),s._v(" 测试环境")]),s._v(" "),a("p",[s._v("测试环境:一般会由测试人员来部署,然后将开发好的代码在此环境中进行集中测试;")]),s._v(" "),a("h4",{attrs:{id:"预发布环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预发布环境"}},[s._v("#")]),s._v(" 预发布环境")]),s._v(" "),a("p",[s._v("预发布环境:测试环境到生产环境的过渡")]),s._v(" "),a("p",[s._v("测试环境可能无法与生产环境保持高度一致,从而能够测试的数据不够完整,会造成很多流程没有测试到位,")]),s._v(" "),a("p",[s._v("就可以在预发布环境进行测试,从而保证产品上线质量")]),s._v(" "),a("h4",{attrs:{id:"生产环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生产环境"}},[s._v("#")]),s._v(" 生产环境")]),s._v(" "),a("p",[s._v("生产环境:即线上环境,对外提供给用户使用的环境,由运维人员来维护,其他人员几乎无权限")]),s._v(" "),a("h4",{attrs:{id:"预生产与生产的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预生产与生产的区别"}},[s._v("#")]),s._v(" 预生产与生产的区别")]),s._v(" "),a("p",[s._v("1、预发布环境中新功能为最新代码,其他功能代码和生产环境一致")]),s._v(" "),a("p",[s._v("2、预发布环境和生产环境的访问域名不同")]),s._v(" "),a("p",[s._v("注意事项:预发布环境一般会连接生产环境的数据库,测试时要注意.以免产生脏数据,从而影响生产环境")]),s._v(" "),a("h3",{attrs:{id:"什么是代码部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是代码部署"}},[s._v("#")]),s._v(" 什么是代码部署")]),s._v(" "),a("p",[s._v("代码发布是指将开发写好的代码部署至指定的web服务器,然后对外提供服务")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639537901616-b43b0e94-b183-403d-83d6-4cad3f90f103.png",alt:"img"}})]),s._v(" "),a("p",[s._v("只不过在部署的过程可以选择手动部署,自动部署")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639537953548-b498209a-65f7-4e2d-ae71-67ab4e4d2e91.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"手动部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动部署"}},[s._v("#")]),s._v(" 手动部署")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("手动发布有如下几种方式")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("开发通过QQ、weixin发送代码压缩包,rz上传,解压部署")]),s._v(" "),a("li",[s._v("scp方式上线代码,xftp方式上线代码")]),s._v(" "),a("li",[s._v("登录代码托管平台,手动执行git clone")])])]),s._v(" "),a("li",[a("p",[s._v("手动上线的缺点")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("全程运维参与,占用大量时间")]),s._v(" "),a("li",[s._v("如果节点多,上线速度慢")]),s._v(" "),a("li",[s._v("人为失误多,目录管理混乱")]),s._v(" "),a("li",[s._v("回滚不及时或者难以回滚")])])])]),s._v(" "),a("h3",{attrs:{id:"ci与cd基本概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ci与cd基本概念"}},[s._v("#")]),s._v(" CI与CD基本概念")]),s._v(" "),a("h4",{attrs:{id:"什么是持续集成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是持续集成"}},[s._v("#")]),s._v(" 什么是持续集成")]),s._v(" "),a("h5",{attrs:{id:"什么是集成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是集成"}},[s._v("#")]),s._v(" 什么是集成")]),s._v(" "),a("p",[s._v("在实际的软件开发中,常常会有如下两种场景:")]),s._v(" "),a("p",[s._v("1、现在有一个电商平台需要开发,由于平台需要开发的模块较多,此时就需要不同的开发人员开发不同的模块,最后将所有人开发好的代码集成到一个系统中,集成完毕后需要对其进行部署上线")]),s._v(" "),a("p",[s._v("2、随着时间的推移,该系统无论是bug修复、还是新功能开发,后续都需要对系统进行不断的更新迭代")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639543634667-1bd28530-ca1f-40ec-abd7-7a7fd808f099.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"持续集成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#持续集成"}},[s._v("#")]),s._v(" 持续集成")]),s._v(" "),a("p",[s._v("持续集成指的是,频繁地(一天多次)将代码集成到主干(重复如上集成的工作)")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639544181493-e6c213d1-bb0f-4313-8512-436c0337e19e.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"持续集成的好处"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#持续集成的好处"}},[s._v("#")]),s._v(" 持续集成的好处")]),s._v(" "),a("p",[s._v("1、快速发现错误,(每完成一点更新就集成到主干,可以快速发现错误,定位错误也比较容易)")]),s._v(" "),a("p",[s._v("2、节省人力成本")]),s._v(" "),a("p",[s._v("3、加快软件开发进度")]),s._v(" "),a("p",[s._v("使用持续集成能简化我们的工作,同时还能让我们的产品快速迭代,并且保持高质量的产出")]),s._v(" "),a("h4",{attrs:{id:"什么是交付"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是交付"}},[s._v("#")]),s._v(" 什么是交付")]),s._v(" "),a("p",[s._v("持续交付:代码开发->单元测试->合并代码->测试->部署到预生产环境->交付给测试团队(不间断执行)")]),s._v(" "),a("h3",{attrs:{id:"git版本控制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git版本控制"}},[s._v("#")]),s._v(" git版本控制")]),s._v(" "),a("h4",{attrs:{id:"安装git"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装git"}},[s._v("#")]),s._v(" 安装git")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y  install git")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"初始化仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化仓库"}},[s._v("#")]),s._v(" 初始化仓库")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git init")]),s._v("\nInitialized empty Git repository "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("xiaomao"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"管理目录下的文件状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管理目录下的文件状态"}},[s._v("#")]),s._v(" 管理目录下的文件状态")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git status")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# On branch master")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Initial commit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Untracked files:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#   (use "git add <file>..." to include in what will be committed)')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#       index.html")]),s._v("\nnothing added to commit but untracked files present "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("use "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git add"')]),s._v(" to track"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"管理文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管理文件"}},[s._v("#")]),s._v(" 管理文件")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add index.html")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git config --global user.email "you@example.com"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git config --global user.name "Your Name"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "短视频开发完成百分之20% -- v1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("commit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 3434c5e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 短视频开发完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" v1\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("file")]),s._v(" changed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" insertion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n create mode "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100644")]),s._v(" index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看代码提交情况")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git log")]),s._v("\ncommit 3434c5e10d0bfeba4c4e414a73ab6e72ade5a34f\nAuthor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Your Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("you@example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nDate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("   Wed Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("53")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0800")]),s._v("\n\n    短视频开发完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add  .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "约功能上线了   --v3"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master c521947"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 约功能上线了   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v3\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("file")]),s._v(" changed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 代码回退")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git reset --hard 3434c5e10d0b")]),s._v("\nHEAD "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" now at 3434c5e 短视频开发完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 回退到第二次提交")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看历史提交Log")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git reflog")]),s._v("\n3434c5e HEAD@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" reset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" moving to 3434c5e10d0b\nc521947 HEAD@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" commit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 约功能上线了 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v3\n3434c5e HEAD@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("initial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 短视频开发完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git reset --hard c521947")]),s._v("\nHEAD "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" now at c521947 约功能上线了   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v3\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看代码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat index.html")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v(" 编写短视频功能完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v(" 编写短视频功能完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v(" 约功能上线了\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h4",{attrs:{id:"分支命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分支命令"}},[s._v("#")]),s._v(" 分支命令")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看分支")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git branch")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" master\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建分支")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git branch dev")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换分支")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git checkout dev")]),s._v("\nSwitched to branch "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dev'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 合并分支")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git branch bug")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git checkout bug")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat index.html")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v(" 编写短视频功能完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v(" 编写短视频功能完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v(" 约功能上线了\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v(" 约功能上线了"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bug分支\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" 开始操作合并分支 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git checkout master")]),s._v("\nSwitched to branch "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'master'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git merge bug")]),s._v("\nUpdating c521947"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cfc4355\nFast"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("forward\n index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" files changed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n create mode "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100644")]),s._v(" show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat index.html")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v(" 编写短视频功能完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v(" 编写短视频功能完成百分之"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v(" 约功能上线了\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v(" 约功能上线了"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bug分支\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git branch")]),s._v("\n  bug\n  dev\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" master\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("h3",{attrs:{id:"gitlab基本介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab基本介绍"}},[s._v("#")]),s._v(" gitlab基本介绍")]),s._v(" "),a("h4",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[s._v("#")]),s._v(" 介绍")]),s._v(" "),a("p",[s._v("GitLab 是一个用于仓库管理系统的开源项目，使用"),a("a",{attrs:{href:"https://baike.baidu.com/item/Git",target:"_blank",rel:"noopener noreferrer"}},[s._v("Git"),a("OutboundLink")],1),s._v("作为代码管理工具，并在此基础上搭建起来的Web服务")]),s._v(" "),a("h4",{attrs:{id:"功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能"}},[s._v("#")]),s._v(" 功能")]),s._v(" "),a("p",[s._v("1、管理项目源代码")]),s._v(" "),a("p",[s._v("2、对源代码进行版本控制")]),s._v(" "),a("h4",{attrs:{id:"优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优势"}},[s._v("#")]),s._v(" 优势")]),s._v(" "),a("p",[s._v("1、开源免费,搭建简单,维护成本较低、适合中小型公司")]),s._v(" "),a("p",[s._v("2、权限管理,能实现代码对部分人可见,确保项目的安全性")]),s._v(" "),a("p",[s._v("3、离线同步,保证我们不在实时依赖网络环境进行代码提交")]),s._v(" "),a("h4",{attrs:{id:"gitlab与github的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab与github的区别"}},[s._v("#")]),s._v(" gitlab与github的区别")]),s._v(" "),a("p",[s._v("1、相同点:两者都是提供代码托管服务,在很大程度上Gitlab是仿照github来做的")]),s._v(" "),a("p",[s._v("2、不同点:github创建私有仓库收费,gitlab创建私有仓库免费")]),s._v(" "),a("h4",{attrs:{id:"gitlab服务组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab服务组成"}},[s._v("#")]),s._v(" gitlab服务组成")]),s._v(" "),a("p",[s._v("gitlab作为一个分布式代码托管软件,它必然有相关的服务组件去支持这个庞大系统")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639579762815-9a9dd4bd-71ab-4363-9704-dda190aa8e57.png",alt:"img"}})]),s._v(" "),a("p",[a("strong",[s._v("1、nginx:作为gitlab的proxy代理,处理http/https以及静态资源访问请求")])]),s._v(" "),a("p",[a("strong",[s._v("2、gitlab-workhorse:用于处理文件上传和下载")])]),s._v(" "),a("p",[a("strong",[s._v("3、gitlab-shell:用于处理日志的切割和打包等操作")])]),s._v(" "),a("p",[a("strong",[s._v("4、postgresql:用于保存所有的gitlab数据相关信息")])]),s._v(" "),a("p",[a("strong",[s._v("5、redis:用于缓存数据库的信息,加快前台访问速度,以及交互读写")])]),s._v(" "),a("p",[a("strong",[s._v("6")]),s._v("**、"),a("strong",[a("strong",[s._v("sidekiq")])]),s._v("：用于在后台执行队列任务（异步执行）。**")]),s._v(" "),a("p",[a("strong",[s._v("7")]),s._v("**、**"),a("strong",[s._v("unicorn：An HTTP server for Rack applications，GitLab Rails应用是托管在这个服务器上面的")])]),s._v(" "),a("h3",{attrs:{id:"gitlab安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab安装"}},[s._v("#")]),s._v(" gitlab安装")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install gitlab-ce-12.3.9-ce.0.el7.x86_64.rpm")]),s._v("\n\n       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\n\n\n     _______ __  __          __\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" ____"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("   ____ _"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_\n   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" __"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" __"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" __ `"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" __ \\\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n  \\____"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\\__"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_____"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\\__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("h4",{attrs:{id:"gitlab配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab配置"}},[s._v("#")]),s._v(" gitlab配置")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/gitlab/gitlab.rb")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置邮箱 ")]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gitlab_email_enabled'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gitlab_email_from'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1249796886@qq.com'")]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gitlab_email_display_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GitLAB-Admin'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置smtp")]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_address'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"smtp.qq.com"')]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_port'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("465")]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_user_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1249796886@qq.com"')]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_password'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kxegpodbopkkgafc"')]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_domain'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qq.com"')]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_authentication'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"login"')]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_enable_starttls_auto'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp_tls'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置域名")]),s._v("\nexternal_url "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://www.xiaomao.com'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭不需要使用gitlab组件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1460")]),s._v(" prometheus"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1461")]),s._v(" prometheus"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'monitor_kubernetes'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1528")]),s._v(" alertmanager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1550")]),s._v(" node_exporter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1569")]),s._v(" redis_exporter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1587")]),s._v(" postgres_exporter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1616")]),s._v(" gitlab_exporter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1636")]),s._v(" grafana"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1629")]),s._v(" prometheus_monitoring"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'enable'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" false\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h4",{attrs:{id:"初始化gitlab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化gitlab"}},[s._v("#")]),s._v(" 初始化gitlab")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 gitlab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /var/opt/gitlab")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl  reconfigure")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" restart service service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("gitaly"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nRecipe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gitaly"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("enable\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" runit_service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("gitaly"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" action hup\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" send hup to runit_service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("gitaly"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nRecipe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Dynamically Defined Resource"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("gitlab"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("workhorse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" action restart\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" restart service service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("gitlab"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("workhorse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nRunning handlers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nRunning handlers complete\nChef Client finished"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("354")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("899")]),s._v(" resources updated "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),s._v(" minutes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" seconds\ngitlab Reconfigured!\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h4",{attrs:{id:"查看gitlab是否启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看gitlab是否启动"}},[s._v("#")]),s._v(" 查看gitlab是否启动")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl  status")]),s._v("\nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gitaly"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14329")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 154s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13976")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 223s\nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gitlab"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("workhorse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14354")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 154s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14212")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 174s\nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" logrotate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14236")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 168s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14251")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 167s\nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14206")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 174s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14228")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 173s\nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgresql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13984")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 220s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13996")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 216s\nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13826")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 232s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13838")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 229s\nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sidekiq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14173")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 181s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14191")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 178s\nrun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" unicorn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14142")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 187s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14169")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 184s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h4",{attrs:{id:"测试访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试访问"}},[s._v("#")]),s._v(" 测试访问")]),s._v(" "),a("p",[s._v("第一步就是修改密码")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639624676640-7ece2735-8a19-4399-948f-8091e2e6031f.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"首页"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首页"}},[s._v("#")]),s._v(" 首页")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639624802239-df2ac52b-e6b4-425e-b57b-b20abbbaf356.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"开始汉化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始汉化"}},[s._v("#")]),s._v(" 开始汉化")]),s._v(" "),a("p",[s._v("点击setting--\x3ePreferences---\x3eLogcalization---\x3e选择简体中文")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639625071276-cc3a6cf9-c81b-41b5-bffa-ffb0782a2bba.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"查看汉化效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看汉化效果"}},[s._v("#")]),s._v(" 查看汉化效果")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639625148659-48f9cef1-6148-4923-856e-85df96895001.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"汉化gitlab组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#汉化gitlab组件"}},[s._v("#")]),s._v(" 汉化gitlab组件")]),s._v(" "),a("h5",{attrs:{id:"停止gitlab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#停止gitlab"}},[s._v("#")]),s._v(" 停止gitlab")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl stop")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# unzip gitlab-v12.3.0-zh.zip")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# \\cp -r gitlab-v12.3.0-zh/*  /opt/gitlab/embedded/service/gitlab-rails/")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h5",{attrs:{id:"重新启动gitlab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重新启动gitlab"}},[s._v("#")]),s._v(" 重新启动gitlab")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl reconfigure")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl restart")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639626645551-002187b7-549b-4735-9025-2b8aded7f013.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"gitlab用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab用户"}},[s._v("#")]),s._v(" gitlab用户")]),s._v(" "),a("p",[s._v("gitlab中的用户、用户组、项目仓库之间的关系是什么样的?")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639627066947-6546c473-9670-426c-93e0-345039ebb672.png",alt:"img"}})]),s._v(" "),a("p",[s._v("注意:")]),s._v(" "),a("p",[s._v("​      1、如果使用user创建一个仓库,那么这个用户就是这个仓库的owner")]),s._v(" "),a("p",[s._v("​      2、如果使用group创建一个仓库,那么这个组下面添加的所有用户就是这个仓库的owner")]),s._v(" "),a("h5",{attrs:{id:"案例1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#案例1"}},[s._v("#")]),s._v(" 案例1")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("验证项目是不是隶属于该组的成员才可以看见"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、首先创建dev、ops两个组\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、然后基于组创建两个项目\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、最后创建用户、为用户分配组、以及组中的身份\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建组")]),s._v("\n管理中心"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("仪表板"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("群组"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("新建群组\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639635925634-308c5786-ee12-47c5-8be8-8566cbcf6283.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建项目")]),s._v("\n管理中心"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("仪表板"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("Projects"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("新建项目\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639636117648-38de6276-6d8a-4303-b1df-a2c034f8fe83.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建项目")]),s._v("\n管理中心"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("仪表板"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("用户"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("新建用户\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用户加入组")]),s._v("\n管理中心"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("仪表板"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("群组"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("选择对应的群组\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639636637434-20e436ff-eebd-4610-94a9-c7652ddd46fd.png",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"gitlab日常操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab日常操作"}},[s._v("#")]),s._v(" gitlab日常操作")]),s._v(" "),a("h4",{attrs:{id:"关联远程仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关联远程仓库"}},[s._v("#")]),s._v(" 关联远程仓库")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir shopping")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd shopping/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git init")]),s._v("\nInitialized empty Git repository "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("shopping"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat README.md")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("商城\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v("美妆\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v("视频\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "v1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("root"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("commit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 3c34d73"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" v1\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("file")]),s._v(" changed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n create mode "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100644")]),s._v(" README"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传代码到远程仓库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git remote add origin http://www.xiaomao.com/dev/shopping.git")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -u origin master")]),s._v("\nUsername "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://www.xiaomao.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\nPassword "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://root@www.xiaomao.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nCounting objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" done"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nWriting objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("233")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" done"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nTotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTo http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("//")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dev"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("new branch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("      master "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" master\nBranch master "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("set")]),s._v(" up to track remote branch master "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" origin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h4",{attrs:{id:"新成员加入项目组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新成员加入项目组"}},[s._v("#")]),s._v(" 新成员加入项目组")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("如果有新成员需要加入该项目该怎么办?\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、先给新成员创建用户\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、将成员加入组"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("此时该用户就能看到对应的项目\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、使用http方式"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("输入用户名与密码"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("测试能否获取项目代码\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、新建xiaomao用户加入shopping项目\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试拉取代码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git clone http://www.xiaomao.com/dev/shopping.git")]),s._v("\nCloning into "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'shopping'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nUsername "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://www.xiaomao.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" xiaomao\nPassword "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://xiaomao@www.xiaomao.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\nremote"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Enumerating objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" done"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nremote"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Counting objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" done"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nremote"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Total "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nUnpacking objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" done"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd shopping/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nREADME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git branch dev")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git checkout dev")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "登录"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dev "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5756709")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 登录\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("file")]),s._v(" changed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 shopping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push origin dev")]),s._v("\nUsername "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://www.xiaomao.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" xiaomao\nPassword "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://xiaomao@www.xiaomao.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h4",{attrs:{id:"合并代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#合并代码"}},[s._v("#")]),s._v(" 合并代码")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639639390957-324adc62-60eb-4e44-9c14-0a7eadc5d492.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"gitlab备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab备份"}},[s._v("#")]),s._v(" gitlab备份")]),s._v(" "),a("p",[s._v("1、修改默认存放备份站点目录,然后进行重新加载配置文件")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/gitlab/gitlab.rb")]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backup_path'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data/backups"')]),s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份目录")]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backup_archive_permissions'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0644")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#权限")]),s._v("\ngitlab_rails"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backup_keep_time'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("604800")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#备份多少天后自动删除")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重载环境变量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl reconfigure")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建备份目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir -p /data/backups")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#执行备份动作")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-rake gitlab:backup:create")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定时任务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# crontab -l")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("02")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bin")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gitlab"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rake gitlab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("backup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("create\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h4",{attrs:{id:"gitlab恢复数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab恢复数据"}},[s._v("#")]),s._v(" gitlab恢复数据")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止数据写入服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl  stop  unicorn")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl  stop  sidekiq")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开始执行恢复")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /data/backups/")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("144")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" git git "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("143360")]),s._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("36")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1639661819_2021_12_16_12.3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0_gitlab_backup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启gitlab查看是否成功恢复")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl restart")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h5",{attrs:{id:"恢复成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恢复成功"}},[s._v("#")]),s._v(" 恢复成功")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639662690278-22733695-ec97-4cc4-836e-3eef8b2272a9.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"gitlab迁移和升级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab迁移和升级"}},[s._v("#")]),s._v(" gitlab迁移和升级")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639663070999-c8918df9-0537-4266-9078-2f97570b5fa6.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 升级gitlab-ce到12.9.9版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install gitlab-ce-12.9.9-ce.0.el7.x86_64.rpm")]),s._v("\nok"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" run"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" unicorn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("66502")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 1s\n\n     _______ __  __          __\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" ____"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("   ____ _"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_\n   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" __"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" __"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" __ `"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" __ \\\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n  \\____"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\\__"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_____"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\\__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("___"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n\n\nUpdated"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  gitlab"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.9")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".9")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el7\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重载gitlab")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gitlab-ctl reconfigure")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h5",{attrs:{id:"升级成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#升级成功"}},[s._v("#")]),s._v(" 升级成功")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639664957386-33a3a185-fc53-4ff0-9414-bb01aebc4e68.png",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"jenkins的学习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins的学习"}},[s._v("#")]),s._v(" Jenkins的学习")]),s._v(" "),a("h4",{attrs:{id:"什么是jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是jenkins"}},[s._v("#")]),s._v(" 什么是Jenkins")]),s._v(" "),a("p",[s._v("Jenkins是一个开源提供友好操作界面的持续集成的工具,是由JAVA开发而成,Jenkins是一个调度平台，本身不处理任何事情,调用插件来完成所有的工作")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639830851993-6ac89bac-aed3-46cb-af5e-6fc00aa676b9.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"部署安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署安装"}},[s._v("#")]),s._v(" 部署安装")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装jdk环境")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# java -version")]),s._v("\njava version "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.8.0_221"')]),s._v("\nJava"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" SE Runtime Environment "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("build "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0_221")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("b11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nJava HotSpot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Bit Server VM "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("build "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.221")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("b11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mixed mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开始安装jenkins")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install jenkins-2.303-1.1.noarch.rpm")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"配置jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置jenkins"}},[s._v("#")]),s._v(" 配置jenkins")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/sysconfig/jenkins")]),s._v("\nJENKINS_USER"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#用户")]),s._v("\nJENKINS_PORT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9080"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"启动jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动jenkins"}},[s._v("#")]),s._v(" 启动jenkins")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart jenkins")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable jenkins")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"访问jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#访问jenkins"}},[s._v("#")]),s._v(" 访问jenkins")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639833137524-be80176f-7508-4dce-ae9e-892ca6499aa5.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"查看admin的密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看admin的密码"}},[s._v("#")]),s._v(" 查看admin的密码")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /var/lib/jenkins/secrets/initialAdminPassword")]),s._v("\nd1abbd7e33004a549790bc52296e36ca\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h5",{attrs:{id:"首页-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首页-2"}},[s._v("#")]),s._v(" 首页")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639833362130-ccea328b-3d73-42b1-885e-16ccd0442b3b.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"优化jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优化jenkins"}},[s._v("#")]),s._v(" 优化jenkins")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -i 's#http://www.google.com/#https://www.baidu.com/#g' /var/lib/jenkins/updates/default.json")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -i 's#updates.jenkins.io/download#mirror.tuna.tsinghua.edu.com/jenkins#g' /var/lib/jenkins/updates/default.json")]),s._v("\n修改jenkins"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("插件升级站点"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("url地址，选择系统管理"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("插件管理"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("高级"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("升级站点\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639834425208-168aaabc-b674-42ec-a889-821b24d258b0.png",alt:"img"}})]),s._v(" "),a("p",[a("strong",[s._v("改成清华大学源")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639834550679-cce7b9e9-a419-43b3-a038-c3236f102f5d.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"安装中文插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装中文插件"}},[s._v("#")]),s._v(" 安装中文插件")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639835052456-83e9cb66-ac55-41fa-9750-927ef85410f9.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"创建一个项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建一个项目"}},[s._v("#")]),s._v(" 创建一个项目")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639835436455-dbc97536-361f-44b4-ae9d-fb122895ea16.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639835469529-3fa5fd47-5076-40b7-93d9-e5063fb2ddbd.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639835819510-d98605ba-c90c-4c19-b5f6-17a5c08b4be2.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"集成gitlab获取代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成gitlab获取代码"}},[s._v("#")]),s._v(" 集成gitlab获取代码")]),s._v(" "),a("h5",{attrs:{id:"创建项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建项目"}},[s._v("#")]),s._v(" 创建项目")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639837390896-8b9613ee-0a01-4e02-ae45-5cca446ec96a.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传源码包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xf monitor_html.tar.gz")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd monitor")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git init")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git remote add origin git@www.xiaomao.com:ops/monitor.git")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "Initial commit"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -u origin master")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639838139868-f02d40df-aa68-4cf0-be06-3f0e7d47b296.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我这是gitlab和jenkins都部署在同一台机器上了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 私钥传到jenkins上")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat ~/.ssh/id_rsa")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("BEGIN RSA PRIVATE KEY"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\nMIIEpAIBAAKCAQEAsvEtbGEFFyD7EMqhgHquBbbicN29Y94k650eOzT47WmeY1c7\ncyx6DOMX"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("4R"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("qR8prxQ1hJ7Bzdf6Brj6uWUyGFISdAYbhNIN1UGCTnsmpuGUdJCN\nvj5HjtceZFZ2YSlFiyCQWagMOHga54eDgE71YQdezyhVrrqCfNg3O8dT12XdHWbQ\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("14wxxgoY2390g1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("ZZAmvHiA5b7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Lh05uWDtUGnQVc5Rw9i9QjXxWzVzL4Cz"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("jjL\nAfg0UKUDfkHqJ6AQhqMStzSSEFDwlO3teNGwiZt07fFK90RuJcCRUzy33CDvyazE\nuFqM9viUXY99Ea6xp5sLjGNQWOp5ffvRNPoCRwIDAQABAoIBABip51Hd2X7Dm"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dH\nhpUX066T84gM"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("BKwxrP29vjAJ2NJwHv"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("xQHt6nCmSGN"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("lr3vvqYUCgBahWniz"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Jn\nUp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("FFC"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("H"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("GUnhll7Pk7bdaNtk"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lCdFzQo8jJ"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("sD0Y4r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("49gmgSBY"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("6xr3itWWpb4\n9aYUu"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("uAsY"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("qBo1LxbqBbrN9mM"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("CTkxvpv8"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("E86uYsGoVaFcWoriZla3aF18AH9y\nsCBqEGM8ZBOQuFr9IHk6E91zAPPTywa7G14Fy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("J7FMnZ"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("vem6HK82BKwGAVQs9ib\nA4pVHpn3xnUQDbye6pAXsqvUrFT7dxSkAKt2evXykyVi7g5suTIV"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kyVQ3ZZYWQz\no217SQECgYEA6UqqFfLSorhThbmosV9aU5GKz"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("i6Qq5FACWEfFaXNr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("iHMKMQq3u\nRUvp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("OUSD6hRVRSF"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("TvARHn7jMF9Hc3X"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kEFDOv8JInhft"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Pa3zvMBU4At3eCA9"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n4CCYr6Y"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("LNyzhey37azmcpjrbED0qiGDK9Mq1mD4dUQ3MZV7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("zZ7m8cCgYEAxFww\nsBGOKSwYV0awi5IvyIlYXt9etG2YtsXSMrZ43PxfQCyARMVUgXl4Ld5SXbHYQYzK\nWhzoVET9p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("j8jJhN5HvTDZnKMQGq9GgA5RS4gMOPrE6i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("1rQ1D9qoVPpByOYfUX7\n6pYl18FI5VexUFW"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("q2Lt29LsHZtoRVdPWxPtZYECgYEAlQigzbK5Q0B0AwrPLLjY\nkGh7AEURsIV6CRTupSwAH"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bHMU5LolFQ1S4hA2L7fcsuYibhThw8wMIYpBv7nO2i\nXYgV"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("OJIyuLWjmGtUqKWfuYfSR2JuSaFDBNm11dhgvFfMmA"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("TfpzfvtdFtO756\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("KVHSXrbXra8d82iTaLJpoMCgYEAh4"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("R"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("SwVhi0wHMjrx1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("EZ2ESxmTVoCDtxnkq\nFeLN7Fq7c7WFVHUbU0vGAXy0RoUqdI67gJzmdI8ww4RhHrtjQzONUJ107oJlQNiw\njXbRrevVO7MKaBeZhn7Fod0pSslzVEFFmv3P4HVLWzJAcuLQMYVaC2JBqmsJAJ43\nZfyK74ECgYBuh2Op9Nr804htdMRDQP9pKxWOF429KLrJgtLphNp4url48YVAaxl0\niyRS"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("3kDOr3sau9wOB0"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mO7yGoZB5Qiw"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("Sl1Ds"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("F3n4YJIBClAVRxVklzBl5NAsS\nZo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ApoNE"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("RmtOF11aUtP7lkwaKeztyC"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("U2CiRM9fWZgePNbUp8URYw"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("END RSA PRIVATE KEY"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639838711281-b72c3779-a11d-49f6-8d6a-861cdfaa56b4.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639838784365-bcec64b8-710f-4b64-be88-297c0a70e9fa.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"开始构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始构建"}},[s._v("#")]),s._v(" 开始构建")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639838946335-c521b386-bd87-45d5-8ca7-1dd56477e496.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"集成shell部署代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成shell部署代码"}},[s._v("#")]),s._v(" 集成shell部署代码")]),s._v(" "),a("p",[s._v("构建---\x3e增加构建步骤---\x3e选择执行shell命令")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id  -i ~/.ssh/id_rsa.pub  root@10.2.32.9")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id  -i ~/.ssh/id_rsa.pub  root@10.2.32.8")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("变量----\x3e下面的ip是压缩包要传到的主机提前做了变量的设置")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/imagessw2.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639841650230-40daabd1-c05b-4c87-891d-1866cdcd553f.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建"}},[s._v("#")]),s._v(" 构建")]),s._v(" "),a("p",[s._v("选择对应的主机，然后点击构建")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639841703421-c0ca65ba-cd59-4249-be9f-8a57195692b6.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"集成ansible"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成ansible"}},[s._v("#")]),s._v(" 集成ansible")]),s._v(" "),a("h5",{attrs:{id:"安装ansible"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装ansible"}},[s._v("#")]),s._v(" 安装ansible")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install ansible")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"配置清单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置清单"}},[s._v("#")]),s._v(" 配置清单")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/ansible/hosts")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("lbservers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".8")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("webservers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".9")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h5",{attrs:{id:"编写测试的playbook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写测试的playbook"}},[s._v("#")]),s._v(" 编写测试的playbook")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat test.yml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" hosts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webservers"')]),s._v("\n  tasks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Test Shell Command\n      shell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        cmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" df "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h\n      register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" system_cmd\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Debug System Command\n      debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ system_cmd }}"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ansible-playbook test.yml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h5",{attrs:{id:"创建项目调用ansible"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建项目调用ansible"}},[s._v("#")]),s._v(" 创建项目调用ansible")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建项目")]),s._v("\nDashboard"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("新建任务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("输入一个任务名称"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("构建一个自由风格的软件项目"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("确定\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集成ansible ")]),s._v("\n确定后跳转到第二个页面"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("构建"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("增加构建步骤"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("选择invoke ansible playbook\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("添加构建步骤,填写playbook路径,填写inventory清单文件路径")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639969279864-6d884f94-6c78-4068-8840-611436b1c7d3.png",alt:"img"}})]),s._v(" "),a("p",[s._v("然后选择高级,定义ansible外置传参方式,传入主机组名称")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639968605199-b84834fe-2bc2-41ba-b976-9a1b1824777e.png",alt:"img"}})]),s._v(" "),a("p",[s._v("定义外置传参的变量名称,以及变量值")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639968647354-87a48ef5-58de-41d5-bdf1-66b53c45edcb.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"构建成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建成功"}},[s._v("#")]),s._v(" 构建成功")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639968703529-1975b9d9-7190-4c6c-85d9-a19077da8c70.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"基于shell构建ci实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于shell构建ci实践"}},[s._v("#")]),s._v(" 基于shell构建ci实践")]),s._v(" "),a("h5",{attrs:{id:"架构图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#架构图"}},[s._v("#")]),s._v(" 架构图")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639970164529-d9e874e6-6bc8-4c28-a6c5-a8affcc48308.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"搭建测试环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#搭建测试环境"}},[s._v("#")]),s._v(" 搭建测试环境")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装haproxy")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install haproxy")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install socat")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置haproxy ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/haproxy/haproxy.cfg")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("global")]),s._v("\n    log         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v(" local2\n\n    chroot      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("haproxy\n    pidfile     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("run"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("haproxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pid\n    maxconn     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4000")]),s._v("\n    user        haproxy\n    group       haproxy\n    daemon\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# turn on stats unix socket")]),s._v("\n    stats socket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("var"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("haproxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("stats level admin\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------------------------------------------------------------")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# common defaults that all the 'listen' and 'backend' sections will")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# use if not designated in their block")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------------------------------------------------------------")]),s._v("\ndefaults\n    mode                    http\n    log                     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("global")]),s._v("\n    option                  httplog\n    option                  dontlognull\n    option http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("close\n    option forwardfor       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("except")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n    option                  redispatch\n    retries                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    timeout http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("request    10s\n    timeout queue           1m\n    timeout connect         10s\n    timeout client          1m\n    timeout server          1m\n    timeout http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("keep"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("alive 10s\n    timeout check           10s\n    maxconn                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------------------------------------------------------------")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# main frontend which proxys to the backends")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------------------------------------------------------------")]),s._v("\nlisten haproxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("stats\n        bind  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v("\n        stats  enable\n        stats  hide"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("version\n        stats uri "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("haproxy?stats\n        stats realm  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HAProxy statistics"')]),s._v("\n        stats auth admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n        stats admin "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" TRUE\nfrontend www\n    bind "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    mode http\n    acl html_web  hdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("i www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com\n    use_backend web_cluster "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" html_web\nbackend web_cluster\n    balance roundrobin\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),s._v("   weight "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" check\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".11")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),s._v("  weight "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" check\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启haproxy")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao6 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart haproxy")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1639974319733-b1c3c324-5f9a-433f-85f0-c18baa99adab.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx配置")]),s._v("\nweb1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat linux39.conf")]),s._v("\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        server_name   www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        charset  utf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n        location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            root   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            index  index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html  index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /code/web/index.html")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("html lang"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"en"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("meta charset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UTF-8"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("title"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("小茂 官网"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("title"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("head"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("hello world"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("h2"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("body"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#web2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat test.conf")]),s._v("\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        listen  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        server_name   www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mobile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        charset  utf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n        location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            root   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            index  index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html  index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat  /code/web/index.html")]),s._v("\nmobile www\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("h5",{attrs:{id:"手动部署代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动部署代码"}},[s._v("#")]),s._v(" 手动部署代码")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("、执行git clone下载代码\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git clone git@www.xiaomao.com:ops/monitor.git")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("、将下载好的代码进行打包\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 monitor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar cfz /opt/web_monitor_$(date +%F).tar.gz  ./*")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("、将代码推送到远程的目录下\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp /opt/web_monitor_2021-12-20.tar.gz   root@10.2.32.9:/opt/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp /opt/web_monitor_2021-12-20.tar.gz   root@10.2.32.11:/opt/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("、操作负载均衡"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("下线节点然后在更新代码\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh root@10.2.32.8 \"echo 'disable server web_cluster/10.2.32.9' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh root@10.2.32.8 \"echo 'disable server web_cluster/10.2.32.11' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("、在远程创建一个目录\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ssh root@10.2.32.9 "mkdir -p /opt/web_$(date +%F)"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ssh root@10.2.32.11 "mkdir -p /opt/web_$(date +%F)"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("、在远程解压压缩包解压"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("解压到"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web_$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("F"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ssh root@10.2.32.9 "tar xf /opt/web_monitor_2021-12-20.tar.gz  -C  /opt/web_$(date +%F)"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ssh root@10.2.32.11 "tar xf /opt/web_monitor_2021-12-20.tar.gz  -C  /opt/web_$(date +%F)"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("、删除软链接"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("然后重新做软链接 \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ssh root@10.2.32.9  "rm -f /opt/web && ln -s /opt/web_$(date +%F)  /opt/web"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ssh root@10.2.32.11  "rm -f /opt/web && ln -s /opt/web_$(date +%F)  /opt/web"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("、上线节点\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh root@10.2.32.8 \"echo 'enable server web_cluster/xiaomao7' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh root@10.2.32.8 \"echo 'enable server web_cluster/xiaomao8' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("、web界面访问\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640005591906-7d64afa0-7643-4cac-aefc-22023f8a854a.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"实现shell自动部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现shell自动部署"}},[s._v("#")]),s._v(" 实现shell自动部署")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建项目")]),s._v("\nDashboard"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("新建任务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("输入一个任务名称"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("构建一个自由风格的软件项目"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("确定\nshell中定义的主机组地址都是写死的"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("这样不够灵活"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("希望通过传参让其变得更加灵活"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("注释掉\n脚本中的lb_servers、web_servers变量"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("然后通过jenkins重新定义这两变量\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640068205415-f4b3d556-ac37-45fc-afa1-cc94e21dc08b.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640068188476-f87b8163-acb8-42ab-9eba-0cc29b362528.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640068224199-c0621d6a-3be1-4b85-9af9-3865576e042a.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 脚本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /scripts/deploy_html.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/bash")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vars")]),s._v("\nweb_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("web\nweb_dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt\nDate"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("F_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("H_"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("M"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlock_file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lock\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lock")]),s._v("\nlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f $lock_file "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" then\n        echo "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"当前脚本正在执行,请不要反复执行;"')]),s._v("\n        exit\n   fi\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nun_lock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        rm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f $lock_file\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 完成打包操作")]),s._v("\ntar_code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 枷锁")]),s._v("\n        touch $lock_file\n\n        cd $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("WORKSPACE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" \\\n        tar czf $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("_$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 推送代码")]),s._v("\npush_code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" host "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("  $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        do\n            scp $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("_$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz root@$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        done\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下线节点")]),s._v("\nlb_server_disable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    ssh root@$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("lb_servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"echo 'disable server web_cluster/$1' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nlb_server_enable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    ssh root@$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("lb_servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"echo 'enable  server web_cluster/$1' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署操作")]),s._v("\ndeploy_code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" host "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\ndo\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下线节点")]),s._v("\n    lb_server_disable $host\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#登录目标主机执行多种操作")]),s._v("\n    ssh root@$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(' "cd $'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" mkdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("_$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" \\\n                      tar xf $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("_$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("C $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("_$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" \\\n                      rm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rf $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("_$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz                         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" \\\n                      ln "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("_$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_dir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("web_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v('"\n\n    '),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上线节点")]),s._v("\n    lb_server_enable $host\n\n    sleep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\ndone\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调用函数")]),s._v("\nmain "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   lock\n   tar_code\n   push_code\n   deploy_code\n   un_lock\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nmain\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br")])]),a("h4",{attrs:{id:"jenkins调用ansible"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins调用ansible"}},[s._v("#")]),s._v(" jenkins调用ansible")]),s._v(" "),a("p",[s._v("创建一个项目,名称为:monitor-Ansible-CI,在执行构建阶段选择Invoke Ansible Playbook")]),s._v(" "),a("p",[s._v("1、Playbook path: /scripts/deploy_html.yml,文件绝对路径")]),s._v(" "),a("p",[s._v("2、Inventory: File or host list (/etc/ansible/hosts),主机清单文件路径")]),s._v(" "),a("h5",{attrs:{id:"整体思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#整体思路"}},[s._v("#")]),s._v(" 整体思路")]),s._v(" "),a("p",[s._v("1、设定时间变量,设定workspace变量,委派给jenkins节点执行")]),s._v(" "),a("p",[s._v("2、代码进行打包,委派给Jenkins节点执行")]),s._v(" "),a("p",[s._v("3、当web节点代码需要更新时,先下线节点,将任务委派给haproxy")]),s._v(" "),a("p",[s._v("4、为web节点创建站点目录,并将代码推送至对应的目录中")]),s._v(" "),a("p",[s._v("5、删除软链接,重新创建软链接")]),s._v(" "),a("p",[s._v("6、当web节点代码更新成功后,需要上线节点,将任务委派给Haproxy")]),s._v(" "),a("p",[s._v("7、然后依次循环,直到完成所有节点的代码更新与替换")]),s._v(" "),a("h5",{attrs:{id:"定义主机清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定义主机清单文件"}},[s._v("#")]),s._v(" 定义主机清单文件")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/ansible/hosts")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("lbservers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".8")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("webservers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".9")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".32")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".11")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("配置jenkins的参数化构建,这些参数会当作环境变量暴露给构建任务")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640091084712-de8684ad-518c-441d-a185-258a9eae534a.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640091100294-d9bf5924-e373-4a53-a384-22ae8a141a03.png",alt:"img"}})]),s._v(" "),a("p",[s._v("在jenkins中配置Ansible的外置传参,value为一个变量,需要通过执行jenkins时进行传递")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640091181147-6a714ede-5c4a-4f87-b697-ae5efa65b8fb.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640091262875-db6ab644-37cb-4664-ae35-42c36fade74d.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"playbook脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#playbook脚本"}},[s._v("#")]),s._v(" playbook脚本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 opt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat !$")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /scripts/deploy_html.yml\n- hosts: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webservers"')]),s._v("\n  vars:\n    - work_dir: /opt\n    - web_name: web\n    - web_backend: web_clsuter\n    - service_port: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),s._v("\n  serial: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  tasks:\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取一个时间,年-月-日-分 {{ date.stdout }}")]),s._v("\n    - name: Get System Time\n      shell:\n        cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo '),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%F_%H_%M"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v("\n      register: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取项目的工作目录{{ workspace.stdout }}")]),s._v("\n    - name: GetWorkSpace Work Path\n      shell:\n        cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${WORKSPACE}")]),s._v('"')]),s._v("\n      register: workspace\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行打包操作")]),s._v("\n    - name: Archive Workspace Code\n      archive:\n        path:  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ workspace.stdout }}/*"')]),s._v("\n        dest:  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ web_name }}_{{ date.stdout }}.tar.gz"')]),s._v("\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下线节点(委派给labservers)")]),s._v("\n    - name: offline Haproxy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname}}"')]),s._v("\n      haproxy:\n        state: disabled\n        host:  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname }}"')]),s._v("\n        backend: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ web_backend }}"')]),s._v("\n        socket: /var/lib/haproxy/stats\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ item }}"')]),s._v("\n      loop: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"{{ groups['lbservers'] }}\"")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭Nginx")]),s._v("\n    - name: Systemd Nginx Stoppend\n      systemd:\n        name: nginx\n        state: stopped\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检测端口是否存活")]),s._v("\n    - name: Check Nginx Port\n      wait_for:\n        port: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ service_port }}"')]),s._v("\n        state: stopped\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为web集群创建站点目录")]),s._v("\n    - name: Create Web Site Directory\n      file:\n       path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir}}/{{ web_name }}_{{ date.stdout }}"')]),s._v("\n       state: directory\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压目录")]),s._v("\n    - name: Unarchive Web Code\n      unarchive:\n        src: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ web_name }}_{{ date.stdout }}.tar.gz"')]),s._v("\n        dest: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ web_name }}_{{ date.stdout }}"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除软链接")]),s._v("\n    - name: Unlink Path\n      file:\n         path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ web_name }}"')]),s._v("\n         state: absent\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新创建链接")]),s._v("\n    - name: Create Links Path\n      file:\n        src: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir}}/{{ web_name }}_{{ date.stdout }}"')]),s._v("\n        dest: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ web_name }}"')]),s._v("\n        state: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#state是link的时候代表软连接")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动Nginx Server")]),s._v("\n    - name: Systemd Nginx Started\n      systemd:\n        name: nginx\n        state: started\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检测端口是否存活")]),s._v("\n    - name: Check Nginx Port\n      wait_for:\n        port: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ service_port }}"')]),s._v("\n        state: started\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上线节点")]),s._v("\n    - name: online Haproxy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname}}"')]),s._v("\n      haproxy:\n        state: enabled\n        host:  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname }}"')]),s._v("\n        backend: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ web_backend }}"')]),s._v("\n        socket: /var/lib/haproxy/stats\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ item }}"')]),s._v("\n      loop: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"{{ groups['lbservers'] }}\"")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br")])]),a("h5",{attrs:{id:"定时构建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定时构建"}},[s._v("#")]),s._v(" 定时构建")]),s._v(" "),a("p",[s._v("定时构建,每间隔多久执行一次;无论代码是否更新,时间到了则会执行,类似于定时任务的功能")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640142697810-b35f2be8-071f-468f-8dbc-3fa8de77a473.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"scm轮询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scm轮询"}},[s._v("#")]),s._v(" SCM轮询")]),s._v(" "),a("p",[s._v("SCM沦陷:可以每分钟检查代码是否更新,当检查到代码发生变更后,会触发构建,否则不执行")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640143935784-5c5d3e22-ef4b-4703-a283-d39a26915c72.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/10358179/1640143914582-5ced7801-e947-4955-bafe-7aaf330af0b5.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_23%2Ctext_eGlhb21hbw%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"wobhook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#wobhook"}},[s._v("#")]),s._v(" wobhook")]),s._v(" "),a("p",[s._v("wobhook就是当开发一提交代码,则立刻将代码部署至目标集群服务节点")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("配置jenkins项目")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("点击jenkins中对应的项目,找到构建触发器")]),s._v(" "),a("li",[s._v("找到高级,然后找到Secret token,点击Generate生成token")]),s._v(" "),a("li",[s._v("这样就可以通过外部程序调用jenkins,进而触发动作构建项目")])])])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640143981663-4c44a16e-4ded-4cfd-ae60-3110930c467b.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/10358179/1640144021253-3d553ddc-b717-42d7-b30d-9cacf7fa1221.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_27%2Ctext_eGlhb21hbw%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10",alt:"img"}})]),s._v(" "),a("p",[s._v("最后应用保存")]),s._v(" "),a("ul",[a("li",[s._v("gitlab配置")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640155510374-79d31b3f-2509-46d7-8448-4600fe72f18b.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640155693116-4f32ce3e-43e1-4079-8d86-1c38e1027081.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/10358179/1640155709190-80ff62b4-2063-4d93-91a4-862a228c80fb.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_15%2Ctext_eGlhb21hbw%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10",alt:"img"}})]),s._v(" "),a("p",[s._v("添加成功")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640156024819-e8434995-4957-41f0-92b9-4d647145bb3f.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("解决gitlab添加webhook提示Url is blocked: Requests to the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" network are not allowed的问题\n解决办法：Admin area "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Settings "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Network "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Outbound requests "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 两个勾都要打上\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"集成java-maven实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成java-maven实践"}},[s._v("#")]),s._v(" 集成java maven实践")]),s._v(" "),a("h4",{attrs:{id:"架构图-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#架构图-2"}},[s._v("#")]),s._v(" 架构图")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640157884663-076d07c7-d42c-48ed-9adf-53b05c922359.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"基础环境搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础环境搭建"}},[s._v("#")]),s._v(" 基础环境搭建")]),s._v(" "),a("h5",{attrs:{id:"haproxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#haproxy"}},[s._v("#")]),s._v(" haproxy")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao6 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/haproxy/haproxy.cfg")]),s._v("\nglobal\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# to have these messages end up in /var/log/haproxy.log you will")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# need to:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1) configure syslog to accept network log events.  This is done")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    by adding the '-r' option to the SYSLOGD_OPTIONS in")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    /etc/sysconfig/syslog")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2) configure local2 events to go to the /var/log/haproxy.log")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   file. A line like the following can be added to")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   /etc/sysconfig/syslog")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#    local2.*                       /var/log/haproxy.log")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    log         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 local2\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chroot")]),s._v("      /var/lib/haproxy\n    pidfile     /var/run/haproxy.pid\n    maxconn     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4000")]),s._v("\n    user        haproxy\n    group       haproxy\n    daemon\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# turn on stats unix socket")]),s._v("\n    stats socket /var/lib/haproxy/stats level admin\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------------------------------------------------------------")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# common defaults that all the 'listen' and 'backend' sections will")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# use if not designated in their block")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------------------------------------------------------------")]),s._v("\ndefaults\n    mode                    http\n    log                     global\n    option                  httplog\n    option                  dontlognull\n    option http-server-close\n    option forwardfor       except "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.0/8\n    option                  redispatch\n    retries                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" http-request    10s\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" queue           1m\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" connect         10s\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" client          1m\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" server          1m\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" http-keep-alive 10s\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" check           10s\n    maxconn                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------------------------------------------------------------")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# main frontend which proxys to the backends")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------------------------------------------------------------")]),s._v("\nlisten haproxy-stats\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v("  *:9999\n        stats  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v("\n        stats  hide-version\n        stats uri /haproxy?stats\n        stats realm  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HAProxy statistics"')]),s._v("\n        stats auth admin:123456\n        stats admin "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" TRUE\nfrontend www\n    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" *:80\n    mode http\n    acl java_oldxu hdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" www.xiaomao.com\n    use_backend  java_cluster "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" java_oldxu\nbackend java_cluster\n    balance roundrobin\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.10 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.10:8010  check port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8010")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.11  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.11:8010  check port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8010")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启haproxy")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao6 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart haproxy")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br")])]),a("h5",{attrs:{id:"部署tomcat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署tomcat"}},[s._v("#")]),s._v(" 部署tomcat")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署java")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# java -version")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" version "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.8.0_221"')]),s._v("\nJava"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" SE Runtime Environment "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("build "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),s._v(".0_221-b11"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nJava HotSpot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("-Bit Server VM "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("build "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.221")]),s._v("-b11, mixed mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署tomcat")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir /soft")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xf apache-tomcat-7.0.92.tar.gz  -C /soft/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -sv  /soft/apache-tomcat-7.0.92/  /soft/tomcat")]),s._v("\n‘/soft/tomcat’ -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ‘/soft/apache-tomcat-7.0.92/’\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  启动tomcat")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /soft/tomcat/bin/startup.sh")]),s._v("\nUsing CATALINA_BASE:   /soft/tomcat\nUsing CATALINA_HOME:   /soft/tomcat\nUsing CATALINA_TMPDIR: /soft/tomcat/temp\nUsing JRE_HOME:        /usr/local/java\nUsing CLASSPATH:       /soft/tomcat/bin/bootstrap.jar:/soft/tomcat/bin/tomcat-juli.jar\nTomcat started.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640159709127-cde039f4-c2de-4ac4-b9a2-86c3fb91806e.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"手动实现war包的ci"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动实现war包的ci"}},[s._v("#")]),s._v(" 手动实现war包的CI")]),s._v(" "),a("h5",{attrs:{id:"上传源码包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#上传源码包"}},[s._v("#")]),s._v(" 上传源码包")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xf hello-world-war.tar.gz  -C /test/")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"创建gitlab仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建gitlab仓库"}},[s._v("#")]),s._v(" 创建gitlab仓库")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640161342445-98ace4dc-19b6-4a4c-8e3f-32a30dfb3e6f.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 推送代码到仓库中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git init")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git remote add origin git@www.xiaomao.com:dev/spring-hello-world-war.git")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "Initial commit"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# On branch master")]),s._v("\nnothing to commit, working directory clean\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -u origin master")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h5",{attrs:{id:"拉取代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拉取代码"}},[s._v("#")]),s._v(" 拉取代码")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir xiaomao")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd xiaomao/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git clone git@www.xiaomao.com:dev/spring-hello-world-war.git")]),s._v("\nCloning into "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'spring-hello-world-war'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nremote: Enumerating objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(", done.\nremote: Counting objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("/19"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\nremote: Compressing objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("/12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\nremote: Total "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", pack-reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nReceiving objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("/19"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\nResolving deltas: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("/2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nspring-hello-world-war\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h5",{attrs:{id:"安装maven"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装maven"}},[s._v("#")]),s._v(" 安装maven")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 xiaomao"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install maven")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"配置maven"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置maven"}},[s._v("#")]),s._v(" 配置maven")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 一定要进入到带有源码的仓库中目录进行修改")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/maven/settings.xml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirrors"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("alimaven"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("aliyun maven"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("http://maven.aliyun.com/nexus/content/groups/public"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/url"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirrorOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("central"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirrorOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirrors"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mvn clean")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h5",{attrs:{id:"编译项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译项目"}},[s._v("#")]),s._v(" 编译项目")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mvn package")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"部署代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署代码"}},[s._v("#")]),s._v(" 部署代码")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拷贝war包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# for i in {10..11};do scp target/*.war root@10.2.32.$i:/opt/ROOT_$(date +%F-%H-%M).war;done")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除ROOT目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# for i  in  {10..11};do ssh root@10.2.32.$i  "rm -rf /soft/tomcat/webapss/ROOT";done')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压war包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# for i in {10..11};do ssh root@10.2.32.$i "mkdir /opt/ROOT_$(date +%F-%H-%M) && unzip /opt/ROOT_$(date +%F-%H-%M).war -d /opt/ROOT_$(date +%F-%H-%M)";done')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建立软链接")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# for i in {10..11};do ssh root@10.2.32.$i " ln -s /opt/ROOT_$(date +%F-%H-%M)  /soft/tomcat/webapps/ROOT ";done')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启tomcat")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# for i in {10..11};do ssh root@10.2.32.$i "pkill  java &&  /soft/tomcat/bin/startup.sh ";done')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h5",{attrs:{id:"访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#访问"}},[s._v("#")]),s._v(" 访问")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640176835506-aff96dc2-4ee2-4e04-ae60-9272f77644ae.png",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"自动实现war包项目的ci"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动实现war包项目的ci"}},[s._v("#")]),s._v(" 自动实现war包项目的CI")]),s._v(" "),a("h4",{attrs:{id:"配置jenkins集成maven"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置jenkins集成maven"}},[s._v("#")]),s._v(" 配置jenkins集成Maven")]),s._v(" "),a("p",[s._v("1、安装Maven integrtion插件,这样才能使用jenkins构建一个Maven项目")]),s._v(" "),a("p",[s._v("2、告诉jenkins,jDK的安装路径:点击系统---\x3e全局工具配置---\x3e新增JDK,然后填写JDK路径")]),s._v(" "),a("p",[s._v("3、告诉jenkins,Maven的安装路径:点击系统--\x3e全局工具配置---\x3e新增Maven,然后填写Maven路径")]),s._v(" "),a("h4",{attrs:{id:"创建一个manven项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建一个manven项目"}},[s._v("#")]),s._v(" 创建一个Manven项目")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640443798875-ce780001-fe57-441f-8ad3-d346175295ca.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"添加jdk参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加jdk参数"}},[s._v("#")]),s._v(" 添加jdk参数")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640443954230-be8ac58c-c598-4a7a-badb-a9c38339d419.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"添加maven参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加maven参数"}},[s._v("#")]),s._v(" 添加maven参数")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640444044099-eadb8037-3b04-454a-abde-961db6f5ec70.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"开始新建项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始新建项目"}},[s._v("#")]),s._v(" 开始新建项目")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640444212949-b5e324da-987f-4d66-a3a9-49846f7fe082.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/10358179/1640445228586-b8a74407-ed3a-4031-b9ba-c25f0b875df6.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_21%2Ctext_eGlhb21hbw%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640445243476-d4eead3e-2abc-4268-9bd6-ee278ae6d043.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640512852437-d5ec66f2-0d0d-4837-baec-11922c9f87d5.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"编写shell脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写shell脚本"}},[s._v("#")]),s._v(" 编写shell脚本")]),s._v(" "),a("p",[s._v("1、通过Haproxy来关闭web节点")]),s._v(" "),a("p",[s._v("2、停止web节点上的Tomcat服务")]),s._v(" "),a("p",[s._v("3、进入工程目录中,将war包拷贝到被控端，并进行重新命名")]),s._v(" "),a("p",[s._v("4、为被控制端创建目录,解压到指定的目录下")]),s._v(" "),a("p",[s._v("5、删除软链接，重新创建软链接")]),s._v(" "),a("p",[s._v("6、启动web节点上的tomcat服务")]),s._v(" "),a("p",[s._v("7、通过Haproxy加入到集群中")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 scripts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat deploy_java.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/bash")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vars")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("web_name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ROOT\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("web_dir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tomcat_bin")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/soft/tomcat/bin\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Date")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%F_%H_%M"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tomcat_site")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/soft/tomcat/webapps/ROOT\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.通过Haproxy来关闭web节点")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("lb_server_disable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${lbservers}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"echo 'disable server java_cluster/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.进入到工程目录中,将web包拷贝到被控端,并进行重新命名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("scp_code")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${WORKSPACE}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("host")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${webservers}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" target/*.war root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_name}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${Date}")]),s._v(".war\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.停止web节点上的tomcat服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4、为被控制端创建目录,解压到指定的目录下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5、删除软链接，重新创建软链接")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 6、启动web节点上的tomcat服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("deploy_code")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("host")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${webservers}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n           lb_server_disable "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_bin}")]),s._v("/shutdown.sh  && \\\n                      cd "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v(" &&  rm -rf "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_site}")]),s._v(" &&  \\\n                      mkdir -p "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_name}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${Date}")]),s._v(" && \\\n                      unzip "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_name}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${Date}")]),s._v(".war -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_name}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${Date}")]),s._v(" && \\\n                      ln -s "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_name}")]),s._v("_"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${Date}")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_site}")]),s._v(" && "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_bin}")]),s._v('/startup.sh "')]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n          lb_server_enable "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("lb_server_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${lbservers}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"echo 'enable  server java_cluster/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   scp_code\n   deploy_code\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n   main\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br")])]),a("h5",{attrs:{id:"部署结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署结果"}},[s._v("#")]),s._v(" 部署结果")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640512884502-64aaea1e-4471-4408-a973-5832e7d9f5c4.png",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"自动实现war包部署-ansible"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动实现war包部署-ansible"}},[s._v("#")]),s._v(" 自动实现war包部署-ansible")]),s._v(" "),a("h4",{attrs:{id:"新建项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新建项目"}},[s._v("#")]),s._v(" 新建项目")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640521509232-7e60e88c-e8bc-46c4-9573-138930510036.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640525043108-72f68451-0d12-41fd-8ff4-bcab8e014776.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640525025554-bd718d77-594d-4e58-ad68-23e36b312f7a.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 scripts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat deploy_xiaomao.yml")]),s._v("\n- hosts: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webservers"')]),s._v("\n  vars:\n    - work_dir: /opt\n    - web_name: ROOT\n    - tomcat_site: /soft/tomcat/webapps\n    - web_backend: java_clsuter\n    - service_port: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n  serial: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#控制每次仅操作一个主机")]),s._v("\n  tasks:\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取一个时间,年-月-日-分 {{ date.stdout }}")]),s._v("\n    - name: Get System Time\n      shell:\n        cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo '),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%F_%H_%M"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v("\n      register: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取项目的war包名称{{ workspace.stdout }}")]),s._v("\n    - name: GetWorkSpace Work Path\n      shell:\n       cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${WORKSPACE}")]),s._v('/target/*.war"')]),s._v("\n      register: workspace\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下线节点(委派给labservers)")]),s._v("\n    - name: offline Haproxy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname}}"')]),s._v("\n      haproxy:\n        state: disabled\n        host:  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname }}"')]),s._v("\n        backend: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ web_backend }}"')]),s._v("\n        socket: /var/lib/haproxy/stats\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ item }}"')]),s._v("\n      loop: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"{{ groups['lbservers'] }}\"")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭Tomcat")]),s._v("\n    - name: Systemd Tomcat  Stoppend\n      shell:\n        cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nohup /soft/tomcat/bin/shutdown.sh &"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检测端口是否存活")]),s._v("\n    - name: Check Tomcat  Port\n      wait_for:\n        port: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ service_port }}"')]),s._v("\n        state: stopped\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为web集群创建站点目录")]),s._v("\n    - name: Create Web Site Directory\n      file:\n       path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir}}/{{ web_name }}_{{ date.stdout }}"')]),s._v("\n       state: directory\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压目录")]),s._v("\n    - name: Unarchive Web Code\n      unarchive:\n        src: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ workspace.stdout }}"')]),s._v("\n        dest: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ web_name }}_{{ date.stdout }}"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除软链接")]),s._v("\n    - name: Unlink Path\n      file:\n         path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ tomcat_site }}/{{ web_name }}"')]),s._v("\n         state: absent\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新创建链接")]),s._v("\n    - name: Create Links Path\n      file:\n        src: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir}}/{{ web_name }}_{{ date.stdout }}"')]),s._v("\n        dest: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ tomcat_site  }}/{{ web_name }}"')]),s._v("\n        state: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#state是link的时候代表软连接")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动tomcat  Server")]),s._v("\n    - name: Systemd Nginx Started\n      shell:\n        cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nohup /soft/tomcat/bin/startup.sh &"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检测端口是否存活")]),s._v("\n    - name: Check tomcat  Port\n      wait_for:\n        port: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ service_port }}"')]),s._v("\n        state: started\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上线节点")]),s._v("\n    - name: online Haproxy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname}}"')]),s._v("\n      haproxy:\n        state: enabled\n        host:  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname }}"')]),s._v("\n        backend: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ web_backend }}"')]),s._v("\n        socket: /var/lib/haproxy/stats\n      delegate_to: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ item }}"')]),s._v("\n      loop: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"{{ groups['lbservers'] }}\"")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br")])]),a("h3",{attrs:{id:"集成nexus制品库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成nexus制品库"}},[s._v("#")]),s._v(" 集成Nexus制品库")]),s._v(" "),a("h4",{attrs:{id:"nexus介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nexus介绍"}},[s._v("#")]),s._v(" Nexus介绍")]),s._v(" "),a("p",[s._v("nexus的全称是Nexus Repository Manager，是Sonatype公司的一个产品。它是一个强大的仓库管理器，极大地简化了内部仓库的维护和外部仓库的访问")]),s._v(" "),a("p",[s._v("我们主要用它来搭建公司内部的maven私服。但是它的功能不仅仅是创建maven私有仓库这么简单，还可以作为nuget、docker、npm、bower、pypi、rubygems、git lfs、yum、go、apt等的私有仓库，功能非常强大")]),s._v(" "),a("h4",{attrs:{id:"优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[s._v("#")]),s._v(" 优点")]),s._v(" "),a("p",[s._v("1.节省外网带宽：大量对中央仓库的重复请求会消耗带宽，利用私服代理外部仓库，可以避免重复的公网下载降低带宽的压力。")]),s._v(" "),a("p",[s._v("2.加速maven的构建：maven通过内网从私服拉取所需构件（私服存在此构件的情况下），获取构件的速度大大加快，从而加快打包构件的速度。")]),s._v(" "),a("p",[s._v("3.部署第三方构件：开发人员自己封装的一些jar包（工具类），可以部署到私服，以便内部开发人员的maven项目使用。")]),s._v(" "),a("p",[s._v("4.提高稳定性：当公网网络不稳定的时候，如果使用远程仓库，maven的构建也会变得不稳定。如果在私服存在所需的构件，即使没有公网，maven的构件也会顺利进行。")]),s._v(" "),a("p",[s._v("5.降低中央仓库的负荷：使用私服，避免了从中央仓库的重复下载，可以减轻中央仓库的负荷。")]),s._v(" "),a("h4",{attrs:{id:"nexus安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nexus安装"}},[s._v("#")]),s._v(" Nexus安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xf nexus-3.19.1-01-unix.tar.gz   -C  /usr/local/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -sv  /usr/local/nexus-3.19.1-01/  /usr/local/nexus")]),s._v("\n‘/usr/local/nexus’ -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ‘/usr/local/nexus-3.19.1-01/’\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"nexus仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nexus仓库"}},[s._v("#")]),s._v(" Nexus仓库")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /usr/local/nexus/bin/nexus.rc")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#run_as_user=""')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run_as_user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nexus进程运行用户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改监听端口和监听地址")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /usr/local/nexus/etc/nexus-default.properties")]),s._v("\napplication-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8083")]),s._v("\napplication-host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.10\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"nexus启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nexus启动"}},[s._v("#")]),s._v(" Nexus启动")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#/usr/local/nexus/bin/nexus  restart")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看端口是否启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ss -ntl")]),s._v("\nState       Recv-Q Send-Q                                                  Local Address:Port                                                                 Peer Address:Port\nLISTEN      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("                                                         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.10:8083                                                                            *:*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"访问-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#访问-2"}},[s._v("#")]),s._v(" 访问")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("http://10.2.32.10:8083/\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao7 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /usr/local/sonatype-work/nexus3/admin.password")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面是密码    账号是admin")]),s._v("\nd6481b4f-d7a9-4d82-a421-5e03b5583f24\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640697017941-4b184b09-b0e1-45a4-a001-b4abc2116a05.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"配置nexus-web界面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置nexus-web界面"}},[s._v("#")]),s._v(" 配置Nexus WEB界面")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640697765513-387b3617-6280-4bbc-8853-2fd502fe5d40.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640697924404-30925e71-c3bc-4598-bbee-78057c46ac70.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"配置maven连接nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置maven连接nexus"}},[s._v("#")]),s._v(" 配置maven连接Nexus")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 装有maven的软件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/maven/settings.xml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("servers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t\t\t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("nexus-snapshots"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("admin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12345")]),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("6")]),s._v("<")]),s._v("/password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("nexus-release"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("admin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12345")]),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("6")]),s._v("<")]),s._v("/password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("maven-central"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("admin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12345")]),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("6")]),s._v("<")]),s._v("/password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#nexus的密码")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/servers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirrors"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("maven-central"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirrorOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirrorOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("http://10.2.32.10/repository/maven-central/"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/url"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("nexus-snapshots"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirrorOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirrorOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("http://10.2.32.10/repository/maven-snapshots"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/url"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("nexus-releases"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mirrorOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirrorOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("http://10.2.32.10/repository/maven-releases"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/url"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/mirrors"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试是否链接成功")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mvn package")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("h4",{attrs:{id:"上传war包到nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#上传war包到nexus"}},[s._v("#")]),s._v(" 上传war包到Nexus")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim pom.xml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传war包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mvn  deploy:deploy-file  \\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DgroupId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("com.efsavage "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DartifactId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("hello-world-war "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dversion")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),s._v(".0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dpackaging")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("war "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dfile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("target/hello-world-war-10.0.0.war  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Durl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://10.2.32.10/repository/maven-releases/  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DrepositoryId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nexus-releases "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DgeneratePom")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("也可以手动上传")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640706866955-beb184e9-e1c7-4401-ab5d-d10fde8fd09e.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640706905329-1f57178f-27c2-44a6-90d3-d8fdba4793d7.png",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"jenkins实现war包的ci与cd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins实现war包的ci与cd"}},[s._v("#")]),s._v(" Jenkins实现war包的CI与CD")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640778087207-7d27de74-5598-4a7e-a14c-b8ecf17154a8.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640778179726-18dad85c-1ee7-4b89-be93-936972b73293.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640778194940-ecb8d3fa-3956-46cb-8cef-020063d78682.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"编写shell脚本-ci"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写shell脚本-ci"}},[s._v("#")]),s._v(" 编写shell脚本（CI）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /scripts/deploy_nexus.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("mvn  help:evaluate "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dexpression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project.groupId "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[INFO]"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("mvn  help:evaluate "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dexpression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project.artifactId "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[INFO]"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("mvn  help:evaluate "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dexpression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project.version "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[INFO]"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("packaging")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("mvn  help:evaluate "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dexpression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project.packaging "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[INFO]"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\nmvn  deploy:deploy-file  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DgroupId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${groupId}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DartifactId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${artifactId}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dversion")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${version}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dpackaging")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${packaging}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dfile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("target/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${artifactId}")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${version}")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${packaging}")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Durl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://10.2.32.10/repository/maven-releases/  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DrepositoryId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nexus-releases  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DgeneratePom")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h4",{attrs:{id:"基于nexus实现自动ci"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于nexus实现自动ci"}},[s._v("#")]),s._v(" 基于Nexus实现自动CI")]),s._v(" "),a("p",[s._v("jenkins部分")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640879709933-be66bc2f-03bc-4855-b111-e42460f82bf7.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/10358179/1640778491481-5cf58667-98d5-4072-aa76-8008dc44f91b.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_27%2Ctext_eGlhb21hbw%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640778509528-a4318b17-8e7a-42ac-b5bd-650a37eb8290.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640879746078-b9a2075b-22a9-489d-9597-17eb762ec487.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640879759080-c93cf8cf-2374-4cd2-9c7e-a6b8ffc0d30a.png",alt:"img"}})]),s._v(" "),a("p",[s._v("gitlab配置")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640779601117-5b01841a-158e-43ed-ad6d-d90575020d74.png",alt:"img"}}),s._v("修改代码后会自动构建")]),s._v(" "),a("h4",{attrs:{id:"基于nexus实现cd任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于nexus实现cd任务"}},[s._v("#")]),s._v(" 基于Nexus实现CD任务")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640781938839-63c543fd-d445-4efc-81b9-16a19ca14b58.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("备注:要装好相关的插件\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640855567171-d5309476-a3be-4be4-9522-6a9b38682a75.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640855584832-103bc956-de6c-41fa-bf5d-7ed60c25c18d.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640783480610-c8e539d7-b94e-43e8-9de2-39dee3110dd1.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640783663340-00592192-f1e5-45ec-b007-d49390b98e33.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640783837156-96cd1ad8-e667-4cb1-b5e6-f1d9cb5c5b5c.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"测试是否能连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试是否能连接"}},[s._v("#")]),s._v(" 测试是否能连接")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640784121888-a9c4aba4-8c95-4848-8926-3944feb7d5c3.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改代码做测试看看是否出现先的war包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat pom.xml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v("."),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v("<")]),s._v("/version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "5.0.0"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master c5e9363"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v(".0\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" insertion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" deletion"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push origin master")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640784335608-7e1771b4-bdf3-4be8-9904-138bca7003d6.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640832855029-f5bd4221-e3de-434c-aee4-98c9509954cb.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"编写shell脚本-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写shell脚本-2"}},[s._v("#")]),s._v(" 编写shell脚本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /scripts/deploy_nexus_war.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("web_dir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("web_name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ROOT\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tomcat_site")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/soft/tomcat/webapps\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tomcat_bin")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/soft/tomcat/bin\n\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("lb_server_disable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${lbservers}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"echo 'disable server java_cluster/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("lb_server_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${lbservers}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"echo 'enable  server java_cluster/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.提取包名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("pkg_name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("java_deploy_package"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##*/}")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.基于包名称提取创建的目录名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dir_name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("pkg_name%.*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.下载编译后的包到指定的路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pkg_name}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${java_deploy_package}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#4.推送war包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5.停止Tomcat,解压war包到指定的路径,然后删除软链接,重建软链接,启动Tomcat")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("host")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${webserver}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        lb_server_disable "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pkg_name}")]),s._v("  root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pkg_name}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_bin}")]),s._v("/shutdown.sh  && \\\n                         cd "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v(" && mkdir -p "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${dir_name}")]),s._v(" && \\\n                         unzip "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pkg_name}")]),s._v(" -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${dir_name}")]),s._v(" && \\\n                         rm -rf "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_site}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_name}")]),s._v(" && \\\n                         ln -s "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${dir_name}")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_site}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_name}")]),s._v(" && \\\n                         "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${tomcat_bin}")]),s._v('/startup.sh"')]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n       lb_server_enable "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br")])]),a("h4",{attrs:{id:"基于ansible实现部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于ansible实现部署"}},[s._v("#")]),s._v(" 基于ansible实现部署")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /scripts/deploy_nexus_war.yml")]),s._v("\n- hosts: webservers\n  vars:\n    - work_dir: /opt\n    - web_name: ROOT\n    - tomcat_site: /soft/tomcat/webapps\n    - web_backend: java_cluster\n    - service_port: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8010")]),s._v("\n  serial: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  tasks:\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.提取url地址 {{ java_deploy_package.stdout }}")]),s._v("\n   - name: Get Packages Url Name\n     shell:\n       cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${java_deploy_package}")]),s._v('"')]),s._v("\n     register: java_deploy_package\n     delegate_to: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 提取url中包名称")]),s._v("\n   - name: Get Package Name\n     shell:\n       cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${java_deploy_package}")]),s._v(" | awk 'BEGIN {FS="),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("/"),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("} {print "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NF")]),s._v("}'\"")]),s._v("\n     register: java_deploy_pkg\n     delegate_to: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.下载war包到/opt目录")]),s._v("\n   - name: Get Url\n     get_url:\n       url: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ java_deploy_package.stdout }}"')]),s._v("\n       dest: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ java_deploy_pkg.stdout }}"')]),s._v("\n       username: admin\n       password: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n     delegate_to: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\n\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#4.平滑下线web节点")]),s._v("\n   - name: offline Haproxy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname}}"')]),s._v("\n     haproxy:\n        state: disabled\n        host:  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname }}"')]),s._v("\n        backend: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ web_backend }}"')]),s._v("\n        socket: /var/lib/haproxy/stats\n     delegate_to: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ item }}"')]),s._v("\n     loop: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"{{ groups['lbservers'] }}\"")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5.关闭Tomcat服务")]),s._v("\n   - name: Shutdown Tomcat Server\n     shell:\n        cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nohup /soft/tomcat/bin/shutdown.sh &"')]),s._v("\n\n   - name: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wait")]),s._v(" check Tomcat Port Shutdown\n     wait_for:\n        port: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n        state: stopped\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#6.创建目录")]),s._v("\n   - name: Create Tomcat Web Site Direcotry\n     file:\n        path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ java_deploy_pkg.stdout }}"')]),s._v("\n        state: directory\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#7.解压包到指定的路径")]),s._v("\n   - name: Unarchive Web Code\n     unarchive:\n        src: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ java_deploy_pkg.stdout }}"')]),s._v("\n        dest: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ java_deploy_pkg.stdout }}"')]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#8. 删除软链接")]),s._v("\n   - name: Unlink Path\n     file:\n         path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ tomcat_site }}/{{ web_name }}"')]),s._v("\n         state: absent\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#9.重建软链接")]),s._v("\n   - name: Create Links Path\n     file:\n        src: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ work_dir }}/{{ java_deploy_pkg.stdout }}"')]),s._v("\n        dest: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ tomcat_site  }}/{{ web_name }}"')]),s._v("\n        state: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#10.启动tomcat")]),s._v("\n   - name: Systemd Nginx Started\n     shell:\n        cmd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nohup /soft/tomcat/bin/startup.sh &"')]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#11.检测端口")]),s._v("\n   - name: Check tomcat  Port\n     wait_for:\n        port: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ service_port }}"')]),s._v("\n        state: started\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#加入到负载均衡")]),s._v("\n   - name: online Haproxy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname}}"')]),s._v("\n     haproxy:\n        state: enabled\n        host:  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ inventory_hostname }}"')]),s._v("\n        backend: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ web_backend }}"')]),s._v("\n        socket: /var/lib/haproxy/stats\n     delegate_to: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{ item }}"')]),s._v("\n     loop: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"{{ groups['lbservers'] }}\"")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br")])]),a("p",[s._v("到了这步就可以模拟开发更改代码,进行一次ci与cd的测试了,修改后nexus_sh(CI) 会自动构建和上传")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim src/main/webapp/index.jsp")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git  add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "6"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master d2c311a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" files changed, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" insertions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("+"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" deletions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push origin master")]),s._v("\nCounting objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(", done.\nDelta compression using up to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" threads.\nCompressing objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("/5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", done.\nWriting objects: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("% "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("/7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("518")]),s._v(" bytes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" bytes/s, done.\nTotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", reused "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("delta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTo git@www.xiaomao.com:dev/spring-hello-world-war.git\n   c5e9363"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("d2c311a  master -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" master\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改版本 ")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 spring-hello-world-war"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat pom.xml")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("81.0")]),s._v("."),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v("<")]),s._v("/version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 等一段时间后就看到版本出来了")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640879881594-813db53c-38e6-4740-92b9-98c6ba6ed115.png",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"实现jar包的ci与cd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现jar包的ci与cd"}},[s._v("#")]),s._v(" 实现jar包的CI与CD")]),s._v(" "),a("h4",{attrs:{id:"gitlab项目创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab项目创建"}},[s._v("#")]),s._v(" gitlab项目创建")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640932890395-28f9ec04-c18b-4fae-8164-5c806a54bf16.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交代码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git init")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git remote add origin git@www.xiaomao.com:dev/spring-hello-world-jar.git")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "Initial commit"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -u origin master")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"创建ci"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建ci"}},[s._v("#")]),s._v(" 创建CI")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640933262337-c094584c-e90f-4956-abeb-a9e261aa99fe.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640933379683-d2e60b3e-aad3-4b5a-bd35-b764112cb5e3.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640933561396-8ab07355-9299-481e-89a9-5b955cc338ef.png",alt:"img"}})]),s._v(" "),a("p",[s._v("配置自动构建")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640934387867-ae8e0b33-723a-40a7-b389-bdc0ce5ee019.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2021/png/10358179/1640934401673-f537cd77-59ce-4646-8954-493d4f9f1386.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_27%2Ctext_eGlhb21hbw%3D%3D%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10",alt:"img"}})]),s._v(" "),a("p",[s._v("gitlab操作")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640934538405-f49e166e-3c03-46bf-aa99-ab3037074b42.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640934591933-691838b9-514a-46a0-9bf2-170ce4003688.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"ci的shell脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ci的shell脚本"}},[s._v("#")]),s._v(" ci的shell脚本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /scripts/deploy_nexus.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("mvn  help:evaluate "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dexpression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project.groupId "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[INFO]"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("mvn  help:evaluate "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dexpression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project.artifactId "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[INFO]"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("mvn  help:evaluate "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dexpression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project.version "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[INFO]"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("packaging")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("mvn  help:evaluate "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dexpression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("project.packaging "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[INFO]"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\nmvn  deploy:deploy-file  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DgroupId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${groupId}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DartifactId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${artifactId}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dversion")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${version}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dpackaging")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${packaging}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dfile")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${WORKSPACE}")]),s._v("/target/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${artifactId}")]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${version}")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${packaging}")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Durl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://10.2.32.10/repository/maven-releases/  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DrepositoryId")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nexus-releases  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DgeneratePom")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("最后在下方点击添加即可")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试自动构建 修改代码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim pom.xml")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("."),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v("<")]),s._v("/version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改展示界面")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim src/main/java/com/oldxu/helloworld/controller/HomeController.java")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交代码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -m "add"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 springboot-helloworld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push origin master")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交完返回查看jenkins工程是否已经自动构建")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h5",{attrs:{id:"负载均衡配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡配置"}},[s._v("#")]),s._v(" 负载均衡配置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提前配置jar包访问的端口，只要没有用过的端口就行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 负载均衡配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao6 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/haproxy/haproxy.cfg")]),s._v("\nbackend jar_cluster\n    balance roundrobin\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.12  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.12:8899  check port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8899")]),s._v("\n    server "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.10  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".32.10:8899  check port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8899")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启haproxy")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao6 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart haproxy")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h4",{attrs:{id:"创建cd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建cd"}},[s._v("#")]),s._v(" 创建CD")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640939853846-cfd1b830-4cd7-4dbf-b556-03d0ddf85361.png",alt:"img"}})]),s._v(" "),a("p",[s._v("变量名称随便取")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640939951998-25153226-8bd9-49d4-b9d5-b78fc7c39471.png",alt:"img"}})]),s._v(" "),a("p",[s._v("私有仓库的信息")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640939989770-221fd1a9-b7a3-4d97-9e33-62132be0982f.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640940036869-46b66811-3207-48d5-98a4-45d818505b7e.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640940053858-7fd23acf-facb-4e9f-a0bc-535811958276.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640940067859-ca517d7c-8f0e-4615-a184-a1acdf7cc205.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1640940106708-cd697afc-f901-4008-84bb-05299f221d76.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"shell脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shell脚本"}},[s._v("#")]),s._v(" shell脚本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 scripts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat deploy_nexus_jar.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("web_dir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1809")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("lb_server_disable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${lbservers}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"echo 'disable server java_cluster/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("lb_server_enable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${lbservers}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"echo 'enable  server java_cluster/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("' | socat stdio /var/lib/haproxy/stats\"")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.提取包名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("pkg_name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("java_deploy_package"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##*/}")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.基于包名称提取创建的目录名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("pkg_process")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("pkg_name%-*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.下载编译后的包到指定的路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-O")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pkg_name}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${java_deploy_package}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#4.推送jar包,停止jar,启动jar")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("host")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${webserver}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        lb_server_disable "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pkg_name}")]),s._v("  root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pkg_name}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'jar_status=$(ps aux | grep demo-service | grep -v grep | awk \"{print \\$2}\") && \\\n                            kill -9 ${jar_status}'")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nohup java -jar '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${web_dir}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${pkg_name}")]),s._v(" --server.port="),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${port}")]),s._v('  &>/dev/null &"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n        lb_server_enable "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${host}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("h3",{attrs:{id:"sonarqube"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sonarqube"}},[s._v("#")]),s._v(" SonarQube")]),s._v(" "),a("h4",{attrs:{id:"sonarqube基本介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sonarqube基本介绍"}},[s._v("#")]),s._v(" SonarQube基本介绍")]),s._v(" "),a("p",[s._v("SonarQube是一个开源的代码质量管理系统，用于检测代码中的错误,漏洞,它可以与Jenkins集成，")]),s._v(" "),a("p",[s._v("让我们进行自动化代码质量扫描")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641061651312-fcbe4a22-7383-4ad4-936e-adb3f30c5972.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"使用sonarqube前提"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用sonarqube前提"}},[s._v("#")]),s._v(" 使用Sonarqube前提")]),s._v(" "),a("p",[s._v("1、SonarQube基于Java开发,所以需要安装Open Jdk8版本")]),s._v(" "),a("p",[s._v("2、SonarQube需要依赖于MySQL数据库,至少5.6版本以上")]),s._v(" "),a("p",[s._v("3、SonarQube的小型实例至少需要4GB内存,如果是大型实例需要16GB")]),s._v(" "),a("h4",{attrs:{id:"服务安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务安装"}},[s._v("#")]),s._v(" 服务安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装数据库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nmysql-community-client-5.6.45-2.el7.x86_64.rpm  mysql-community-libs-5.6.45-2.el7.x86_64.rpm    sonar_plugins.tar.gz  sonar-scanner-cli-4.0.0.1744-linux.zip\nmysql-community-common-5.6.45-2.el7.x86_64.rpm  mysql-community-server-5.6.45-2.el7.x86_64.rpm  sonarqube-7.0.zip\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install mysql-community-*")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动MySQL数据库")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start mysqld")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为数据库设置密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqladmin password xiaomao.net")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建sonar库,设定字符集为utf8")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pxiaomao.net")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" CREATE DATABASE sonar  DEFAULT CHARACTER SET utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery OK, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" row affected "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SHOW DATABASES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Database           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" information_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" mysql              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" performance_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" sonar              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h5",{attrs:{id:"安装sonarqube"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装sonarqube"}},[s._v("#")]),s._v(" 安装Sonarqube")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压源码包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# unzip sonarqube-7.0.zip  -d /usr/local/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置软链接")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s  /usr/local/sonarqube-7.0/  /usr/local/sonarqube")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h5",{attrs:{id:"修改sonarqube配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改sonarqube配置文件"}},[s._v("#")]),s._v(" 修改Sonarqube配置文件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /usr/local/sonarqube/conf/sonar.properties")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sonar.jdbc.username")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sonar.jdbc.password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xiaomao.net\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sonar.jdbc.url")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("jdbc:mysql://localhost:3306/sonar?useUnicode"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("characterEncoding")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rewriteBatchedStatements")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("useConfigs")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("maxPerformance"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("useSSL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"启动sonarqube"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动sonarqube"}},[s._v("#")]),s._v(" 启动Sonarqube")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动sonarqube服务需要使用普通用户运行,如果使用root则会启动失败")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd sonar")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R sonar.sonar /usr/local/sonarqube-7.0/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# su - sonar -c "/usr/local/sonarqube/bin/linux-x86-64/sonar.sh start"')]),s._v("\nStarting SonarQube"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nStarted SonarQube.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"访问sonarqube"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#访问sonarqube"}},[s._v("#")]),s._v(" 访问Sonarqube")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("http://10.2.32.11:9000/about\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641063951121-1ce4c6f2-5edc-458b-ac8b-05f04a8cbf4b.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"生产token令牌"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生产token令牌"}},[s._v("#")]),s._v(" 生产token令牌")]),s._v(" "),a("p",[s._v("sonarqube初始化操作,配置认证token，使用Token访问sonar无需密码")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641064033800-d606f4c9-7316-4581-ad9d-c781de3611ae.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#jenkins的时候需要配置")]),s._v("\n993a70cb6dd50f9755bbecc183a38186811cab07\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641064054378-569e9a3e-ad63-47cd-a6bf-336af03f45e0.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641064260478-b8a524ee-f144-4f04-a346-c8f4c1663042.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"联网安装插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#联网安装插件"}},[s._v("#")]),s._v(" 联网安装插件")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装好插件的路径")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /usr/local/sonarqube/extensions/plugins/")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641064563815-e311921e-0804-4673-a9d4-fa9316988f40.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 离线安装插件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rm -rf  /usr/local/sonarqube/extensions/plugins/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar xf sonar_plugins.tar.gz  -C /usr/local/sonarqube/extensions/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# chown -R sonar.sonar /usr/local/sonarqube/extensions/plugins/[root@xiaomao8 test]# su - sonar -c  "/usr/local/sonarqube/bin/linux-x86-64/sonar.sh restart"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"jenkins集成sonarqube"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins集成sonarqube"}},[s._v("#")]),s._v(" jenkins集成SonarQube")]),s._v(" "),a("p",[s._v("jenkins需要知道Sonarqube服务;以便能将代码推送指定服务节点")]),s._v(" "),a("p",[s._v("jenkins需要知道Sonar-Scanner客户端工具,以便能正常调用")]),s._v(" "),a("p",[s._v("插件安装:系统管理---\x3e插件管理---\x3eSonarQube Scanner")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641065572016-e29affd1-4e9c-45cd-b2f9-2759c2bac298.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"配置jenkins集成sonarqube"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置jenkins集成sonarqube"}},[s._v("#")]),s._v(" 配置jenkins集成sonarqube")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641065723862-d3fce709-4a7a-4eb0-8c70-b99acb896615.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641065961545-3e653bfe-9910-45d9-bb0d-7574f7fc1556.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641065941445-3b498416-fd51-4f02-9df9-438a9bbab305.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"集成sonar-scanner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集成sonar-scanner"}},[s._v("#")]),s._v(" 集成sonar-scanner")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# unzip sonar-scanner-cli-4.0.0.1744-linux.zip   -d  /usr/local/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@xiaomao8 test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -sv /usr/local/sonar-scanner-4.0.0.1744-linux/  /usr/local/sonar-scanner")]),s._v("\n‘/usr/local/sonar-scanner’ -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ‘/usr/local/sonar-scanner-4.0.0.1744-linux/’\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641066290250-710ef6d1-4bf5-4512-998b-6875f89ac6cf.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641066261771-bb47fc38-55f9-40f5-b1e8-5bbd68cf7d97.png",alt:"img"}})]),s._v(" "),a("p",[s._v("为项目添加测试阶段")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641068629221-0b4ed21c-3809-4f9f-ae04-02c61400a37d.png",alt:"img"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sonar.projectName")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${JOB_NAME}")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sonar.projectKey")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${JOB_NAME}")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#唯一标识,不能重复")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sonar.sources")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".                            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#扫描哪个项目的源码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sonar.java.binaries")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("target/classes  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#路径")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641068659496-e7c08d97-c776-4253-a1a0-48e6f4c807c7.png",alt:"img"}})]),s._v(" "),a("p",[s._v("检查结果查看")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641068676971-38b9dc44-e1a6-4a8b-8423-63093210f79e.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"自动化部署测试环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动化部署测试环境"}},[s._v("#")]),s._v(" 自动化部署测试环境")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641068876000-2a84600f-5336-495e-ad7d-b9d4424d40df.png",alt:"img"}})]),s._v(" "),a("p",[s._v("拉取完代码自动构建打包上传到仓库,然后在自动部署到测试环境中")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641068934669-f3d1970e-4061-4583-867b-f4159a08f38e.png",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"项目通知阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目通知阶段"}},[s._v("#")]),s._v(" 项目通知阶段")]),s._v(" "),a("h4",{attrs:{id:"安装插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装插件"}},[s._v("#")]),s._v(" 安装插件")]),s._v(" "),a("p",[s._v("jenkins安装dingding插件")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641215169452-e65e4266-db29-4f89-8784-0c2a19fc20f3.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"配置钉钉"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置钉钉"}},[s._v("#")]),s._v(" 配置钉钉")]),s._v(" "),a("p",[s._v("1、打开钉钉群组,点击群机器人(必须是群组,才可以创建机器人)")]),s._v(" "),a("p",[s._v("2、添加一个自定义的机器人")]),s._v(" "),a("p",[s._v("3、可以修改机器人名称,以及机器人的名字")]),s._v(" "),a("p",[s._v("4、机器人修改成功后,会给出一个webhook地址(此处的webhook后续jenkins需要使用)")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641216245545-89ae2cc8-92b7-488c-8e63-26ab764b6b54.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"jenkins集成钉钉"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins集成钉钉"}},[s._v("#")]),s._v(" jenkins集成钉钉")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641216377293-03f9697a-b92f-4869-b0fb-637ed154043d.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641216520298-578f405d-37cb-4ed2-b43a-644c1281052c.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641216543499-c8594404-7976-4075-9b20-cd198baba976.png",alt:"img"}})]),s._v(" "),a("h5",{attrs:{id:"添加机器人成功"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加机器人成功"}},[s._v("#")]),s._v(" 添加机器人成功")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641216571071-ba961a20-ba7e-40a2-9b83-24c427385c65.png",alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"为项目添加机器人"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为项目添加机器人"}},[s._v("#")]),s._v(" 为项目添加机器人")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641225673654-103c0bb7-cb12-4a51-8b69-776f7f04f1df.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641225686582-76a34b02-2428-457c-beb7-4877fe3c60ab.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641225704325-864f83f1-3532-416e-bee2-c9ecc7333aa1.png",alt:"img"}})]),s._v(" "),a("h3",{attrs:{id:"权限管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#权限管理"}},[s._v("#")]),s._v(" 权限管理")]),s._v(" "),a("h4",{attrs:{id:"基本概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本概念"}},[s._v("#")]),s._v(" 基本概念")]),s._v(" "),a("p",[s._v("基于角色的访问控制可以设定更加详细的访问控制,需要role-based authorization strategy插件")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641280902906-0768257c-4569-4eb5-bb54-11b228607a3e.png",alt:"img"}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("全局角色配置(控制登陆用户能操作jenkins的那些资源)")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("首先创建角色,设定好对应的权限")]),s._v(" "),a("li",[s._v("创建用户")]),s._v(" "),a("li",[s._v("最后将用户与角色进行关联")])])]),s._v(" "),a("li",[a("p",[s._v("项目角色配置方式(控制用户能看到哪些项目,并且有什么样的权限)")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("首先创建角色,然后将角色与项目名进行关联")]),s._v(" "),a("li",[s._v("其次给角色分配对应的权限")]),s._v(" "),a("li",[s._v("最后将用户关联至该角色")])])])]),s._v(" "),a("h4",{attrs:{id:"全局角色配置实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局角色配置实例"}},[s._v("#")]),s._v(" 全局角色配置实例")]),s._v(" "),a("p",[s._v("1、启用创建")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641281807077-e1c88b4e-c5ff-42ce-8b4c-39a77c41ab6f.png",alt:"img"}})]),s._v(" "),a("p",[s._v("2、创建角色,并为角色分配权限")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641281890204-a2c4ac8b-9deb-4351-9999-ca755f1f5ca5.png",alt:"img"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641281998378-6e53c5eb-7d09-4f3a-8396-48a5d0323f19.png",alt:"img"}})]),s._v(" "),a("p",[s._v("3、创建用户,并将用户关联该角色")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/1641282284790-5feeb77e-e02b-4862-8307-478ff448cf84.png",alt:"img"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);