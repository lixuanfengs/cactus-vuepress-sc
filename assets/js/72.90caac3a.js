(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{427:function(e,s,a){"use strict";a.r(s);var n=a(0),l=Object(n.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("Cloudflare Argo Tunnel是Cloudflare提供的一项服务，它允许将您的私有Web服务器安全地连接到Cloudflare的全球网络，而无需公开暴露服务器的IP地址。它通过使用一个名为Argo Tunnel的客户端软件来实现这一功能。")]),e._v(" "),s("p",[e._v("Argo Tunnel的工作原理是，您在私有服务器上安装Argo Tunnel客户端，并与Cloudflare进行连接。这个客户端会创建一个加密的隧道，将流量从您的服务器发送到Cloudflare的边缘节点。这意味着您的服务器可以隐藏在Cloudflare的网络后面，不会直接暴露给公众。")]),e._v(" "),s("p",[e._v("Argo Tunnel通过HTTPS协议进行通信，使用TLS来保护数据的安全性。它使用了现代加密技术来防止中间人攻击和数据篡改。这样，您的服务器和Cloudflare之间的通信将是安全的。")]),e._v(" "),s("p",[e._v("使用Argo Tunnel的好处之一是，它可以帮助您绕过防火墙和网络限制。如果您的服务器位于一个有严格出口限制的网络中，或者受到了防火墙的限制，Argo Tunnel可以让您的服务器通过Cloudflare的网络进行访问。")]),e._v(" "),s("p",[e._v("另一个好处是，Argo Tunnel可以帮助您提高网络性能和可靠性。通过将您的服务器与Cloudflare的边缘节点连接，您的内容可以更快地传送给用户，因为它们可以从离他们更近的位置获取数据。此外，如果您的服务器发生故障，Cloudflare可以提供故障转移，确保您的网站仍然可用。")]),e._v(" "),s("p",[e._v("总而言之，Cloudflare Argo Tunnel是一个安全且高效的方法，可以将私有Web服务器与Cloudflare的全球网络连接起来。它提供了数据加密和隐藏服务器IP地址的功能，并帮助您绕过防火墙和提高网络性能。\n")]),e._v(" "),s("h2",{attrs:{id:"步骤和准备的文件和资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤和准备的文件和资料"}},[e._v("#")]),e._v(" 步骤和准备的文件和资料")]),e._v(" "),s("ul",[s("li",[e._v("注册 cloudflare账号")]),e._v(" "),s("li",[e._v("（可选）把域名的 ns 改成 cloudflare")]),e._v(" "),s("li",[e._v("安装 cloudflared 并登录")]),e._v(" "),s("li",[e._v("创建 argo tunnel")]),e._v(" "),s("li",[e._v("创建 dns 记录")]),e._v(" "),s("li",[e._v("配置 tunnel")]),e._v(" "),s("li",[e._v("后台运行 tunnel")])]),e._v(" "),s("h2",{attrs:{id:"注册-cloudflare-账号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册-cloudflare-账号"}},[e._v("#")]),e._v(" 注册 "),s("code",[e._v("cloudflare")]),e._v(" 账号")]),e._v(" "),s("p",[e._v("打开官方注册网站根据提示步骤进行注册："),s("a",{attrs:{href:"https://dash.cloudflare.com/sign-up",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cloudflare | Web Performance & Security"),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"把域名的-ns-改成-cloudflare"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#把域名的-ns-改成-cloudflare"}},[e._v("#")]),e._v(" 把域名的 "),s("code",[e._v("ns")]),e._v(" 改成 "),s("code",[e._v("cloudflare")])]),e._v(" "),s("p",[e._v("这一步是可选的步骤，Argo Tunnel 默认会提供一个域名，如果有自己的域名就更好了，直接解析就行。")]),e._v(" "),s("h2",{attrs:{id:"安装-cloudflared-并登录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-cloudflared-并登录"}},[e._v("#")]),e._v(" 安装 "),s("code",[e._v("cloudflared")]),e._v(" 并登录")]),e._v(" "),s("p",[e._v("详细步骤可以参考： "),s("a",{attrs:{href:"https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方文档"),s("OutboundLink")],1)]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 把 url 里的文件数据写入到 cloudflared")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("wget")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-O")]),e._v(" cloudflared "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-v")]),e._v(" https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-arm64\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 赋予执行权限")]),e._v("\nchomd +x cloudflared\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 拷贝到本地系统预装的可执行程序文件夹下方便执行")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" cloudflared /usr/loca/bin/\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("做完上述步骤就可以进行登录啦！")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("cloudflared tunnel login\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("运行登录命令后控制台会出现需要在浏览器访问的页面路径，打开页面后需要选择你自己的域名，选择完成后控制台会有如下输出：")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("You have successfully logged in.\nIf you wish to copy your credentials to a server, they have been saved to:\n/root/.cloudflared/cert.pem\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("h2",{attrs:{id:"创建一个隧道并给定名称"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建一个隧道并给定名称"}},[e._v("#")]),e._v(" 创建一个隧道并给定名称")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# name 可以自己取一个最好是见名知意如：cloudflare\ncloudflared tunnel create <NAME>\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("运行此命令将：")]),e._v(" "),s("ul",[s("li",[e._v("通过在"),s("a",{attrs:{href:"https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/tunnel-useful-terms/#tunnel-name",target:"_blank",rel:"noopener noreferrer"}},[e._v("提供的名称和"),s("OutboundLink")],1),e._v("隧道的 "),s("a",{attrs:{href:"https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/tunnel-useful-terms/#tunnel-uuid",target:"_blank",rel:"noopener noreferrer"}},[e._v("UUID"),s("OutboundLink")],1),e._v(" 之间建立持久关系来创建隧道。此时，隧道内尚无任何连接处于活动状态。")]),e._v(" "),s("li",[e._v("在"),s("a",{attrs:{href:"https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/tunnel-useful-terms/#default-cloudflared-directory",target:"_blank",rel:"noopener noreferrer"}},[e._v("默认"),s("code",[e._v("的 cloudflared")]),e._v(" 目录中"),s("OutboundLink")],1),e._v("生成"),s("a",{attrs:{href:"https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/tunnel-useful-terms/#credentials-file",target:"_blank",rel:"noopener noreferrer"}},[e._v("隧道凭证文件"),s("OutboundLink")],1),e._v("。")]),e._v(" "),s("li",[e._v("创建 的子域。"),s("code",[e._v(".cfargotunnel.com")])])]),e._v(" "),s("p",[e._v("从命令的输出中，记下隧道的 UUID 和隧道凭证文件的路径。")]),e._v(" "),s("p",[e._v("通过运行以下命令确认已成功创建隧道：")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("cloudflared tunnel list\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("还可以使用以下命令删除隧道：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cloudflared tunnel delete cloudflare\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h2",{attrs:{id:"创建-dns-记录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建-dns-记录"}},[e._v("#")]),e._v(" 创建 "),s("code",[e._v("DNS")]),e._v(" 记录")]),e._v(" "),s("p",[e._v("有两种方法。")]),e._v(" "),s("p",[e._v("第一种直接去官方的 "),s("code",[e._v("dashboard")]),e._v(" 中的侧边导航栏 DNS 菜单中创建一条 "),s("code",[e._v("UUID.cfargotunnel.com")]),e._v(" 的 "),s("code",[e._v("CNAME")]),e._v(" 解析。")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://lixuanfengs.github.io/blog-images/cactus-blogs/image-20230525175702387.png",alt:"image-20230525175702387"}})]),e._v(" "),s("p",[e._v("第二种方法是使用 cloudflared 命令来创建。")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("cloudflared tunnel route dns "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("UUID or NAME"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" nstr.cloudflaress.eu.org\n\ncloudflared tunnel route dns "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("隧道名字"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("域名"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 比如一级域名（和Web界面不一样，不需要输入@）")]),e._v("\ncloudflared tunnel route dns webserver-1 abc.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 又比如二级域名")]),e._v("\ncloudflared tunnel route dns webserver-1 www.abc.com\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#测试案例")]),e._v("\ncloudflared tunnel route dns cloudflaress firework.cloudflaress.eu.org\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br")])]),s("p",[e._v("此时如果你访问 "),s("code",[e._v("nstr.cloudflaress.eu.org")]),e._v(" ，会看到1033错误，因为我们的 tunnel 还没有运行。")]),e._v(" "),s("h2",{attrs:{id:"配置-tunnel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-tunnel"}},[e._v("#")]),e._v(" 配置 "),s("code",[e._v("tunnel")])]),e._v(" "),s("p",[e._v("接下来就需要在 "),s("code",[e._v("linux")]),e._v("上配置如何运行 "),s("code",[e._v("tunnel")]),e._v(" 了, 一个简单的例子如下：")]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("vim")]),e._v(" nstr-tunnel.yml\n\ntunnel: cloudflaress "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 创建的 tunnel 名称")]),e._v("\ncredentials-file: /root/.cloudflared/0880aa-df5c-4431-500-7c4d5a3d8ad4.json "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 创建 tunnel 时生成的 UUID")]),e._v("\n \ningress:\n  - hostname: nstr.cloudflaress.eu.org "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 自己选择的域名")]),e._v("\n    service: http://localhost:23366 "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 需要代理的本地服务")]),e._v("\n  - service: http_status:404                      \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br")])]),s("p",[e._v("创建完配置文件后运行以下命令来启动 "),s("code",[e._v("tunnel")])]),e._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("cloudflared tunnel "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--config")]),e._v(" ~/nstr-tunnel.yml run\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("如果不想写这种配置文件，也可以一条命令就能创建运行")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cloudflared tunnel run --url localhost:22 <NAME or UUID>\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("看到一大串输出，没有报错，那我们的 "),s("code",[e._v("tunnel")]),e._v(" 就成功了，在浏览器输入 "),s("code",[e._v("nstr.cloudflaress.eu.org")]),e._v(" 域名就能访问到本地内网的服务了。")]),e._v(" "),s("h2",{attrs:{id:"将-cloudflared-作为服务运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将-cloudflared-作为服务运行"}},[e._v("#")]),e._v(" 将 cloudflared 作为服务运行")]),e._v(" "),s("p",[e._v("安装服务 。")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("cloudflared service install\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("启动服务。")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("systemctl start cloudflared\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("（可选）查看服务的状态。")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("systemctl status cloudflared\n\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])])])}),[],!1,null,null,null);s.default=l.exports}}]);