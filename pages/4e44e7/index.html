<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>redis安装部署 | Cactusli blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3077305_pt8umhrn4k9.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3129839_xft6cqs5gc.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/artalk/2.5.5/Artalk.css">
    <script src="https://cdn.bootcdn.net/ajax/libs/artalk/2.5.5/Artalk.js"></script>
    <script>var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?efc65c9365211267213266ca9b95b304"; 
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
          })();
          </script>
    <meta name="description" content="后端技术博客,专注前后端学习与总结。Java,JavaScript,js,ES6,TypeScript,vue,React,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="后端端博客,个人技术博客,后端,后端开发,前端框架,Java后端,后端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="codeva-nBtnwPHxXt">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/assets/css/0.styles.b8eeafc3.css" as="style"><link rel="preload" href="/assets/js/app.d73578e6.js" as="script"><link rel="preload" href="/assets/js/2.f6444e8b.js" as="script"><link rel="preload" href="/assets/js/59.cb26cb6a.js" as="script"><link rel="preload" href="/assets/js/13.9ca28764.js" as="script"><link rel="preload" href="/assets/js/6.0f00df03.js" as="script"><link rel="preload" href="/assets/js/5.1368437e.js" as="script"><link rel="preload" href="/assets/js/4.7c9e6596.js" as="script"><link rel="prefetch" href="/assets/js/10.af60255b.js"><link rel="prefetch" href="/assets/js/100.3ef796c4.js"><link rel="prefetch" href="/assets/js/101.aae7784e.js"><link rel="prefetch" href="/assets/js/102.8da091f1.js"><link rel="prefetch" href="/assets/js/103.ad0dd5b7.js"><link rel="prefetch" href="/assets/js/104.642836fc.js"><link rel="prefetch" href="/assets/js/105.f3c5bcec.js"><link rel="prefetch" href="/assets/js/106.85dad7d8.js"><link rel="prefetch" href="/assets/js/107.42b1c013.js"><link rel="prefetch" href="/assets/js/108.2a978b6c.js"><link rel="prefetch" href="/assets/js/109.46c8b7c6.js"><link rel="prefetch" href="/assets/js/11.372f8efb.js"><link rel="prefetch" href="/assets/js/110.2cb8a5dc.js"><link rel="prefetch" href="/assets/js/111.c68e8975.js"><link rel="prefetch" href="/assets/js/112.d89adde5.js"><link rel="prefetch" href="/assets/js/113.e52ab124.js"><link rel="prefetch" href="/assets/js/114.94f7a70b.js"><link rel="prefetch" href="/assets/js/115.68c55722.js"><link rel="prefetch" href="/assets/js/116.9cdf5c61.js"><link rel="prefetch" href="/assets/js/117.34a7707c.js"><link rel="prefetch" href="/assets/js/118.e9922234.js"><link rel="prefetch" href="/assets/js/119.61fe4a4e.js"><link rel="prefetch" href="/assets/js/12.1061ddb5.js"><link rel="prefetch" href="/assets/js/120.fe5311f5.js"><link rel="prefetch" href="/assets/js/121.905e8e51.js"><link rel="prefetch" href="/assets/js/122.8cd7cd0c.js"><link rel="prefetch" href="/assets/js/123.f4f98520.js"><link rel="prefetch" href="/assets/js/124.4e233943.js"><link rel="prefetch" href="/assets/js/125.092aa1bf.js"><link rel="prefetch" href="/assets/js/126.b9c11778.js"><link rel="prefetch" href="/assets/js/127.e55d2fa9.js"><link rel="prefetch" href="/assets/js/128.3197df92.js"><link rel="prefetch" href="/assets/js/129.0244ee9b.js"><link rel="prefetch" href="/assets/js/130.e0648777.js"><link rel="prefetch" href="/assets/js/131.94e0b948.js"><link rel="prefetch" href="/assets/js/132.8520ded5.js"><link rel="prefetch" href="/assets/js/133.034f0365.js"><link rel="prefetch" href="/assets/js/134.1ca4a150.js"><link rel="prefetch" href="/assets/js/135.bdfc5c00.js"><link rel="prefetch" href="/assets/js/136.4918fec8.js"><link rel="prefetch" href="/assets/js/137.2db62de4.js"><link rel="prefetch" href="/assets/js/138.87fd076f.js"><link rel="prefetch" href="/assets/js/139.eecbbecd.js"><link rel="prefetch" href="/assets/js/14.2c349983.js"><link rel="prefetch" href="/assets/js/140.40d4aa29.js"><link rel="prefetch" href="/assets/js/141.dc280dee.js"><link rel="prefetch" href="/assets/js/142.4fa6a57c.js"><link rel="prefetch" href="/assets/js/143.33b90797.js"><link rel="prefetch" href="/assets/js/144.180e147f.js"><link rel="prefetch" href="/assets/js/145.832bf539.js"><link rel="prefetch" href="/assets/js/146.71cc0cd4.js"><link rel="prefetch" href="/assets/js/147.4d966ac1.js"><link rel="prefetch" href="/assets/js/148.98ccdf6a.js"><link rel="prefetch" href="/assets/js/149.c6e90dd0.js"><link rel="prefetch" href="/assets/js/15.5bb38388.js"><link rel="prefetch" href="/assets/js/150.cb70fd12.js"><link rel="prefetch" href="/assets/js/151.2da07e43.js"><link rel="prefetch" href="/assets/js/152.65bb34e9.js"><link rel="prefetch" href="/assets/js/153.10ef087b.js"><link rel="prefetch" href="/assets/js/154.2b0c9bc8.js"><link rel="prefetch" href="/assets/js/155.e38977ec.js"><link rel="prefetch" href="/assets/js/156.02b0bba1.js"><link rel="prefetch" href="/assets/js/157.3ed0f21f.js"><link rel="prefetch" href="/assets/js/158.beda5a17.js"><link rel="prefetch" href="/assets/js/159.5bfbc4d9.js"><link rel="prefetch" href="/assets/js/16.a58fed94.js"><link rel="prefetch" href="/assets/js/160.408dbb35.js"><link rel="prefetch" href="/assets/js/161.c4344be4.js"><link rel="prefetch" href="/assets/js/162.f80a95f8.js"><link rel="prefetch" href="/assets/js/163.dc12b090.js"><link rel="prefetch" href="/assets/js/164.682e2b57.js"><link rel="prefetch" href="/assets/js/165.0af68775.js"><link rel="prefetch" href="/assets/js/166.6254b754.js"><link rel="prefetch" href="/assets/js/167.727b0d47.js"><link rel="prefetch" href="/assets/js/168.e3458b70.js"><link rel="prefetch" href="/assets/js/169.d6492dcd.js"><link rel="prefetch" href="/assets/js/17.2429b1e6.js"><link rel="prefetch" href="/assets/js/170.3677af86.js"><link rel="prefetch" href="/assets/js/171.fe866179.js"><link rel="prefetch" href="/assets/js/172.c7d611be.js"><link rel="prefetch" href="/assets/js/173.e535d27d.js"><link rel="prefetch" href="/assets/js/174.07646070.js"><link rel="prefetch" href="/assets/js/175.227bcdd6.js"><link rel="prefetch" href="/assets/js/176.d03f1195.js"><link rel="prefetch" href="/assets/js/177.7206380a.js"><link rel="prefetch" href="/assets/js/178.7bfc35c4.js"><link rel="prefetch" href="/assets/js/179.d990d8ea.js"><link rel="prefetch" href="/assets/js/18.a5d750b4.js"><link rel="prefetch" href="/assets/js/180.2e4eba32.js"><link rel="prefetch" href="/assets/js/181.cbd8f5ca.js"><link rel="prefetch" href="/assets/js/182.afd4c94b.js"><link rel="prefetch" href="/assets/js/183.e7ab48ce.js"><link rel="prefetch" href="/assets/js/184.5f21d13c.js"><link rel="prefetch" href="/assets/js/185.4a4fd3b0.js"><link rel="prefetch" href="/assets/js/186.2ff2b9cd.js"><link rel="prefetch" href="/assets/js/187.b325350e.js"><link rel="prefetch" href="/assets/js/188.2a18fad9.js"><link rel="prefetch" href="/assets/js/189.425c0eb4.js"><link rel="prefetch" href="/assets/js/19.6925fadc.js"><link rel="prefetch" href="/assets/js/190.372a786b.js"><link rel="prefetch" href="/assets/js/191.a6b816f2.js"><link rel="prefetch" href="/assets/js/192.2d46ba6c.js"><link rel="prefetch" href="/assets/js/193.9d886ea4.js"><link rel="prefetch" href="/assets/js/194.ec75fc6b.js"><link rel="prefetch" href="/assets/js/195.5688915a.js"><link rel="prefetch" href="/assets/js/196.fa745ec4.js"><link rel="prefetch" href="/assets/js/197.b389a9e8.js"><link rel="prefetch" href="/assets/js/198.66ebbff6.js"><link rel="prefetch" href="/assets/js/199.32103f1f.js"><link rel="prefetch" href="/assets/js/20.d4b6b23a.js"><link rel="prefetch" href="/assets/js/200.1b917b48.js"><link rel="prefetch" href="/assets/js/201.626e8295.js"><link rel="prefetch" href="/assets/js/202.3df66e9e.js"><link rel="prefetch" href="/assets/js/203.aff1d912.js"><link rel="prefetch" href="/assets/js/204.6306a828.js"><link rel="prefetch" href="/assets/js/205.320db987.js"><link rel="prefetch" href="/assets/js/206.b4488e77.js"><link rel="prefetch" href="/assets/js/207.d5f17556.js"><link rel="prefetch" href="/assets/js/208.37210f86.js"><link rel="prefetch" href="/assets/js/209.786c7af4.js"><link rel="prefetch" href="/assets/js/21.95dcd0d6.js"><link rel="prefetch" href="/assets/js/210.38e58d19.js"><link rel="prefetch" href="/assets/js/211.09b699bb.js"><link rel="prefetch" href="/assets/js/212.ffd8d260.js"><link rel="prefetch" href="/assets/js/213.2891f4a0.js"><link rel="prefetch" href="/assets/js/214.8c1a47e0.js"><link rel="prefetch" href="/assets/js/215.c0dec61f.js"><link rel="prefetch" href="/assets/js/216.c71c59ab.js"><link rel="prefetch" href="/assets/js/217.8891c004.js"><link rel="prefetch" href="/assets/js/218.a2075ffe.js"><link rel="prefetch" href="/assets/js/219.1e70631e.js"><link rel="prefetch" href="/assets/js/22.473284b6.js"><link rel="prefetch" href="/assets/js/220.1d012692.js"><link rel="prefetch" href="/assets/js/221.aa4a0d37.js"><link rel="prefetch" href="/assets/js/222.b512a429.js"><link rel="prefetch" href="/assets/js/223.9e6d42f2.js"><link rel="prefetch" href="/assets/js/224.e46f8d1d.js"><link rel="prefetch" href="/assets/js/225.d8083ae3.js"><link rel="prefetch" href="/assets/js/226.7730bb6a.js"><link rel="prefetch" href="/assets/js/227.3ec46626.js"><link rel="prefetch" href="/assets/js/228.0be929cb.js"><link rel="prefetch" href="/assets/js/229.d8da48e4.js"><link rel="prefetch" href="/assets/js/23.1a1a291a.js"><link rel="prefetch" href="/assets/js/230.f6b2bd82.js"><link rel="prefetch" href="/assets/js/231.c43852a4.js"><link rel="prefetch" href="/assets/js/232.0aa9bd8a.js"><link rel="prefetch" href="/assets/js/233.28899baa.js"><link rel="prefetch" href="/assets/js/234.37a56cac.js"><link rel="prefetch" href="/assets/js/235.57d1f2f2.js"><link rel="prefetch" href="/assets/js/236.10c15500.js"><link rel="prefetch" href="/assets/js/237.8ccfba13.js"><link rel="prefetch" href="/assets/js/238.072cdb99.js"><link rel="prefetch" href="/assets/js/239.a4042ce8.js"><link rel="prefetch" href="/assets/js/24.6f32ee5c.js"><link rel="prefetch" href="/assets/js/240.a4e8f29e.js"><link rel="prefetch" href="/assets/js/241.aec0fdc6.js"><link rel="prefetch" href="/assets/js/242.4e5a95cc.js"><link rel="prefetch" href="/assets/js/243.0ab57bd0.js"><link rel="prefetch" href="/assets/js/244.d5257ed9.js"><link rel="prefetch" href="/assets/js/245.747b1f48.js"><link rel="prefetch" href="/assets/js/246.f89916b2.js"><link rel="prefetch" href="/assets/js/247.9baf4f72.js"><link rel="prefetch" href="/assets/js/248.5878bead.js"><link rel="prefetch" href="/assets/js/249.0153ed9a.js"><link rel="prefetch" href="/assets/js/25.825806eb.js"><link rel="prefetch" href="/assets/js/250.4f47bd06.js"><link rel="prefetch" href="/assets/js/251.2c55f0ac.js"><link rel="prefetch" href="/assets/js/252.3171358b.js"><link rel="prefetch" href="/assets/js/253.3d927b62.js"><link rel="prefetch" href="/assets/js/254.56caa785.js"><link rel="prefetch" href="/assets/js/255.b75a0344.js"><link rel="prefetch" href="/assets/js/256.e449fa3a.js"><link rel="prefetch" href="/assets/js/257.a280fd63.js"><link rel="prefetch" href="/assets/js/258.85cacce2.js"><link rel="prefetch" href="/assets/js/259.220782f3.js"><link rel="prefetch" href="/assets/js/26.c2a73fa1.js"><link rel="prefetch" href="/assets/js/260.4cad83bd.js"><link rel="prefetch" href="/assets/js/261.cc01772f.js"><link rel="prefetch" href="/assets/js/262.31fb9ce0.js"><link rel="prefetch" href="/assets/js/263.95d45d4a.js"><link rel="prefetch" href="/assets/js/264.a23581c9.js"><link rel="prefetch" href="/assets/js/265.f4d45025.js"><link rel="prefetch" href="/assets/js/266.08c29ff3.js"><link rel="prefetch" href="/assets/js/267.f25d5c52.js"><link rel="prefetch" href="/assets/js/268.e4b83b3f.js"><link rel="prefetch" href="/assets/js/269.54e6f5d2.js"><link rel="prefetch" href="/assets/js/27.94b60768.js"><link rel="prefetch" href="/assets/js/270.477bbf01.js"><link rel="prefetch" href="/assets/js/271.eadefaf2.js"><link rel="prefetch" href="/assets/js/272.c77f20a4.js"><link rel="prefetch" href="/assets/js/273.86e57213.js"><link rel="prefetch" href="/assets/js/274.caf08186.js"><link rel="prefetch" href="/assets/js/275.843af577.js"><link rel="prefetch" href="/assets/js/276.bc7dfde0.js"><link rel="prefetch" href="/assets/js/277.a18aa211.js"><link rel="prefetch" href="/assets/js/278.25260976.js"><link rel="prefetch" href="/assets/js/279.0bc329e7.js"><link rel="prefetch" href="/assets/js/28.166f967e.js"><link rel="prefetch" href="/assets/js/280.c7eb5b22.js"><link rel="prefetch" href="/assets/js/281.78d4ed73.js"><link rel="prefetch" href="/assets/js/282.08dbc1ff.js"><link rel="prefetch" href="/assets/js/283.1a8ed58d.js"><link rel="prefetch" href="/assets/js/284.c67e1e75.js"><link rel="prefetch" href="/assets/js/285.6252305a.js"><link rel="prefetch" href="/assets/js/286.5c98afe5.js"><link rel="prefetch" href="/assets/js/287.bd42634c.js"><link rel="prefetch" href="/assets/js/288.1a692f6d.js"><link rel="prefetch" href="/assets/js/289.137dd607.js"><link rel="prefetch" href="/assets/js/29.69647249.js"><link rel="prefetch" href="/assets/js/290.6cb00ec4.js"><link rel="prefetch" href="/assets/js/291.4a6210f6.js"><link rel="prefetch" href="/assets/js/292.dedb1bb4.js"><link rel="prefetch" href="/assets/js/293.6e25fb34.js"><link rel="prefetch" href="/assets/js/294.c7f2e4eb.js"><link rel="prefetch" href="/assets/js/295.76fdbc3b.js"><link rel="prefetch" href="/assets/js/296.48999983.js"><link rel="prefetch" href="/assets/js/297.8d1c640d.js"><link rel="prefetch" href="/assets/js/298.9f5441b7.js"><link rel="prefetch" href="/assets/js/299.150b9208.js"><link rel="prefetch" href="/assets/js/3.461c0085.js"><link rel="prefetch" href="/assets/js/30.defdcb36.js"><link rel="prefetch" href="/assets/js/300.6b9057e3.js"><link rel="prefetch" href="/assets/js/301.74c659b3.js"><link rel="prefetch" href="/assets/js/302.6d8ebf64.js"><link rel="prefetch" href="/assets/js/303.21fe2025.js"><link rel="prefetch" href="/assets/js/304.3c05c7a6.js"><link rel="prefetch" href="/assets/js/305.7c3fb5eb.js"><link rel="prefetch" href="/assets/js/306.c1fa105b.js"><link rel="prefetch" href="/assets/js/307.48a1d678.js"><link rel="prefetch" href="/assets/js/308.4e58779a.js"><link rel="prefetch" href="/assets/js/309.9fac2cdc.js"><link rel="prefetch" href="/assets/js/31.77a45ce0.js"><link rel="prefetch" href="/assets/js/310.3a159c1e.js"><link rel="prefetch" href="/assets/js/311.603f45af.js"><link rel="prefetch" href="/assets/js/312.603c7885.js"><link rel="prefetch" href="/assets/js/313.69be703f.js"><link rel="prefetch" href="/assets/js/314.9054c9ab.js"><link rel="prefetch" href="/assets/js/315.e331ef4b.js"><link rel="prefetch" href="/assets/js/316.1d0a506f.js"><link rel="prefetch" href="/assets/js/317.1b787b88.js"><link rel="prefetch" href="/assets/js/318.86f787b0.js"><link rel="prefetch" href="/assets/js/319.a6921190.js"><link rel="prefetch" href="/assets/js/32.93f3bdf1.js"><link rel="prefetch" href="/assets/js/320.f0c26c43.js"><link rel="prefetch" href="/assets/js/321.a19c9ff4.js"><link rel="prefetch" href="/assets/js/322.01ba6221.js"><link rel="prefetch" href="/assets/js/323.978cd49f.js"><link rel="prefetch" href="/assets/js/324.fe310b5d.js"><link rel="prefetch" href="/assets/js/325.3244bcda.js"><link rel="prefetch" href="/assets/js/326.5c4f01a3.js"><link rel="prefetch" href="/assets/js/327.5db6522f.js"><link rel="prefetch" href="/assets/js/328.e220334a.js"><link rel="prefetch" href="/assets/js/329.df7c545b.js"><link rel="prefetch" href="/assets/js/33.f4982416.js"><link rel="prefetch" href="/assets/js/330.3f9cc52f.js"><link rel="prefetch" href="/assets/js/331.1661ec63.js"><link rel="prefetch" href="/assets/js/332.bdec065c.js"><link rel="prefetch" href="/assets/js/333.b663aa77.js"><link rel="prefetch" href="/assets/js/334.b1f6193f.js"><link rel="prefetch" href="/assets/js/335.cc7fedb2.js"><link rel="prefetch" href="/assets/js/336.35aa2903.js"><link rel="prefetch" href="/assets/js/337.a91aa873.js"><link rel="prefetch" href="/assets/js/338.ae795233.js"><link rel="prefetch" href="/assets/js/339.4582441a.js"><link rel="prefetch" href="/assets/js/34.deb0c8cd.js"><link rel="prefetch" href="/assets/js/340.c9e30c24.js"><link rel="prefetch" href="/assets/js/341.ab8bbf2f.js"><link rel="prefetch" href="/assets/js/342.4dcd40fe.js"><link rel="prefetch" href="/assets/js/343.04aa7b0e.js"><link rel="prefetch" href="/assets/js/344.cf12e221.js"><link rel="prefetch" href="/assets/js/345.851fea37.js"><link rel="prefetch" href="/assets/js/346.cd04ce92.js"><link rel="prefetch" href="/assets/js/347.cc13c5f8.js"><link rel="prefetch" href="/assets/js/348.e8149a34.js"><link rel="prefetch" href="/assets/js/349.8c615125.js"><link rel="prefetch" href="/assets/js/35.946b2b10.js"><link rel="prefetch" href="/assets/js/350.297c9452.js"><link rel="prefetch" href="/assets/js/351.c625eafe.js"><link rel="prefetch" href="/assets/js/352.21fc6d9a.js"><link rel="prefetch" href="/assets/js/353.0918e6c0.js"><link rel="prefetch" href="/assets/js/354.760beca2.js"><link rel="prefetch" href="/assets/js/355.ec756b28.js"><link rel="prefetch" href="/assets/js/356.c41182ab.js"><link rel="prefetch" href="/assets/js/357.3a762703.js"><link rel="prefetch" href="/assets/js/358.2c575e4a.js"><link rel="prefetch" href="/assets/js/359.7ce42976.js"><link rel="prefetch" href="/assets/js/36.22805e5a.js"><link rel="prefetch" href="/assets/js/360.ef9a8667.js"><link rel="prefetch" href="/assets/js/361.1511e3f4.js"><link rel="prefetch" href="/assets/js/362.d5fbab7c.js"><link rel="prefetch" href="/assets/js/363.976be7aa.js"><link rel="prefetch" href="/assets/js/364.1843f42a.js"><link rel="prefetch" href="/assets/js/365.dfde987d.js"><link rel="prefetch" href="/assets/js/366.b87a9cb5.js"><link rel="prefetch" href="/assets/js/367.8ba1f57c.js"><link rel="prefetch" href="/assets/js/368.8b96559b.js"><link rel="prefetch" href="/assets/js/369.2546100c.js"><link rel="prefetch" href="/assets/js/37.3525192b.js"><link rel="prefetch" href="/assets/js/370.4db8b482.js"><link rel="prefetch" href="/assets/js/371.0542b71b.js"><link rel="prefetch" href="/assets/js/372.4c9bde18.js"><link rel="prefetch" href="/assets/js/373.32bcd884.js"><link rel="prefetch" href="/assets/js/374.3793da0b.js"><link rel="prefetch" href="/assets/js/375.8297ec5b.js"><link rel="prefetch" href="/assets/js/376.e346176b.js"><link rel="prefetch" href="/assets/js/377.ac5d8c7f.js"><link rel="prefetch" href="/assets/js/378.e0b84ffc.js"><link rel="prefetch" href="/assets/js/379.663b7fb2.js"><link rel="prefetch" href="/assets/js/38.72fc1973.js"><link rel="prefetch" href="/assets/js/380.01abbbeb.js"><link rel="prefetch" href="/assets/js/381.445e4202.js"><link rel="prefetch" href="/assets/js/382.ff24e162.js"><link rel="prefetch" href="/assets/js/383.c8303f29.js"><link rel="prefetch" href="/assets/js/384.67496581.js"><link rel="prefetch" href="/assets/js/385.e206fb4d.js"><link rel="prefetch" href="/assets/js/386.1e324581.js"><link rel="prefetch" href="/assets/js/387.4b3c734b.js"><link rel="prefetch" href="/assets/js/388.89e3ad82.js"><link rel="prefetch" href="/assets/js/389.814cbc20.js"><link rel="prefetch" href="/assets/js/39.85d65742.js"><link rel="prefetch" href="/assets/js/390.3d2bc4b1.js"><link rel="prefetch" href="/assets/js/391.ad15e5c9.js"><link rel="prefetch" href="/assets/js/392.22ea3d28.js"><link rel="prefetch" href="/assets/js/393.dc925e8e.js"><link rel="prefetch" href="/assets/js/394.f758a517.js"><link rel="prefetch" href="/assets/js/395.bb8c0d77.js"><link rel="prefetch" href="/assets/js/396.8cc3e6cb.js"><link rel="prefetch" href="/assets/js/397.44dba438.js"><link rel="prefetch" href="/assets/js/398.76ebedbb.js"><link rel="prefetch" href="/assets/js/399.a6acb507.js"><link rel="prefetch" href="/assets/js/40.2ef6e1f7.js"><link rel="prefetch" href="/assets/js/400.a6d9d98e.js"><link rel="prefetch" href="/assets/js/401.0715bf66.js"><link rel="prefetch" href="/assets/js/402.fff59a65.js"><link rel="prefetch" href="/assets/js/403.9f58e94a.js"><link rel="prefetch" href="/assets/js/404.4817775f.js"><link rel="prefetch" href="/assets/js/405.1744cc09.js"><link rel="prefetch" href="/assets/js/406.a978bd4c.js"><link rel="prefetch" href="/assets/js/407.4fb1ac88.js"><link rel="prefetch" href="/assets/js/408.f1bb0f31.js"><link rel="prefetch" href="/assets/js/409.942c7d40.js"><link rel="prefetch" href="/assets/js/41.a4f19bba.js"><link rel="prefetch" href="/assets/js/410.66f0918b.js"><link rel="prefetch" href="/assets/js/411.6a5436f5.js"><link rel="prefetch" href="/assets/js/412.ec974a04.js"><link rel="prefetch" href="/assets/js/413.ba4fd119.js"><link rel="prefetch" href="/assets/js/414.55e59bef.js"><link rel="prefetch" href="/assets/js/415.412201ca.js"><link rel="prefetch" href="/assets/js/416.4b4ba217.js"><link rel="prefetch" href="/assets/js/417.a65d2f1b.js"><link rel="prefetch" href="/assets/js/418.bf142c63.js"><link rel="prefetch" href="/assets/js/419.65b0f04d.js"><link rel="prefetch" href="/assets/js/42.7f2b0b0f.js"><link rel="prefetch" href="/assets/js/420.ab0f7606.js"><link rel="prefetch" href="/assets/js/421.d9d2dc13.js"><link rel="prefetch" href="/assets/js/422.093a8290.js"><link rel="prefetch" href="/assets/js/423.041fc7be.js"><link rel="prefetch" href="/assets/js/424.410b1a8f.js"><link rel="prefetch" href="/assets/js/425.661237bb.js"><link rel="prefetch" href="/assets/js/426.c01ca04f.js"><link rel="prefetch" href="/assets/js/427.af6802e0.js"><link rel="prefetch" href="/assets/js/428.e255a9c4.js"><link rel="prefetch" href="/assets/js/429.3f62c79c.js"><link rel="prefetch" href="/assets/js/43.96eb08e4.js"><link rel="prefetch" href="/assets/js/430.86f8cd5f.js"><link rel="prefetch" href="/assets/js/431.89f717cb.js"><link rel="prefetch" href="/assets/js/432.606f5381.js"><link rel="prefetch" href="/assets/js/433.e2a7c92d.js"><link rel="prefetch" href="/assets/js/434.375d2ee0.js"><link rel="prefetch" href="/assets/js/435.10ac30b9.js"><link rel="prefetch" href="/assets/js/436.dfadd161.js"><link rel="prefetch" href="/assets/js/437.f92a1705.js"><link rel="prefetch" href="/assets/js/438.a924c254.js"><link rel="prefetch" href="/assets/js/439.6a8f7f89.js"><link rel="prefetch" href="/assets/js/44.af0f503b.js"><link rel="prefetch" href="/assets/js/440.6f41f087.js"><link rel="prefetch" href="/assets/js/441.296b6711.js"><link rel="prefetch" href="/assets/js/442.e82e2313.js"><link rel="prefetch" href="/assets/js/443.c46b8b7c.js"><link rel="prefetch" href="/assets/js/444.850b3f10.js"><link rel="prefetch" href="/assets/js/445.70fafa08.js"><link rel="prefetch" href="/assets/js/446.c2fd23e4.js"><link rel="prefetch" href="/assets/js/447.fac66885.js"><link rel="prefetch" href="/assets/js/448.5c8074d5.js"><link rel="prefetch" href="/assets/js/449.25db27ca.js"><link rel="prefetch" href="/assets/js/45.19ecb85c.js"><link rel="prefetch" href="/assets/js/450.8bc58614.js"><link rel="prefetch" href="/assets/js/451.69e35a33.js"><link rel="prefetch" href="/assets/js/452.a129daf9.js"><link rel="prefetch" href="/assets/js/453.4f696672.js"><link rel="prefetch" href="/assets/js/454.e2a1b328.js"><link rel="prefetch" href="/assets/js/455.b7037708.js"><link rel="prefetch" href="/assets/js/456.eda2adc0.js"><link rel="prefetch" href="/assets/js/457.5f0d7722.js"><link rel="prefetch" href="/assets/js/458.effcb970.js"><link rel="prefetch" href="/assets/js/459.48baddfb.js"><link rel="prefetch" href="/assets/js/46.88cbca22.js"><link rel="prefetch" href="/assets/js/460.c50fe2c5.js"><link rel="prefetch" href="/assets/js/461.55293f7a.js"><link rel="prefetch" href="/assets/js/462.682315f0.js"><link rel="prefetch" href="/assets/js/463.f4278aae.js"><link rel="prefetch" href="/assets/js/464.f140b938.js"><link rel="prefetch" href="/assets/js/465.392a08f4.js"><link rel="prefetch" href="/assets/js/466.90a32c46.js"><link rel="prefetch" href="/assets/js/467.d795bc61.js"><link rel="prefetch" href="/assets/js/468.6e663011.js"><link rel="prefetch" href="/assets/js/469.b7bffde5.js"><link rel="prefetch" href="/assets/js/47.7e31de19.js"><link rel="prefetch" href="/assets/js/470.388beea3.js"><link rel="prefetch" href="/assets/js/471.6ca5dbe5.js"><link rel="prefetch" href="/assets/js/472.9bc4c0a6.js"><link rel="prefetch" href="/assets/js/473.fd427e29.js"><link rel="prefetch" href="/assets/js/474.862fc10a.js"><link rel="prefetch" href="/assets/js/475.6e3893de.js"><link rel="prefetch" href="/assets/js/476.0f32dc93.js"><link rel="prefetch" href="/assets/js/477.8cb145a5.js"><link rel="prefetch" href="/assets/js/478.65a09f13.js"><link rel="prefetch" href="/assets/js/479.bee3f754.js"><link rel="prefetch" href="/assets/js/48.ca956f8d.js"><link rel="prefetch" href="/assets/js/480.f59f88af.js"><link rel="prefetch" href="/assets/js/481.8c5e02e6.js"><link rel="prefetch" href="/assets/js/482.7988ca13.js"><link rel="prefetch" href="/assets/js/483.6d1e171c.js"><link rel="prefetch" href="/assets/js/484.b3f3a54b.js"><link rel="prefetch" href="/assets/js/485.e97a72d8.js"><link rel="prefetch" href="/assets/js/49.4cf4b45c.js"><link rel="prefetch" href="/assets/js/50.9fdb4f1e.js"><link rel="prefetch" href="/assets/js/51.88f75159.js"><link rel="prefetch" href="/assets/js/52.1c372af0.js"><link rel="prefetch" href="/assets/js/53.e0e13d9a.js"><link rel="prefetch" href="/assets/js/54.231f6505.js"><link rel="prefetch" href="/assets/js/55.52b04941.js"><link rel="prefetch" href="/assets/js/56.91345e86.js"><link rel="prefetch" href="/assets/js/57.201a710e.js"><link rel="prefetch" href="/assets/js/58.6fb2ccb6.js"><link rel="prefetch" href="/assets/js/60.a5fc202b.js"><link rel="prefetch" href="/assets/js/61.0facb3f9.js"><link rel="prefetch" href="/assets/js/62.d00be571.js"><link rel="prefetch" href="/assets/js/63.d66d194b.js"><link rel="prefetch" href="/assets/js/64.4b34837d.js"><link rel="prefetch" href="/assets/js/65.c5eca227.js"><link rel="prefetch" href="/assets/js/66.f3bb4baa.js"><link rel="prefetch" href="/assets/js/67.4fbce724.js"><link rel="prefetch" href="/assets/js/68.39780014.js"><link rel="prefetch" href="/assets/js/69.523952df.js"><link rel="prefetch" href="/assets/js/7.d893eec0.js"><link rel="prefetch" href="/assets/js/70.33f89cfa.js"><link rel="prefetch" href="/assets/js/71.6b329e8e.js"><link rel="prefetch" href="/assets/js/72.90caac3a.js"><link rel="prefetch" href="/assets/js/73.2b7012a1.js"><link rel="prefetch" href="/assets/js/74.0076f1ec.js"><link rel="prefetch" href="/assets/js/75.1cbaf5cf.js"><link rel="prefetch" href="/assets/js/76.2461a9e9.js"><link rel="prefetch" href="/assets/js/77.be9e1732.js"><link rel="prefetch" href="/assets/js/78.a4825263.js"><link rel="prefetch" href="/assets/js/79.95c5e105.js"><link rel="prefetch" href="/assets/js/8.acf971e3.js"><link rel="prefetch" href="/assets/js/80.1a7c44e2.js"><link rel="prefetch" href="/assets/js/81.38ee2ba4.js"><link rel="prefetch" href="/assets/js/82.78220668.js"><link rel="prefetch" href="/assets/js/83.3dfead3b.js"><link rel="prefetch" href="/assets/js/84.7f1f743d.js"><link rel="prefetch" href="/assets/js/85.ab59a697.js"><link rel="prefetch" href="/assets/js/86.1888a97f.js"><link rel="prefetch" href="/assets/js/87.149a705f.js"><link rel="prefetch" href="/assets/js/88.8a53e92d.js"><link rel="prefetch" href="/assets/js/89.a68dd87b.js"><link rel="prefetch" href="/assets/js/9.c38b654d.js"><link rel="prefetch" href="/assets/js/90.c70af23c.js"><link rel="prefetch" href="/assets/js/91.58de9211.js"><link rel="prefetch" href="/assets/js/92.697a7ada.js"><link rel="prefetch" href="/assets/js/93.2a27830a.js"><link rel="prefetch" href="/assets/js/94.20be84f6.js"><link rel="prefetch" href="/assets/js/95.bc2120e0.js"><link rel="prefetch" href="/assets/js/96.5b3aa395.js"><link rel="prefetch" href="/assets/js/97.c4a15008.js"><link rel="prefetch" href="/assets/js/98.3e47fdce.js"><link rel="prefetch" href="/assets/js/99.4b101d54.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b8eeafc3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Cactusli blog" class="logo"> <span class="site-name can-hide">Cactusli blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/Java/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java Study</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/Java/" class="nav-link">Java 基础</a></li><li class="dropdown-subitem"><a href="/note/design-pattern/" class="nav-link">Java 版设计模式</a></li></ul></li><li class="dropdown-item"><h4>阅读源码系列</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/32e50d/" class="nav-link">Spring Boot</a></li><li class="dropdown-subitem"><a href="/pages/d065c4/" class="nav-link">Netty</a></li><li class="dropdown-subitem"><a href="/pages/4d3c7f/" class="nav-link">Dubbo</a></li><li class="dropdown-subitem"><a href="/pages/920e2b/" class="nav-link">搭建rpc框架</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/SpringBoot/" class="nav-link">《SpringBoot教程》</a></li><li class="dropdown-subitem"><a href="/note/Docker/" class="nav-link">《Docker教程》</a></li><li class="dropdown-subitem"><a href="/note/Kubernetes/" class="nav-link">《Kubernetes教程》</a></li><li class="dropdown-subitem"><a href="/note/SpringCloud-febs/" class="nav-link">《SpringCloud微服务权限系统搭建》</a></li><li class="dropdown-subitem"><a href="/note/Netty/" class="nav-link">《Netty教程》</a></li><li class="dropdown-subitem"><a href="/note/Gateway/" class="nav-link">《API网关设计与实践》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li><li class="dropdown-item"><h4>页面</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="手册" class="dropdown-title"><a href="/manual/" class="link-title">手册</a> <span class="title" style="display:none;">手册</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/d2639c/" class="nav-link">环境配置</a></li><li class="dropdown-item"><!----> <a href="/pages/39e2a1/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">手册记录</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://firework.cloudflaress.eu.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  看烟花
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/706328/" class="nav-link">英语学习</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/lixuanfengs/cactus-vuepress-sc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.statically.io/gh/lixuanfengs/blog-images/master/cactus-blogs/avatar3.gif"> <div class="blogger-info"><h3>Xuan Feng Li</h3> <span>学习老黄牛精神！</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/Java/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java Study</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/Java/" class="nav-link">Java 基础</a></li><li class="dropdown-subitem"><a href="/note/design-pattern/" class="nav-link">Java 版设计模式</a></li></ul></li><li class="dropdown-item"><h4>阅读源码系列</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/32e50d/" class="nav-link">Spring Boot</a></li><li class="dropdown-subitem"><a href="/pages/d065c4/" class="nav-link">Netty</a></li><li class="dropdown-subitem"><a href="/pages/4d3c7f/" class="nav-link">Dubbo</a></li><li class="dropdown-subitem"><a href="/pages/920e2b/" class="nav-link">搭建rpc框架</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/SpringBoot/" class="nav-link">《SpringBoot教程》</a></li><li class="dropdown-subitem"><a href="/note/Docker/" class="nav-link">《Docker教程》</a></li><li class="dropdown-subitem"><a href="/note/Kubernetes/" class="nav-link">《Kubernetes教程》</a></li><li class="dropdown-subitem"><a href="/note/SpringCloud-febs/" class="nav-link">《SpringCloud微服务权限系统搭建》</a></li><li class="dropdown-subitem"><a href="/note/Netty/" class="nav-link">《Netty教程》</a></li><li class="dropdown-subitem"><a href="/note/Gateway/" class="nav-link">《API网关设计与实践》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">《ES6 教程》</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">《Vue》</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">《React》</a></li><li class="dropdown-subitem"><a href="/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li><li class="dropdown-subitem"><a href="/pages/4643cd/" class="nav-link">JS设计模式总结</a></li></ul></li><li class="dropdown-item"><h4>页面</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="手册" class="dropdown-title"><a href="/manual/" class="link-title">手册</a> <span class="title" style="display:none;">手册</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/d2639c/" class="nav-link">环境配置</a></li><li class="dropdown-item"><!----> <a href="/pages/39e2a1/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e/" class="nav-link">手册记录</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/117708e0af7f0bd9/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://firework.cloudflaress.eu.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  看烟花
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/706328/" class="nav-link">英语学习</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/lixuanfengs/cactus-vuepress-sc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>开发环境配置</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/d2639c/" class="sidebar-link">负载均衡和web服务</a></li><li><a href="/pages/d9927e/" class="sidebar-link">keepalibved安装与使用</a></li><li><a href="/pages/4e44e7/" aria-current="page" class="active sidebar-link">redis安装部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/4e44e7/#redis学习" class="sidebar-link">redis学习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/4e44e7/#redis简介" class="sidebar-link">redis简介</a></li><li class="sidebar-sub-header level3"><a href="/pages/4e44e7/#redis对比memcached" class="sidebar-link">redis对比memcached</a></li><li class="sidebar-sub-header level3"><a href="/pages/4e44e7/#redis应用场景" class="sidebar-link">redis应用场景</a></li><li class="sidebar-sub-header level3"><a href="/pages/4e44e7/#redis安装" class="sidebar-link">redis安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#编译安装redis" class="sidebar-link">编译安装redis</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#前台启动redis" class="sidebar-link">前台启动redis</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#解决当前的警告提示" class="sidebar-link">解决当前的警告提示</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#编译安装后的命令" class="sidebar-link">编译安装后的命令</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#连接到redis" class="sidebar-link">连接到redis</a></li><li class="sidebar-sub-header level3"><a href="/pages/4e44e7/#redis配置文件" class="sidebar-link">redis配置文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#切换库插入值" class="sidebar-link">切换库插入值</a></li><li class="sidebar-sub-header level3"><a href="/pages/4e44e7/#redis持久化" class="sidebar-link">redis持久化</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#rdb模式" class="sidebar-link">RDB模式</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#优点" class="sidebar-link">优点</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#缺点" class="sidebar-link">缺点</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#aof模式" class="sidebar-link">AOF模式</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#aof优缺点" class="sidebar-link">AOF优缺点</a></li><li class="sidebar-sub-header level3"><a href="/pages/4e44e7/#数据类型" class="sidebar-link">数据类型</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#字符串-string" class="sidebar-link">字符串(string)</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#添加一个key" class="sidebar-link">添加一个key</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取一个key的内容" class="sidebar-link">获取一个key的内容</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#删除一个key" class="sidebar-link">删除一个key</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#批量设置多个key" class="sidebar-link">批量设置多个key</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#批量获取多个key" class="sidebar-link">批量获取多个key</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#追加数据" class="sidebar-link">追加数据</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#数值递增" class="sidebar-link">数值递增</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#数值递减" class="sidebar-link">数值递减</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#返回字符串key的长度" class="sidebar-link">返回字符串key的长度</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#判断key是否存在" class="sidebar-link">判断key是否存在</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#查看key的过期时间" class="sidebar-link">查看key的过期时间</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#设置key的过期时间" class="sidebar-link">设置key的过期时间</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#取消key的过期时间" class="sidebar-link">取消key的过期时间</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#列表-list" class="sidebar-link">列表(list)</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#生成列表并插入数据" class="sidebar-link">生成列表并插入数据</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#向列表追加数据" class="sidebar-link">向列表追加数据</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取列表的长度" class="sidebar-link">获取列表的长度</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取列表指定位置数据" class="sidebar-link">获取列表指定位置数据</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#移除列表数据" class="sidebar-link">移除列表数据</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#集合" class="sidebar-link">集合</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#生成集合" class="sidebar-link">生成集合</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#追加数据-2" class="sidebar-link">追加数据</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#查看集合所有数据" class="sidebar-link">查看集合所有数据</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取集合的差集" class="sidebar-link">获取集合的差集</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取集合的交集" class="sidebar-link">获取集合的交集</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取集合的并集" class="sidebar-link">获取集合的并集</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#有序集合" class="sidebar-link">有序集合</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#生成有序集合" class="sidebar-link">生成有序集合</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#集合排行案例" class="sidebar-link">集合排行案例</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取集合的长度数" class="sidebar-link">获取集合的长度数</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#基于索引返回数值" class="sidebar-link">基于索引返回数值</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#返回某个数值的索引" class="sidebar-link">返回某个数值的索引</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#哈希" class="sidebar-link">哈希</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#生成哈希" class="sidebar-link">生成哈希</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取哈希key的字段值" class="sidebar-link">获取哈希key的字段值</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#删除一个字段" class="sidebar-link">删除一个字段</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取所有key" class="sidebar-link">获取所有key</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#获取指定hash的所有key及value" class="sidebar-link">获取指定hash的所有key及value</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#redis主从同步" class="sidebar-link">redis主从同步</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#slave主要配置" class="sidebar-link">slave主要配置</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#开始配置" class="sidebar-link">开始配置</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#查看同步的日志" class="sidebar-link">查看同步的日志</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#测试是否能同步" class="sidebar-link">测试是否能同步</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#查看当前slave的状态" class="sidebar-link">查看当前slave的状态</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#保存配置到redis-conf" class="sidebar-link">保存配置到redis.conf</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#主从复制过程" class="sidebar-link">主从复制过程</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#一主两从" class="sidebar-link">一主两从</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#哨兵-sentinel" class="sidebar-link">哨兵 (Sentinel)</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#配置一个主从同步的环境" class="sidebar-link">配置一个主从同步的环境</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#配置哨兵" class="sidebar-link">配置哨兵</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#查看端口是否启动" class="sidebar-link">查看端口是否启动</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#查看哨兵日志" class="sidebar-link">查看哨兵日志</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#查看哨兵状态" class="sidebar-link">查看哨兵状态</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#停止redis-master测试故障转移" class="sidebar-link">停止Redis Master测试故障转移：</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#故障转移后的redis配置文件" class="sidebar-link">故障转移后的redis配置文件</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#查看现在的master情况" class="sidebar-link">查看现在的master情况</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#redis-cluster" class="sidebar-link">Redis Cluster</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#部署redis集群" class="sidebar-link">部署redis集群</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#准备工作" class="sidebar-link">准备工作</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#修改配置文件" class="sidebar-link">修改配置文件</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#创建集群" class="sidebar-link">创建集群</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#验证redis集群状态" class="sidebar-link">验证redis集群状态</a></li><li class="sidebar-sub-header level4"><a href="/pages/4e44e7/#redis-cluster集群节点维护" class="sidebar-link">Redis cluster集群节点维护</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#动态添加节点" class="sidebar-link">动态添加节点</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#更改新节点更改状态为slave" class="sidebar-link">更改新节点更改状态为slave</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#验证当前集群状态" class="sidebar-link">验证当前集群状态</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#重新分配槽位" class="sidebar-link">重新分配槽位</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#验证槽位是否分配成功" class="sidebar-link">验证槽位是否分配成功</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#删除节点" class="sidebar-link">删除节点</a></li><li class="sidebar-sub-header level5"><a href="/pages/4e44e7/#验证node是否删除" class="sidebar-link">验证node是否删除</a></li></ul></li></ul></li><li><a href="/pages/deb0c4/" class="sidebar-link">zookeeper-centos7安装使用</a></li><li><a href="/pages/d2862a/" class="sidebar-link">RabbitMQ学习</a></li><li><a href="/pages/7d1629/" class="sidebar-link">KeepAlived搭建MySQL双主</a></li><li><a href="/pages/75b405/" class="sidebar-link">sql语句的学习</a></li><li><a href="/pages/32abc1/" class="sidebar-link">MySQL8.0主从配置</a></li><li><a href="/pages/95874c/" class="sidebar-link">K8S基础入门</a></li><li><a href="/pages/10a196/" class="sidebar-link">k8s基础命令</a></li><li><a href="/pages/680317/" class="sidebar-link">Kubeadm安装k8s集群</a></li><li><a href="/pages/e6e664/" class="sidebar-link">二进制高可用安装k8集群</a></li><li><a href="/pages/cf68cc/" class="sidebar-link">rancher搭建k8s 集群</a></li><li><a href="/pages/93c7a0/" class="sidebar-link">Oracle 12c安装</a></li><li><a href="/pages/6d00ed/" class="sidebar-link">Jenkins+gitlab持续集成学习</a></li><li><a href="/pages/528e32/" class="sidebar-link">CloudFlare Argo Tunnel免费内网穿透</a></li><li><a href="/pages/8ff689/" class="sidebar-link">Linux使用WireGuard来创建内网</a></li><li><a href="/pages/830e28/" class="sidebar-link">利用Cloudflare Zero Trust创建大内网</a></li><li><a href="/pages/a51cd8/" class="sidebar-link">Docker 相关的 Shell</a></li><li><a href="/pages/c7703f/" class="sidebar-link">VM虚拟机Ubuntu 20.04 LVM磁盘扩容</a></li><li><a href="/pages/118ac7/" class="sidebar-link">深圳仪器平台-开发手册记录</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GitHub技巧</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>博客搭建</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手册记录</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/manual/#手册" data-v-06225672>手册</a></li><li data-v-06225672><a href="/manual/#开发环境配置" data-v-06225672>开发环境配置</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/lixuanfengs" target="_blank" title="作者" class="beLink" data-v-06225672>cactusli</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-07-20</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><!---->redis安装部署<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="redis学习"><a href="#redis学习" class="header-anchor">#</a> redis学习</h2> <h3 id="redis简介"><a href="#redis简介" class="header-anchor">#</a> redis简介</h3> <p>redis是一个开源的、遵循BSD协议的、基于内存的而且目前比较流行的键值数据库(key-value database)，是一个非关系型数据库，redis提供将内存通过网络远程共享的一种服务，提供类似功能的还有memcache，但相比memcache，redis还提供了易扩展、高性能、具备数据持久性等功能。</p> <h3 id="redis对比memcached"><a href="#redis对比memcached" class="header-anchor">#</a> redis对比memcached</h3> <p>支持数据的持久化,可以将内存中的数据保持在磁盘中,重启redis服务或者服务器之后可以从备份文件中恢复数据到内存继续使用</p> <p>1、支持更多的数据类型:支持string(字符串)、hash(哈希数据)、list(列表)、set(集合)、zet(有序集合)
2、支持数据的备份:可以实现类似于数据的master-slave模式的数据备份,另外也支持使用快照+AOF
3、支持更大的value数据:memcache单个key value只支持1MB,而redis最大支持512MB
4、redis是单线程,而memcache是多线程,所以单机情况下没有memcache并发高,但redis支持分布式集群以实现更高的并发,单redis实例可以实现数万并发
5、支持集群横向扩展:基于redis cluster的横向扩展,可以实现分布式集群,大幅提升性能和数据安全性</p> <h3 id="redis应用场景"><a href="#redis应用场景" class="header-anchor">#</a> redis应用场景</h3> <p>1、session共享:常见于web集群中的tomcat或者php中多web服务器session共享
2、消息队列:ELK的日志缓存、部分业务的订阅发布系统
3、计数器:访问排行榜、商品浏览数等和次数相关的数值统计场景
4、缓存:数据库查询缓存、电商网站商品信息、新闻内容
5、微博/微信交场合:共同好友、点赞评论等</p> <h3 id="redis安装"><a href="#redis安装" class="header-anchor">#</a> redis安装</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:~<span class="token comment"># apt install redis</span>
<span class="token comment"># 启动redis</span>
root@ubuntu2:~<span class="token comment"># systemctl restart redis</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查看redis端口</span>
root@ubuntu2:~<span class="token comment"># ss -ntl</span>
LISTEN     <span class="token number">0</span>           <span class="token number">128</span>                            <span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:6379                   <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 测试redis登录</span>
root@ubuntu2:~<span class="token comment"># redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="编译安装redis"><a href="#编译安装redis" class="header-anchor">#</a> 编译安装redis</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 下载地址</span>
http://download.redis.io/releases/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 开始下载redis </span>
root@ubuntu2:/usr/local/src<span class="token comment"># wget http://download.redis.io/releases/redis-4.0.14.tar.gz</span>
root@ubuntu2:/usr/local/src<span class="token comment"># tar xf redis-4.0.14.tar.gz</span>
<span class="token comment"># 指定redis安装目录</span>
root@ubuntu2:/usr/local/src/redis-4.0.14<span class="token comment"># make PREFIX=/apps/redis install</span>
<span class="token comment"># 验证是否编译成功</span>
root@ubuntu2:/usr/local/src/redis-4.0.14<span class="token comment"># ll /apps/redis/bin/</span>
total <span class="token number">24440</span>
-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">2789960</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-benchmark*
-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">6404792</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-check-aof*
-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">6404792</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-check-rdb*
-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">3004368</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-cli*
lrwxrwxrwx <span class="token number">1</span> root root      <span class="token number">12</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-sentinel -<span class="token operator">&gt;</span> redis-server*
-rwxr-xr-x <span class="token number">1</span> root root <span class="token number">6404792</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-server*
<span class="token comment"># 创建配置文件、日志、数据等目录</span>
root@ubuntu2:/usr/local/src/redis-4.0.14<span class="token comment">#  mkdir /apps/redis/{etc,logs,data,run}</span>
root@ubuntu2:/usr/local/src/redis-4.0.14<span class="token comment"># cp redis.conf   /apps/redis/etc/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="前台启动redis"><a href="#前台启动redis" class="header-anchor">#</a> 前台启动redis</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:/usr/local/src/redis-4.0.14<span class="token comment"># /apps/redis/bin/redis-server /apps/redis/etc/redis.conf</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查看端口是否启动</span>
root@ubuntu2:/usr/local/src/redis-4.0.14<span class="token comment"># ss -ntl</span>
LISTEN     <span class="token number">0</span>           <span class="token number">128</span>                            <span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:6379                   <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="解决当前的警告提示"><a href="#解决当前的警告提示" class="header-anchor">#</a> 解决当前的警告提示</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">46284</span>:C <span class="token number">16</span> Nov <span class="token number">14</span>:56:07.586 <span class="token comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
<span class="token number">46284</span>:C <span class="token number">16</span> Nov <span class="token number">14</span>:56:07.586 <span class="token comment"># Redis version=4.0.14, bits=64, commit=00000000, modified=0, pid=46284, just started</span>
<span class="token number">46284</span>:C <span class="token number">16</span> Nov <span class="token number">14</span>:56:07.586 <span class="token comment"># Configuration loaded</span>
<span class="token number">46284</span>:M <span class="token number">16</span> Nov <span class="token number">14</span>:56:07.588 * Increased maximum number of <span class="token function">open</span> files to <span class="token number">10032</span> <span class="token punctuation">(</span>it was originally <span class="token builtin class-name">set</span> to <span class="token number">1024</span><span class="token punctuation">)</span>.
<span class="token number">46284</span>:M <span class="token number">16</span> Nov <span class="token number">14</span>:56:07.588 <span class="token comment"># Creating Server TCP listening socket 127.0.0.1:6379: bind: Address already in use</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>backlog参数控制的是三次握手的时候server端收到client ack确认号之后的队列值</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:~<span class="token comment"># vim /etc/sysctl.conf</span>
net.core.somaxconn <span class="token operator">=</span> <span class="token number">512</span>
<span class="token comment"># 使其队列生效</span>
root@ubuntu2:~<span class="token comment"># sysctl -p</span>
net.core.somaxconn <span class="token operator">=</span> <span class="token number">512</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>vm.overcommit_memory</strong></p> <p>0、表示内核将检查是否有足够的可用内存供应用进程使用；如果有足够的可用内存，内存申请允许；否则，内存申请失败，并把错误返回给应用进程。</p> <p>1、表示内核允许分配所有的物理内存，而不管当前的内存状态如何。</p> <p>2、表示内核允许分配超过所有物理内存和交换空间总和的内存</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:/apps/redis/bin<span class="token comment"># vim /etc/sysctl.conf</span>
vm.overcommit_memory <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>transparent hugepage</strong></p> <p>大页内存动态分配，需要关闭让redis 负责内存管理·</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:/apps/redis/bin<span class="token comment"># echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="编译安装后的命令"><a href="#编译安装后的命令" class="header-anchor">#</a> 编译安装后的命令</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:~<span class="token comment"># ll /apps/redis/bin/</span>
total <span class="token number">24440</span>
-rwxr-xr-x <span class="token number">1</span> redis redis <span class="token number">2789960</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-benchmark*   <span class="token comment">#redis性能测试工具</span>
-rwxr-xr-x <span class="token number">1</span> redis redis <span class="token number">6404792</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-check-aof*   <span class="token comment">#AOF文件检查工具</span>
-rwxr-xr-x <span class="token number">1</span> redis redis <span class="token number">6404792</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-check-rdb*   <span class="token comment">#RDB文件检查工具</span>
-rwxr-xr-x <span class="token number">1</span> redis redis <span class="token number">3004368</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-cli*   <span class="token comment">#客户端工具</span>
lrwxrwxrwx <span class="token number">1</span> redis redis      <span class="token number">12</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-sentinel -<span class="token operator">&gt;</span> redis-server*  <span class="token comment">#哨兵，软连 接到server</span>
-rwxr-xr-x <span class="token number">1</span> redis redis <span class="token number">6404792</span> Nov <span class="token number">16</span> <span class="token number">14</span>:47 redis-server*  <span class="token comment">#服务启动命令</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="连接到redis"><a href="#连接到redis" class="header-anchor">#</a> 连接到redis</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:/apps/redis/bin<span class="token comment"># vim /apps/redis/etc/redis.conf</span>
<span class="token comment"># 修改监听地址</span>
<span class="token builtin class-name">bind</span> <span class="token number">0.0</span>.0.0
<span class="token comment"># 让redis在后台启动</span>
daemonize <span class="token function">yes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 跨主机连接</span>
root@W203-10-2-32-103:/home/snkj<span class="token comment"># redis-cli  -h 10.2.32.11  -p 6379</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#  设置redis密码</span>
root@ubuntu2:/apps/redis/bin<span class="token comment"># vim /apps/redis/etc/redis.conf</span>
requirepass linux39 <span class="token comment">#密码</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#客户端连接带密码的</span>
root@W203-10-2-32-103:/home/snkj<span class="token comment"># redis-cli  -h 10.2.32.11  -p 6379</span>
<span class="token number">10.2</span>.32.11:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> info
NOAUTH Authentication required.
<span class="token number">10.2</span>.32.11:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> AUTH linux39   <span class="token comment">#密码</span>
OK
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># shell脚本写入数据到Redis</span>
root@W203-10-2-32-103:/home/snkj<span class="token comment"># cat redis_write-linux38.sh</span>
<span class="token comment">#!/bin/bash</span>
<span class="token assign-left variable">NUM</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">seq</span> <span class="token number">1</span>  <span class="token number">1000</span><span class="token variable">`</span></span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">${NUM}</span><span class="token punctuation">;</span><span class="token keyword">do</span>
  redis-cli  <span class="token parameter variable">-h</span> <span class="token number">10.2</span>.32.11 <span class="token parameter variable">-p</span> <span class="token number">6379</span> <span class="token parameter variable">-a</span> linux39 <span class="token builtin class-name">set</span> key-<span class="token variable">${i}</span> value-<span class="token variable">${i}</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;key-<span class="token variable">${i}</span> value-<span class="token variable">${i}</span> 写入完成&quot;</span>
<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;十万个key写入到Redis完成&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查询数据是否写入成功</span>
root@ubuntu2:/apps/redis/bin<span class="token comment"># ./redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> AUTH linux39
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> KEYS *
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get key-1427  <span class="token comment">#查看key值</span>
<span class="token string">&quot;value-1427&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 设置软链接 </span>
root@ubuntu2:~<span class="token comment"># ln -sv /apps/redis/bin/redis-*  /usr/local/bin/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="redis配置文件"><a href="#redis配置文件" class="header-anchor">#</a> redis配置文件</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:~<span class="token comment"># vim /apps/redis/etc/redis.conf</span>
<span class="token builtin class-name">bind</span> <span class="token number">0.0</span>.0.0 <span class="token comment">#监听地址，可以用空格隔开后多个监听IP</span>
protected-mode <span class="token function">yes</span> <span class="token comment">#redis3.2 之后加入的新特性，在没有设置bind IP和密码的时候,redis只允许访问</span>
<span class="token comment"># 127.0.0.1:6379，远程访问将提示警告信息并拒绝远程访问</span>
port <span class="token number">6379</span> <span class="token comment">#监听端口</span>
tcp-backlog <span class="token number">511</span> <span class="token comment">#三次握手的时候server端收到client ack确认号之后的队列值。</span>
<span class="token function">timeout</span> <span class="token number">0</span> <span class="token comment">#客户端和Redis服务端的连接超时时间，默认是0，表示永不超时。</span>
tcp-keepalive <span class="token number">300</span> <span class="token comment">#tcp 会话保持时间</span>
daemonize n <span class="token comment">#认情况下 redis 不是作为守护进程运行的，如果你想让它在后台运行，你就把它改成 yes,当redis作</span>
<span class="token comment"># 为守护进程运行的时候，它会写一个 pid 到 /var/run/redis.pid 文件里面</span>
supervised no <span class="token comment">#和操作系统相关参数，可以设置通过upstart和systemd管理Redis守护进程，centos 7以后都使用</span>
systemd
pidfile /var/run/redis_6379.pid <span class="token comment">#pid文件路径</span>
loglevel notice <span class="token comment">#日志级别</span>
logfile <span class="token string">&quot;&quot;</span> <span class="token comment">#日志路径</span>
databases <span class="token number">16</span> <span class="token comment">#设置db 库数量，默认16个库</span>
always-show-logo <span class="token function">yes</span> <span class="token comment">#在启动redis 时是否显示log</span>
<span class="token comment"># 快照配置</span>
save <span class="token number">900</span> <span class="token number">1</span> <span class="token comment">#在900秒内有一个键内容发生更改就出就快照机制</span>
save <span class="token number">300</span> <span class="token number">10</span>  
save <span class="token number">60</span> <span class="token number">10000</span>
stop-writes-on-bgsave-error no <span class="token comment">#快照出错时是否禁止redis 写入操作</span>
rdbcompression <span class="token function">yes</span> <span class="token comment">#持久化到RDB文件时，是否压缩，&quot;yes&quot;为压缩，&quot;no&quot;则反之</span>
rdbchecksum <span class="token function">yes</span> <span class="token comment">#是否开启RC64校验，默认是开启</span>
dbfilename dump.rdb <span class="token comment">#快照文件名</span>
<span class="token function">dir</span> /apps/redis/data <span class="token comment">#快照文件保存路径</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>replica-serve-stale-data <span class="token function">yes</span> <span class="token comment">#当从库同主库失去连接或者复制正在进行，从机库有两种运行方式：</span>
<span class="token number">1</span>、如果replica-serve-stale-data设置为yes<span class="token punctuation">(</span>默认设置<span class="token punctuation">)</span>，从库会继续响应客户端的读请求。
<span class="token number">2</span>、如果replica-serve-stale-data设置为no，除去指定的命令之外的任何请求都会返回一个错误<span class="token string">&quot;SYNC with
master in progress&quot;</span>
replica-read-only <span class="token function">yes</span> <span class="token comment">#是否设置从库只读</span>
repl-diskless-sync no <span class="token comment">#是否使用socket方式复制数据(无盘同步)，新slave连接连接时候需要做数据的全量同步</span>
redis server就要从内存dump出新的RDB文件，然后从master传到slave，有两种方式把RDB文件传输给客户端：
<span class="token number">1</span>、基于硬盘（disk-backed）：master创建一个新进程dump RDB，RDB完成之后由父进程（即主进程）传给
slaves。
<span class="token number">2</span>、基于socket（diskless）：master创建一个新进程直接dump RDB到slave的socket，不经过主进程，不经过硬
盘。
基于硬盘的话，RDB文件创建后，一旦创建完毕，可以同时服务更多的slave，但是基于socket的话， 新slave连接
到master之后得逐个同步数据。
在较慢并且网络较快的时候，可以用diskless<span class="token punctuation">(</span>yes<span class="token punctuation">)</span>-<span class="token operator">&gt;</span>磁盘很慢的时候,不通过磁盘传,否则使用磁盘<span class="token punctuation">(</span>no<span class="token punctuation">)</span>-<span class="token operator">&gt;</span>磁盘很快的时候设置no,通过磁盘传
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>repl-diskless-sync-delay <span class="token number">30</span> <span class="token comment">#diskless**复制的延迟时间**，设置0为关闭，在延迟时间内连接的新客户端，会一起通过disk方式同步数据，但是一旦复制开始还没有结束之前，master节点不会再接收新slave的复制请求，直到下一次同步开始。</span>
repl-ping-slave-period <span class="token number">10</span> <span class="token comment">#slave根据master指定的时间进行周期性的PING 监测</span>
repl-timeout <span class="token number">60</span> <span class="token comment">#复制连接的超时时间，需要大于repl-ping-slave-period，否则会经常报超时</span>
repl-disable-tcp-nodelay no <span class="token comment">#在socket模式下是否在slave套接字发送SYNC之后禁用 TCP_NODELAY，</span>
如果选择“yesRedis将使用更少的TCP包和带宽来向slaves发送数据，但是这将使数据传输到slave上有延迟，Linux
内核的默认配置会达到40毫秒，如果你选择了 <span class="token string">&quot;no&quot;</span>** 数据传输到salve**的延迟将会减少但要使用更多的带宽。
repl-backlog-size 512mb <span class="token comment">#复制缓冲区内存大小，只有在slave连接之后才分配内存。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>repl-backlog-ttl <span class="token number">3600</span> <span class="token comment">#多次时间master没有slave连接，就清空backlog缓冲区。</span>
replica-priority <span class="token number">100</span> <span class="token comment">#当master不可用，Sentinel会根据slave的优先级选举一个master，最低的优先级的slave，当选master，而配置成0，永远不会被选举。</span>
requirepass foobared <span class="token comment">#设置redis 连接密码</span>
rename-command <span class="token comment">#重命名一些高危命令</span>
maxclients <span class="token number">10000</span> <span class="token comment">#Redis最大连接客户端</span>
maxmemory <span class="token comment">#最大内存，单位为bytes字节，8G内存的计算方式8(G)1024(MB)1024(KB)*1024(Kbyte)，需要注意</span>
的是slave的输出缓冲区是不计算在maxmemory内
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>appendonly no <span class="token comment">#是否开启AOF日志记录，默认redis使用的是rdb方式持久化，这种方式在许多应用中已经足够用</span>
了，但是redis如果中途宕机，会导致可能有几分钟的数据丢失<span class="token punctuation">(</span>取决于dumpd数据的间隔时间<span class="token punctuation">)</span>，根据save来策略
进行持久化，Append Only File是另一种持久化方式，可以提供更好的持久化特性，Redis会把每次写入的数据在
接收后都写入 appendonly.aof 文件，每次启动时Redis都会先把这个文件的数据读入内存里，先忽略RDB文件。
appendfilename <span class="token string">&quot;appendonly.aof&quot;</span> <span class="token comment">#AOF文件名</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>appendfsync everysec <span class="token comment">#aof持久化策略的配置,no表示不执行fsync，由操作系统保证数据同步到磁盘,always表示</span>
每次写入都执行fsync，以保证数据同步到磁盘,everysec表示每秒执行一次fsync，可能会导致丢失这1s数据。
no-appendfsync-on-rewrite no在aof rewrite期间,是否对aof新记录的append暂缓使用文件同步策略,主要考虑磁盘IO开支和请求阻塞时间。默认为no,表示<span class="token string">&quot;不暂缓&quot;</span>,新的aof记录仍然会被立即同步，Linux的默认fsync策略是30
秒，如果为yes 可能丢失30秒数据，但由于yes性能较好而且会避免出现阻塞因此比较推荐
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>auto-aof-rewrite-percentage <span class="token number">100</span> <span class="token comment"># 当Aof log增长超过指定百分比例时，重写AOF文件， 设置为0表示不自动重</span>
写Aof 日志，重写是为了使aof体积保持最小，但是还可以确保保存最完整的数据，
auto-aof-rewrite-min-size 64mb <span class="token comment">#触发aof rewrite的最小文件大小</span>
aof-load-truncated <span class="token function">yes</span> <span class="token comment">#是否加载由于其他原因导致的末尾异常的AOF文件(主进程被kill/断电等)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>aof-use-rdb-preamble no <span class="token comment">#redis4.0新增RDB-AOF混合持久化格式，在开启了这个功能之后，AOF重写产生的文</span>
件将同时包含RDB格式的内容和AOF格式的内容，其中RDB格式的内容用于记录已有的数据，而AOF格式的内存则
用于记录最近发生了变化的数据，这样Redis就可以同时兼有RDB持久化和AOF持久化的优点（既能够快速地生成
重写文件，也能够在出现问题时，快速地载入数据）。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>lua-time-limit <span class="token number">5000</span> <span class="token comment">#lua脚本的最大执行时间，单位为毫秒</span>
cluster-enabled <span class="token function">yes</span> <span class="token comment">#是否开启集群模式，默认是单机模式</span>
cluster-config-file nodes-6379.conf <span class="token comment">#由node节点自动生成的集群配置文件</span>
cluster-node-timeout <span class="token number">15000</span> <span class="token comment">#集群中node节点连接超时时间</span>
cluster-replica-validity-factor <span class="token number">10</span> <span class="token comment">#在执行故障转移的时候可能有些节点和master断开一段时间数据比较旧，这些节点就不适用于选举为master，超过这个时间的就不会被进行故障转移</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>cluster-migration-barrier <span class="token number">1</span> <span class="token comment">#集群迁移屏障，一个主节点拥有的至少正常工作的从节点，即如果主节点的slave节</span>
点故障后会将多余的从节点分配到当前主节点成为其新的从节点。
cluster-require-full-coverage no <span class="token comment">#集群请求槽位全部覆盖，如果一个主库宕机且没有备库就会出现集群槽位不</span>
全，那么yes情况下redis集群槽位验证不全就不再对外提供服务，而no则可以继续使用但是会出现查询数据查不到
的情况<span class="token punctuation">(</span>因为有数据丢失<span class="token punctuation">)</span>。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#Slow log 是 Redis 用来记录查询执行时间的日志系统，slow log 保存在内存里面，读写速度非常快，因此你可以</span>
放心地使用它，不必担心因为开启 slow log 而损害 Redis 的速度。
slowlog-log-slower-than <span class="token number">10000</span> <span class="token comment">#以微秒为单位的慢日志记录，为负数会禁用慢日志，为0会记录每个命令操作</span>
slowlog-max-len <span class="token number">128</span> <span class="token comment">#记录多少条慢日志保存在队列，超出后会删除最早的，以此滚动删除</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="切换库插入值"><a href="#切换库插入值" class="header-anchor">#</a> 切换库插入值</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 插入值的脚本</span>
root@ubuntu2:~<span class="token comment"># cat ss.py</span>
<span class="token comment">#!/bin/env python</span>
<span class="token comment">#Author: ZhangJie import redis import time</span>
<span class="token function">import</span> redis
<span class="token function">import</span> <span class="token function">time</span>
pool <span class="token operator">=</span> redis.ConnectionPool<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">&quot;10.2.32.11&quot;</span>, <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">6379</span>,password<span class="token operator">=</span><span class="token string">&quot;linux39&quot;</span>,db<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> redis.Redis<span class="token punctuation">(</span>connection_pool<span class="token operator">=</span>pool<span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>:
    r.set<span class="token punctuation">(</span><span class="token string">&quot;k%d&quot;</span> % i,<span class="token string">&quot;v%d&quot;</span> % i<span class="token punctuation">)</span>
    time.sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">data</span><span class="token operator">=</span>r.get<span class="token punctuation">(</span><span class="token string">&quot;k%d&quot;</span> % i<span class="token punctuation">)</span>
    print<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:~<span class="token comment"># redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> AUTH linux39
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SELECT <span class="token number">2</span>  <span class="token comment">#切换库</span>
OK
<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> KEYS *
  <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;k97&quot;</span>
  <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;k90&quot;</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span>.省略<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="redis持久化"><a href="#redis持久化" class="header-anchor">#</a> redis持久化</h3> <p>Redis 虽然是一个内存级别的缓存程序，也就是redis 是使用内存进行数据的缓存的，但是其可以将内存的数据按照一定的策略保存到硬盘上，从而实现数据持久保存的目的，目前redis支持两种不同方式的数据持久化保存机制，分别是RDB和AOF</p> <h4 id="rdb模式"><a href="#rdb模式" class="header-anchor">#</a> RDB模式</h4> <p>RDB(<em>Redis</em> DataBase)：基于时间的快照，其默认只保留当前最新的一次快照，特点是执行速度比较快，缺点是可能会丢失从上次快照到当前时间点之间未做快照的数据。</p> <p>RDB实现的具体过程Redis从主进程先fork出一个子进程，使用写时复制机制，子进程将内存的数据保存为一个临时文件，比如dump.rdb.temp，当数据保存完成之后再将上一次保存的RDB文件替换掉，然后关闭子进程，这样可以保存每一次做RDB快照的时候保存的数据都是完整的，因为直接替换RDB文件的时候可能会出现突然断电等问题而导致RDB文件还没有保存完整就突然关机停止保存而导致数据丢失的情况，可以手动将每次生成的RDB文件进程备份，这样可以最大化保存历史数据。</p> <h5 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h5> <p>RDB快照保存了某个时间点的数据，可以通过脚本执行bgsave(非阻塞)或者save(阻塞)命令自定义时间点备份，可以保留多个备份，当出现问题可以恢复到不同时间点的版本。</p> <p>可以最大化IO 的性能，因为父进程在保存RDB 文件的时候唯一要做的是fork出一个子进程，然后的-操作都会有这个子进程操作，父进程无需任何的IO操作</p> <p>RDB在大量数据比如几个G的数据，恢复的速度比AOF的快</p> <h5 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点</h5> <p>不能时时的保存数据，会丢失自上一次执行RDB备份到当前的内存数据</p> <p>数据量非常大的时候，从父进程fork的时候需要一点时间，可能是毫秒或者秒或者分钟，取决于磁盘IO性能。</p> <h4 id="aof模式"><a href="#aof模式" class="header-anchor">#</a> AOF模式</h4> <p>按照操作顺序依次将操作添加到指定的日志文件当中，特点是数据安全性相对较高，缺点是即使有些操作是重复的也会全部记录</p> <p>AOF和RDB一样使用了写时复制机制，AOF默认为每秒钟fsync一次，即将执行的命令保存到AOF文件当中，这样即使redis服务器发生故障的话顶多也就丢失1秒钟之内的数据，也可以设置不同的fsync策略，或者设置每次执行命令的时候执行fsync，fsync会在后台执行线程，所以主线程可以继续处理用户的正常请求而不受到写入AOF文件的IO影响。</p> <h4 id="aof优缺点"><a href="#aof优缺点" class="header-anchor">#</a> AOF优缺点</h4> <p>AOF的文件大小要大于RDB格式的文件</p> <p>根据所使用的fsync策略(fsync是同步内存中redis所有已经修改的文件到存储设备)，默认是appendfsync everysec即每秒执行一次fsync。</p> <h3 id="数据类型"><a href="#数据类型" class="header-anchor">#</a> 数据类型</h3> <h4 id="字符串-string"><a href="#字符串-string" class="header-anchor">#</a> 字符串(string)</h4> <p>字符串是所有编程语言中最常见的和最常用的数据类型，而且也是redis最基本的数据类型之一，而且redis中所有的key的类型都是字符串</p> <h5 id="添加一个key"><a href="#添加一个key" class="header-anchor">#</a> 添加一个key</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SET  name linux39
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> KEYS *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> TYPE name
string
<span class="token comment"># 设置过期时间</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SET name2 jack2 ex <span class="token number">3</span>
OK
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h5 id="获取一个key的内容"><a href="#获取一个key的内容" class="header-anchor">#</a> 获取一个key的内容</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> GET name
<span class="token string">&quot;linux39&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="删除一个key"><a href="#删除一个key" class="header-anchor">#</a> 删除一个key</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> DEL name
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> KEYS *
<span class="token punctuation">(</span>empty list or <span class="token builtin class-name">set</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="批量设置多个key"><a href="#批量设置多个key" class="header-anchor">#</a> 批量设置多个key</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> MSET name linux39  age <span class="token number">20</span> sex nan
OK
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="批量获取多个key"><a href="#批量获取多个key" class="header-anchor">#</a> 批量获取多个key</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> MGET name age sex
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;linux39&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;20&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;nan&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="追加数据"><a href="#追加数据" class="header-anchor">#</a> 追加数据</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> APPEND name <span class="token number">10</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">9</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> GET name
<span class="token string">&quot;linux3910&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="数值递增"><a href="#数值递增" class="header-anchor">#</a> 数值递增</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> num <span class="token number">0</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get num
<span class="token string">&quot;0&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> INCR num
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get num
<span class="token string">&quot;1&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="数值递减"><a href="#数值递减" class="header-anchor">#</a> 数值递减</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> DECR num
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get num
<span class="token string">&quot;3&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="返回字符串key的长度"><a href="#返回字符串key的长度" class="header-anchor">#</a> 返回字符串key的长度</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> STRLEN name
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">9</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="判断key是否存在"><a href="#判断key是否存在" class="header-anchor">#</a> 判断key是否存在</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> EXISTS xxx
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> EXISTS name
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="查看key的过期时间"><a href="#查看key的过期时间" class="header-anchor">#</a> 查看key的过期时间</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ttl <span class="token comment">#查看key的剩余生存时间 -1 #负一为永不过期，默认创建的key是永不过期，重新对key赋值，也会从有剩余生命周期变成永不过期 -2 #为没有此key num #key的剩余有效期</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> TTL name
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token parameter variable">-1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="设置key的过期时间"><a href="#设置key的过期时间" class="header-anchor">#</a> 设置key的过期时间</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SET  hongbao <span class="token number">300</span> ex <span class="token number">864000</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> TTL hongbao
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">863991</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="取消key的过期时间"><a href="#取消key的过期时间" class="header-anchor">#</a> 取消key的过期时间</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> PERSIST hongbao
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="列表-list"><a href="#列表-list" class="header-anchor">#</a> 列表(list)</h4> <p>列表是一个双向可读写的管道，其头部是左侧尾部是右侧，一个列表最多可以包含2^32-1个元素即4294967295个元素。</p> <h5 id="生成列表并插入数据"><a href="#生成列表并插入数据" class="header-anchor">#</a> 生成列表并插入数据</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LPUSH  list1  jack tom jhon
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> TYPE list1
list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="向列表追加数据"><a href="#向列表追加数据" class="header-anchor">#</a> 向列表追加数据</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LPUSH list1 tom1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> RPUSH  list1 jack1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="获取列表的长度"><a href="#获取列表的长度" class="header-anchor">#</a> 获取列表的长度</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LLEN  list1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="获取列表指定位置数据"><a href="#获取列表指定位置数据" class="header-anchor">#</a> <strong>获取列表指定位置数据</strong></h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LPUSH  list1  xiaomao1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">8</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> RPUSH  list1  xiaomao2
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">9</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE  list1 <span class="token number">0</span> <span class="token number">8</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;xiaomao1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;jack1&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;tom1&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;tom&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;jhon&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;tom&quot;</span>
<span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;jack&quot;</span>
<span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;jack&quot;</span>
<span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">&quot;xiaomao2&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="移除列表数据"><a href="#移除列表数据" class="header-anchor">#</a> 移除列表数据</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> RPOP  list1
<span class="token string">&quot;xiaomao2&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LPOP list1
<span class="token string">&quot;xiaomao1&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> LRANGE list1 <span class="token number">0</span> <span class="token number">6</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;jhon&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;tom&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;jack&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;jack1&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;tom1&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;tom&quot;</span>
<span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;jhon&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="集合"><a href="#集合" class="header-anchor">#</a> 集合</h4> <p>Set 是 String 类型的无序集合，集合中的成员是唯一的，这就意味着集合中不能出现重复的数据，可以在两个不同的集合中对数据进行对比并取值。</p> <h5 id="生成集合"><a href="#生成集合" class="header-anchor">#</a> 生成集合</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SADD  set1 v1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SADD  set2 v2 v4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> TYPE set1
<span class="token builtin class-name">set</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="追加数据-2"><a href="#追加数据-2" class="header-anchor">#</a> 追加数据</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SADD set1 v2 v3 v4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="查看集合所有数据"><a href="#查看集合所有数据" class="header-anchor">#</a> 查看集合所有数据</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SMEMBERS set1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;lisi&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;v4&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SMEMBERS set2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;liliu&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;wangwu&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;linux39&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;v4&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="获取集合的差集"><a href="#获取集合的差集" class="header-anchor">#</a> 获取集合的差集</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SDIFF set1 set2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;lisi&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="获取集合的交集"><a href="#获取集合的交集" class="header-anchor">#</a> 获取集合的交集</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SINTER set1 set2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v4&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="获取集合的并集"><a href="#获取集合的并集" class="header-anchor">#</a> 获取集合的并集</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SUNION  set1 set2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;wangwu&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;zhangsan&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;v4&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;lisi&quot;</span>
<span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;linux39&quot;</span>
<span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;liliu&quot;</span>
<span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="有序集合"><a href="#有序集合" class="header-anchor">#</a> 有序集合</h4> <p>Redis 有序集合和集合一样也是string类型元素的集合,且不允许重复的成员，不同的是每个元素都会关联一个double(双精度浮点型)类型的分数，redis正是通过该分数来为集合中的成员进行从小到大的排序，有序集合的成员是唯一的,但分数(score)却可以重复，集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)， 集合中最大的成员数为 2^32 - 1 (4294967295, 每个集合可存储40多亿个成员)。</p> <h5 id="生成有序集合"><a href="#生成有序集合" class="header-anchor">#</a> 生成有序集合</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZADD  <span class="token builtin class-name">set</span> <span class="token number">1</span> v1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZADD zset1 <span class="token number">1</span> v1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZADD zset1 <span class="token number">2</span> v2
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZADD zset1 <span class="token number">2</span> v3
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZADD zset1 <span class="token number">3</span> v4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> TYPE zset1
zset
<span class="token comment"># 一次生成多个数据</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZADD zset2 <span class="token number">1</span> v1 <span class="token number">2</span> v2 <span class="token number">3</span> v3 <span class="token number">4</span> v4 <span class="token number">5</span> v5
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="集合排行案例"><a href="#集合排行案例" class="header-anchor">#</a> 集合排行案例</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZADD paihangbang <span class="token number">90</span> nezha <span class="token number">199</span> zhanlang <span class="token number">60</span> zhuluoji <span class="token number">30</span> gangtiexia
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token comment"># 显示集合所有的key </span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZRANGE paihangbang <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;gangtiexia&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;zhuluoji&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;nezha&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;zhanlang&quot;</span>
<span class="token comment">#显示指定集合内所有key和得分情况</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZREVRANGE paihangbang <span class="token number">0</span> <span class="token parameter variable">-1</span> withscores
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;zhanlang&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;199&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;nezha&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;90&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;zhuluoji&quot;</span>
<span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;60&quot;</span>
<span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;gangtiexia&quot;</span>
<span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;30&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h5 id="获取集合的长度数"><a href="#获取集合的长度数" class="header-anchor">#</a> 获取集合的长度数</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZCARD zset1
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZCARD zset2
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="基于索引返回数值"><a href="#基于索引返回数值" class="header-anchor">#</a> 基于索引返回数值</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZRANGE zset1 <span class="token number">1</span> <span class="token number">3</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v4&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZRANGE zset1 <span class="token number">0</span> <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v1&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;v2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZRANGE  zset1 <span class="token number">2</span> <span class="token number">2</span>
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;v3&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="返回某个数值的索引"><a href="#返回某个数值的索引" class="header-anchor">#</a> 返回某个数值的索引</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZRANK zset1 v2
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> ZRANK zset1 v4
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="哈希"><a href="#哈希" class="header-anchor">#</a> 哈希</h4> <p>hash 是一个string类型的fifield和value的映射表，hash特别适合用于存储对象,Redis 中每个 hash 可以存储 2^32 -1 键值对（40多亿）。</p> <h5 id="生成哈希"><a href="#生成哈希" class="header-anchor">#</a> 生成哈希</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> HSET hash1  name tom age <span class="token number">18</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> TYPE hash1
<span class="token builtin class-name">hash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="获取哈希key的字段值"><a href="#获取哈希key的字段值" class="header-anchor">#</a> 获取哈希key的字段值</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> HGET hash1 name
<span class="token string">&quot;tom&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> HGET hash1 age
<span class="token string">&quot;18&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="删除一个字段"><a href="#删除一个字段" class="header-anchor">#</a> 删除一个字段</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> HDEL hash1  age
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="获取所有key"><a href="#获取所有key" class="header-anchor">#</a> 获取所有key</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> HMSET hash1  name tom age <span class="token number">19</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> HKEYS hash1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;age&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="获取指定hash的所有key及value"><a href="#获取指定hash的所有key及value" class="header-anchor">#</a> 获取指定hash的所有key及value</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> HGETALL hash1
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;name&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;tom&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;age&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;19&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="redis主从同步"><a href="#redis主从同步" class="header-anchor">#</a> redis主从同步</h4> <p>主备模式，可以实现Redis数据的跨主机备份</p> <p>程序端连接到高可用负载的VIP，然后连接到负载服务器设置的Redis后端real server，此模式不需要在程序里面配置Redis服务器的真实IP地址，当后期Redis服务器IP地址发生变更只需要更改redis 相应的后端real server即可，可避免更改程序中的IP地址设置。</p> <h5 id="slave主要配置"><a href="#slave主要配置" class="header-anchor">#</a> slave主要配置</h5> <p>redis slave也要开启持久化并设置和master同样的连接密码,因为后期slave会有提升为master的可能,slave端切换master同步后会丢失之前的所有数据</p> <p>一旦某个Slave成为一个master的slave，Redis Slave服务会清空当前redis服务器上的所有数据并将master的数据导入到自己的内存，但是断开同步关系后不会删除当前已经同步过的数据。</p> <h5 id="开始配置"><a href="#开始配置" class="header-anchor">#</a> 开始配置</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#环境配置</span>
<span class="token number">10.2</span>.32.11    slave     redis版本version<span class="token operator">=</span><span class="token number">4.0</span>.14  
<span class="token number">10.2</span>.32.12    master     redis版本version<span class="token operator">=</span><span class="token number">4.0</span>.14
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>当前状态为master，需要转换为slave角色并指向master服务器的IP+PORT+Password</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 10.2.32.11上配置</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SLAVEOF <span class="token number">10.2</span>.32.12 <span class="token number">6379</span>
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> CONFIG SET masterauth linux39
OK
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="查看同步的日志"><a href="#查看同步的日志" class="header-anchor">#</a> 查看同步的日志</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>root@ubuntu2:~<span class="token comment"># tail -f  /apps/redis/logs/redis_6379.log</span>
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.213 * MASTER <span class="token operator">&lt;</span>-<span class="token operator">&gt;</span> SLAVE <span class="token function">sync</span> started
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.213 * Non blocking connect <span class="token keyword">for</span> SYNC fired the event.
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.213 * Master replied to PING, replication can continue<span class="token punctuation">..</span>.
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.214 * Trying a partial resynchronization <span class="token punctuation">(</span>request ea4e32e49f98977e47c31634c9f83e4dbf5c8e31:1<span class="token punctuation">)</span>.
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.214 * Full resync from master: 784c9fa68b05c89d9aa1f113242f02942303e56c:0
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.214 * Discarding previously cached master state.
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.287 * MASTER <span class="token operator">&lt;</span>-<span class="token operator">&gt;</span> SLAVE sync: receiving <span class="token number">176</span> bytes from master
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.288 * MASTER <span class="token operator">&lt;</span>-<span class="token operator">&gt;</span> SLAVE sync: Flushing old data
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.288 * MASTER <span class="token operator">&lt;</span>-<span class="token operator">&gt;</span> SLAVE sync: Loading DB <span class="token keyword">in</span> memory
<span class="token number">1504</span>:S <span class="token number">25</span> Nov 06:50:58.288 * MASTER <span class="token operator">&lt;</span>-<span class="token operator">&gt;</span> SLAVE sync: Finished with success
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h5 id="测试是否能同步"><a href="#测试是否能同步" class="header-anchor">#</a> 测试是否能同步</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># master上建数据</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SET key1 value1
OK
<span class="token comment">#slave查看是否能同步</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> KEYS *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;key1&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="查看当前slave的状态"><a href="#查看当前slave的状态" class="header-anchor">#</a> 查看当前slave的状态</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> INFO Replication
<span class="token comment"># Replication</span>
role:slave
master_host:10.2.32.12
master_port:6379
master_link_status:up
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="保存配置到redis-conf"><a href="#保存配置到redis-conf" class="header-anchor">#</a> <strong>保存配置到</strong>redis.conf</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">286</span> replicaof <span class="token number">10.2</span>.32.12 <span class="token number">6379</span> 
<span class="token number">293</span> masterauth linux39 <span class="token comment">#根据master的密码设置</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># slave 状态只读无法写入数据:</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SET key3 v3
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> READONLY You can't <span class="token function">write</span> against a <span class="token builtin class-name">read</span> only slave.
<span class="token comment"># 因为在master的配置文件上打开了slave-read-only  yes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="主从复制过程"><a href="#主从复制过程" class="header-anchor">#</a> 主从复制过程</h5> <p>Redis支持主从复制分为全量同步和增量同步，首次同步是全量同步，主从同步可以让从服务器从主服务器备份数据。而且从服务器还可以在有从服务器，即另外一台redis服务器可以从一台<strong>从服务器</strong>进行数据同步，redis 的主从同步是非阻塞的，master收到从服务器的sync(2.8版本之前是PSYNC)命令会fork一个子进程在后台执行bgsave命令，并将<strong>新写入的数据写入到一个缓冲区里面</strong>，bgsave执行完成之后并生成的将RDB文件发送给客户端，客户端将收到后的RDB文件载入自己的内存，然后redis master再将缓冲区的内容在全部发送给redis slave，之后的同步slave服务器会发送一个offffset的位置(等同于MySQL的binlog的位置)给主服务器，主服务器检查后位置没有错误将此位置之后的数据包括写在缓冲区的积压数据发送给redis从服务器，从服务器将主服务器发送的挤压数据写入内存，这样一次完整的数据同步，再之后再同步的时候从服务器只要发送当前的offffset位 置给主服务器，然后主服务器根据相应的位置将之后的数据发送给从服务器保存到其内存即可</p> <p>redis全量复制一般发生在slave首次初始化阶段,这时slave需要将Master上的所有数据都复制一份,具体主从同步步骤如下:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span>、从服务器连接主服务器,发送SYNC命令
<span class="token number">2</span>）主服务器接收到SYNC命名后，开始执行BGSAVE命令生成RDB快照文件并使用缓冲区记录此后执行的所有写命令； 
<span class="token number">3</span>）主服务器BGSAVE执行完后，向所有从服务器发送快照文件，并在发送期间继续记录被执行的写命令； 
<span class="token number">4</span>）从服务器收到快照文件后丢弃所有旧数据，载入收到的快照； 
<span class="token number">5</span>）主服务器快照发送完毕后开始向从服务器发送缓冲区中的写命令；
<span class="token number">6</span>）从服务器完成对快照的载入，开始接收命令请求，并执行来自主服务器缓冲区的写命令；
<span class="token number">7</span>）后期同步会先发送自己slave_repl_offset位置，只同步新增加的数据，不再全量同步。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="https://lixuanfengs.github.io/blog-images/cactus-vuepress-img/2e9916b114d74a77b1eadb62cafe77ba.png" alt="img"></p> <div class="language-plain line-numbers-mode"><pre class="language-plain"><code>   ##### 主从同步的优化
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Redis在2.8版本之前没有提供增量部分复制的功能，当网络闪断或者slave Redis重启之后会导致主从之间的全量同步，即从2.8版本开始增加了部分复制的功能。</p> <p>repl-diskless-sync no # 是否使用无盘同步RDB文件，默认为no，no为不使用无盘，需要将RDB文件保存到磁盘后再发送给slave，yes为支持无盘，支持无盘就是RDB文件不需要保存至本地磁盘，而且直接通过socket文件发送给slave</p> <p>repl-diskless-sync-delay 5 #Master准备好RDB文件后等等待传输时间</p> <p>repl-ping-slave-period 10 #slave端向server端发送ping的时间区间设置，默认为10秒</p> <p>repl-timeout 60 #设置超时时间</p> <p>repl-disable-tcp-nodelay no #是否启用TCP_NODELAY，如设置成yes，则redis会合并小的TCP包从而节省带宽，但会增加同步延迟（40ms），造成master与slave数据不一致，假如设置成no，则redis master会立即发送同步数据，没有延迟，前者关注性能，后者关注redis服务中的数据一致性。</p> <p>repl-backlog-size 1mb #master的写入数据缓冲区，用于记录自上一次同步后到下一次同步过程中间的写入命令，计算公式：repl-backlog-size = 允许从节点最大中断时长  <em>主实例offffset每秒写入量，比如master每秒最大写入64mb，最大允许60秒，那么就要设置为64mb</em>60秒=3840MB(3.8G)</p> <p>repl-backlog-ttl 3600 #如果一段时间后没有slave连接到master，则backlog size的内存将会被释放。如果值为0则表示永远不释放这部份内存。</p> <p>slave-priority 100 #slave端的优先级设置，值是一个整数，数字越小表示优先级越高。当master故障时将会按照优先级来选择slave端进行恢复，如果值设置为0，则表示该slave永远不会被选择。</p> <p>min-slaves-to-write 1 #设置一个master端的可用slave少于多少个</p> <p>min-slaves-max-lag 20 #设置所有slave延迟时间都大于多少秒时，master不接收写操作(拒绝写入)</p> <h5 id="一主两从"><a href="#一主两从" class="header-anchor">#</a> 一主两从</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#环境配置</span>
<span class="token number">10.2</span>.32.11    slave     redis版本version<span class="token operator">=</span><span class="token number">4.0</span>.14  
<span class="token number">10.2</span>.32.12    master     redis版本version<span class="token operator">=</span><span class="token number">4.0</span>.14  
<span class="token number">10.2</span>.32.10    slave     redis版本version<span class="token operator">=</span><span class="token number">4.0</span>.14
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 10.2.32.10上配置</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SLAVEOF <span class="token number">10.2</span>.32.12 <span class="token number">6379</span>      redis4.x的主从配置
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> CONFIG SET masterauth linux39
OK
<span class="token comment"># 设置完查看状态</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> info
<span class="token comment"># Replication</span>
role:slave
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 数据同步测试</span>
<span class="token comment"># master上操作</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SET  key5  value5
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SET  key6  value6
OK
<span class="token comment"># slave上查看数据</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> KEYS *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;key6&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;key2&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;key5&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;key1&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="哨兵-sentinel"><a href="#哨兵-sentinel" class="header-anchor">#</a> 哨兵 (Sentinel)</h4> <p>Sentinel 进程是用于监控redis集群中Master主服务器工作的状态，在Master主服务器发生故障的时候，可以实现Master和Slave服务器的切换，保证系统的高可用，其已经被集成在redis2.6+的版本中，Redis的哨兵模式到了2.8版本之后就稳定了下来。一般在生产环境也建议使用Redis的2.8版本的以后版本。哨兵(Sentinel) 是一个分布式系统，可以在一个架构中运行多个哨兵(sentinel) 进程，这些进程使用流言协议(gossip protocols)来接收关于Master主服务器是否下线的信息，并使用投票协议(Agreement Protocols)来决定是否执行自动故障迁移,以及选择哪个Slave作为新的Master。每个哨兵(Sentinel)进程会向其它哨兵(Sentinel)、Master、Slave定时发送消息，以确认对方是否”活”着，如果发现对方在指定配置时间(可配置的)内未得到回应，则暂时认为对方已掉线，也就是所谓的”主观认为宕机” ，<strong>主观是每个成员都具有的独自的而且可能相同也可能不同的意识</strong>，英文名称：Subjective Down，简称SDOWN。有主观宕机，肯定就有客观宕机。当“哨兵群”中的多数Sentinel进程在对Master主服务器做出SDOWN 的判断，并且通过 SENTINEL is-master-down-by-addr 命令互相交流之后，得出的Master Server下线判断，这种方式就是“客观宕机”，<strong>客观是不依赖于某种意识而已经实际存在的一切事物</strong>，英文名称是：ObjectivelyDown， 简称 ODOWN。通过一定的vote算法，从剩下的slave从服务器节点中，选一台提升为Master服务器节点，然后自动修改相关配置，并开启故障转移（failover）</p> <p>Sentinel 机制可以解决master和slave角色的切换问题。</p> <h5 id="配置一个主从同步的环境"><a href="#配置一个主从同步的环境" class="header-anchor">#</a> 配置一个主从同步的环境</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 集群环境</span>
<span class="token number">10.2</span>.32.2    k8s-master      slave
<span class="token number">10.2</span>.32.3    k8s-slave1      slave
<span class="token number">10.2</span>.32.5    k8s-master01   master
<span class="token comment"># 配置过程省略</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="配置哨兵"><a href="#配置哨兵" class="header-anchor">#</a> 配置哨兵</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 复制配置文件</span>
<span class="token punctuation">[</span>root@k8s-master01 ~<span class="token punctuation">]</span><span class="token comment">#  cp /usr/local/src/redis-4.0.14/sentinel.conf   /apps/redis/etc/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 配置文件弄好复制去其他服务器即可</span>
<span class="token punctuation">[</span>root@k8s-master01 ~<span class="token punctuation">]</span><span class="token comment">#  cat /apps/redis/etc/sentinel.conf</span>
<span class="token builtin class-name">bind</span> <span class="token number">0.0</span>.0.0
port <span class="token number">26379</span>
daemonize <span class="token function">yes</span>
pidfile <span class="token string">&quot;redis-sentinel.pid&quot;</span>
logfile <span class="token string">&quot;sentinel_26379.log&quot;</span>
<span class="token function">dir</span> <span class="token string">&quot;/apps/redis/logs&quot;</span>
sentinel monitor mymaster <span class="token number">10.2</span>.32.11  <span class="token number">6379</span> <span class="token number">2</span> <span class="token comment">#法定人数限制(quorum)，即有几个slave认为master down了就进行故障转移</span>
sentinel auth-pass mymaster linux39
sentinel down-after-milliseconds mymaster <span class="token number">30000</span> <span class="token comment">#(SDOWN)主观下线的时间</span>
sentinel parallel-syncs mymaster <span class="token number">1</span> <span class="token comment">#发生故障转移时候同时向新master同步数据的slave数量，数字越小总 同步时间越长</span>
sentinel failover-timeout mymaster <span class="token number">180000</span> <span class="token comment">#所有slaves指向新的master所需的超时时间</span>
sentinel deny-scripts-reconfig <span class="token function">yes</span> <span class="token comment">#禁止修改脚本</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 启动哨兵</span>
<span class="token punctuation">[</span>root@k8s-master01 ~<span class="token punctuation">]</span><span class="token comment"># /apps/redis/bin/redis-sentinel    /apps/redis/etc/sentinel.conf</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># /apps/redis/bin/redis-sentinel    /apps/redis/etc/sentinel.conf</span>
<span class="token punctuation">[</span>root@k8s-slave ~<span class="token punctuation">]</span><span class="token comment">#/apps/redis/bin/redis-sentinel    /apps/redis/etc/sentinel.conf</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="查看端口是否启动"><a href="#查看端口是否启动" class="header-anchor">#</a> 查看端口是否启动</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master01 ~<span class="token punctuation">]</span><span class="token comment"># ss -ntl</span>
LISTEN                   <span class="token number">0</span>                         <span class="token number">128</span>                                                 <span class="token number">0.0</span>.0.0:26379                                            <span class="token number">0.0</span>.0.0:*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="查看哨兵日志"><a href="#查看哨兵日志" class="header-anchor">#</a> 查看哨兵日志</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master redis-4.0.14<span class="token punctuation">]</span><span class="token comment"># tail  -f /apps/redis/logs/sentinel_26379.log</span>
<span class="token number">51090</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:34.922 <span class="token comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
<span class="token number">51090</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:34.923 <span class="token comment"># Redis version=4.0.14, bits=64, commit=00000000, modified=0, pid=51090, just started</span>
<span class="token number">51090</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:34.923 <span class="token comment"># Configuration loaded</span>
<span class="token number">51091</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:34.925 * Running <span class="token assign-left variable">mode</span><span class="token operator">=</span>sentinel, <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">26379</span>.
<span class="token number">51091</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:34.925 <span class="token comment"># Sentinel ID is 33e4f904e9729b4e63765e7678436a7466258902</span>
<span class="token number">51091</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:34.925 <span class="token comment"># +monitor master mymaster 10.2.32.5 6379 quorum 2</span>
<span class="token number">51091</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:34.926 * +slave slave <span class="token number">10.2</span>.32.2:6379 <span class="token number">10.2</span>.32.2 <span class="token number">6379</span> @ mymaster <span class="token number">10.2</span>.32.5 <span class="token number">6379</span>
<span class="token number">51091</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:34.927 * +slave slave <span class="token number">10.2</span>.32.3:6379 <span class="token number">10.2</span>.32.3 <span class="token number">6379</span> @ mymaster <span class="token number">10.2</span>.32.5 <span class="token number">6379</span>
<span class="token number">51091</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:35.347 * +sentinel sentinel 0a3edaade660afe5dfd4204b45ff9877deb17aee <span class="token number">10.2</span>.32.3 <span class="token number">26379</span> @ mymaster <span class="token number">10.2</span>.32.5 <span class="token number">6379</span>
<span class="token number">51091</span>:X <span class="token number">26</span> Nov <span class="token number">21</span>:26:35.922 * +sentinel sentinel 18f488a511d759e5b17ecfe63085ffd2567eb108 <span class="token number">10.2</span>.32.5 <span class="token number">26379</span> @ mymaster <span class="token number">10.2</span>.32.5 <span class="token number">6379</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h5 id="查看哨兵状态"><a href="#查看哨兵状态" class="header-anchor">#</a> 查看哨兵状态</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master01 ~<span class="token punctuation">]</span><span class="token comment"># redis-cli  -p 26379</span>
<span class="token number">127.0</span>.0.1:2637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> info 
master0:name<span class="token operator">=</span>mymaster,status<span class="token operator">=</span>ok,address<span class="token operator">=</span><span class="token number">10.2</span>.32.5:6379,slaves<span class="token operator">=</span><span class="token number">2</span>,sentinels<span class="token operator">=</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="停止redis-master测试故障转移"><a href="#停止redis-master测试故障转移" class="header-anchor">#</a> 停止Redis Master测试故障转移：</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master01 ~<span class="token punctuation">]</span><span class="token comment"># redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> AUTH  linux39
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SHUTDOWN
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="故障转移后的redis配置文件"><a href="#故障转移后的redis配置文件" class="header-anchor">#</a> 故障转移后的redis配置文件</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master01 ~<span class="token punctuation">]</span><span class="token comment"># grep &quot;^[a-Z]&quot;   /apps/redis/etc/sentinel.conf</span>
<span class="token builtin class-name">bind</span> <span class="token number">0.0</span>.0.0
port <span class="token number">26379</span>
daemonize <span class="token function">yes</span>
pidfile <span class="token string">&quot;redis-sentinel.pid&quot;</span>
logfile <span class="token string">&quot;sentinel_26379.log&quot;</span>
<span class="token function">dir</span> <span class="token string">&quot;/apps/redis/logs&quot;</span>
sentinel myid 18f488a511d759e5b17ecfe63085ffd2567eb108
sentinel deny-scripts-reconfig <span class="token function">yes</span>
sentinel monitor mymaster <span class="token number">10.2</span>.32.2 <span class="token number">6379</span> <span class="token number">2</span>
sentinel auth-pass mymaster linux39
sentinel config-epoch mymaster <span class="token number">1</span>
sentinel leader-epoch mymaster <span class="token number">1</span>
sentinel known-slave mymaster <span class="token number">10.2</span>.32.5 <span class="token number">6379</span>
sentinel known-slave mymaster <span class="token number">10.2</span>.32.3 <span class="token number">6379</span>
sentinel known-sentinel mymaster <span class="token number">10.2</span>.32.3 <span class="token number">26379</span> 0a3edaade660afe5dfd4204b45ff9877deb17aee
sentinel known-sentinel mymaster <span class="token number">10.2</span>.32.2 <span class="token number">26379</span> 33e4f904e9729b4e63765e7678436a7466258902
sentinel current-epoch <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h5 id="查看现在的master情况"><a href="#查看现在的master情况" class="header-anchor">#</a> 查看现在的master情况</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-master redis-4.0.14<span class="token punctuation">]</span><span class="token comment"># redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> info 
<span class="token comment"># Replication</span>
role:master
connected_slaves:1
slave0:ip<span class="token operator">=</span><span class="token number">10.2</span>.32.3,port<span class="token operator">=</span><span class="token number">6379</span>,state<span class="token operator">=</span>online,offset<span class="token operator">=</span><span class="token number">196586</span>,lag<span class="token operator">=</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#redis哨兵及实现</span>
自动检测到redis master宕机,还会自动执行故障转移,数据跨主机备份,写入性能是单机,容易出现瓶颈
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="redis-cluster"><a href="#redis-cluster" class="header-anchor">#</a> Redis Cluster</h4> <p>早期Redis分布式集群部署方案</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span><span class="token punctuation">)</span> 客户端分区：由客户端程序决定key写分配和写入的redis node，但是需要客户端自己处理写入分配、高可用管理和 故障转移等
<span class="token number">2</span><span class="token punctuation">)</span> 代理方案：基于三方软件实现redis proxy，客户端先连接之代理层，由代理层实现key的写入分配，对客户端来说 是有比较简单，但是对于集群管节点增减相对比较麻烦，而且代理本身也是单点和性能瓶颈。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在哨兵sentinel机制中，可以解决redis高可用的问题，即当master故障后可以自动将slave提升为master从而可以保证redis服务的正常使用，但是无法解决redis单机写入的瓶颈问题，即单机的redis写入性能受限于单机的内存大小、并发数量、网卡速率等因素，因此redis官方在redis 3.0版本之后推出了无中心架构的redis cluster机制，在无中心的redis集群当中，其每个节点保存当前节点数据和整个集群状态,每个节点都和其他所有节点连接，特点如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span>、所有Redis节点使用<span class="token punctuation">(</span>PING机制<span class="token punctuation">)</span>互联
<span class="token number">2</span>、集群中某个节点的失效,是整个集群中超过半数的节点监测都失效才算真正的失效
<span class="token number">3</span>、客户端不需要proxy即可直接连接redis，应用程序需要写全部的redis服务器IP 
<span class="token number">4</span>、redis cluster把所有的redis node映射到0-16383个槽位<span class="token punctuation">(</span>slot<span class="token punctuation">)</span>上,读写需要到指定的redis node上进行操作,因此有多少个redis node相当于redis并发扩展了多少倍
<span class="token number">5</span>、redis cluster预先分配16384个<span class="token punctuation">(</span>slot<span class="token punctuation">)</span>槽位,当需要在redis集群中写入一个key-vlaue的时候,会使用CRC16<span class="token punctuation">(</span>KEY<span class="token punctuation">)</span> <span class="token number">16384</span>之后的值,决定将key写入值到哪一个槽位从而决定写入哪一个Redis节点上,从而有效解决单机瓶颈
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="部署redis集群"><a href="#部署redis集群" class="header-anchor">#</a> 部署redis集群</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 3主3从</span>
<span class="token number">10.2</span>.32.2:6379
<span class="token number">10.2</span>.32.3:6379
<span class="token number">10.2</span>.32.5:6379
<span class="token number">10.2</span>.32.4:6379
<span class="token number">10.2</span>.32.6:6379
<span class="token number">10.2</span>.32.15:6379
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="准备工作"><a href="#准备工作" class="header-anchor">#</a> 准备工作</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token number">1</span>.每个redis node节点采用相同的硬件配置、相同的密码、相同的redis版本。
<span class="token number">2</span>.每个节点必须开启的参数
cluster-enabled <span class="token function">yes</span> <span class="token comment">#必须开启集群状态，开启后redis 进程会有cluster显示</span>
cluster-config-file nodes-63879.conf <span class="token comment">#此文件有redis cluster集群自动创建和维护，不需要任何手动操作</span>
<span class="token number">3</span>.所有redis服务器必须没有任何数据,哨兵配件文件也要删除,确保是个干净的环境
<span class="token number">4</span>.先启动为单机redis且没有任何key value
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="修改配置文件"><a href="#修改配置文件" class="header-anchor">#</a> 修改配置文件</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token comment"># 六台机器操作一样</span>
 <span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># vim /apps/redis/etc/redis.conf</span>
 <span class="token number">815</span> cluster-enabled <span class="token function">yes</span>
 <span class="token number">823</span> cluster-config-file nodes-6379.conf
 <span class="token comment">#设置masterauth密码</span>
 masterauth linux39<span class="token punctuation">(</span>密码<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>查看端口是否启动,分别是6379和61379</p> <p>在开启了redis cluster功能之后,redis在数据端口(6379)的基础之上加10000而监听的集群端口,集群端口用于集群选举</p> <h5 id="创建集群"><a href="#创建集群" class="header-anchor">#</a> 创建集群</h5> <p>需要使用到集群管理工具redis-trib.rb，这个工具是redis官方推出的管理redis集群的工具，集成在redis的源码src目录下，是基于redis提供的集群命令封装成简单、便捷、实用的操作工具，redis-trib.rb是redis作者用ruby开发完成的，centos 系统yum安装的ruby存在版本较低问题，如下：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>redis3或者4:
	redis-trib.rb,redis官方维护,基于ruby开发,需要解决系统对ruby的支持
redis <span class="token number">5</span>:
	redis-cli命令来创建,5把redis-trib命令废弃
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 一台机器上操作即可</span>
<span class="token comment"># 安装ruby环境</span>
<span class="token comment"># yum install rubygems -y</span>
<span class="token number">1</span>.安装curl
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token function">curl</span>
<span class="token number">2</span>. 安装RVM
<span class="token function">curl</span> <span class="token parameter variable">-L</span> get.rvm.io <span class="token operator">|</span> <span class="token function">bash</span> <span class="token parameter variable">-s</span> stable
<span class="token function">curl</span> <span class="token parameter variable">-sSL</span> https://rvm.io/mpapis.asc <span class="token operator">|</span> gpg2 <span class="token parameter variable">--import</span> - 
<span class="token function">curl</span> <span class="token parameter variable">-sSL</span> https://rvm.io/pkuczynski.asc <span class="token operator">|</span> gpg2 <span class="token parameter variable">--import</span> 
<span class="token function">curl</span> <span class="token parameter variable">-L</span> get.rvm.io <span class="token operator">|</span> <span class="token function">bash</span> <span class="token parameter variable">-s</span> stable
<span class="token number">3</span>. 
<span class="token builtin class-name">source</span> /usr/local/rvm/scripts/rvm
<span class="token number">4</span>. 查看rvm库中已知的ruby版本
rvm list known
<span class="token number">5</span>. 安装一个ruby版本
rvm <span class="token function">install</span> <span class="token number">2.6</span>.6
<span class="token number">6</span>. 使用一个ruby版本
rvm use <span class="token number">2.6</span>.6
<span class="token number">7</span>. 设置默认版本
rvm remove <span class="token number">2.0</span>.0
<span class="token number">8</span>. 卸载一个已知版本
ruby <span class="token parameter variable">--version</span>
<span class="token number">9</span>. 再安装redis就可以了
gem <span class="token function">install</span> redis
<span class="token punctuation">[</span>root@k8s-slave1 src<span class="token punctuation">]</span><span class="token comment"># cp redis-trib.rb   /usr/local/bin/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查找路径</span>
<span class="token punctuation">[</span>root@k8s-slave1 ~<span class="token punctuation">]</span><span class="token comment"># find / -name  client.rb</span>
/usr/local/rvm/gems/ruby-2.6.6/gems/redis-4.5.1/lib/redis/client.rb
<span class="token comment">#修改密码redis 登录密码</span>
<span class="token punctuation">[</span>root@k8s-slave1 ~<span class="token punctuation">]</span><span class="token comment"># vim /usr/local/rvm/gems/ruby-2.6.6/gems/redis-4.5.1/lib/redis/client.rb</span>
<span class="token number">21</span>       password: <span class="token string">'linux39'</span>,
<span class="token comment"># 创建集群</span>
<span class="token punctuation">[</span>root@k8s-slave1 etc<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb create --replicas 1 10.2.32.2:6379 10.2.32.3:6379 10.2.32.5:6379  10.2.32.4:6379  10.2.32.6:6379  10.2.32.15:6379</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Creating cluster
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing <span class="token builtin class-name">hash</span> slots allocation on <span class="token number">6</span> nodes<span class="token punctuation">..</span>.
Using <span class="token number">3</span> masters:
<span class="token number">10.2</span>.32.2:6379
<span class="token number">10.2</span>.32.3:6379
<span class="token number">10.2</span>.32.5:6379
Adding replica <span class="token number">10.2</span>.32.6:6379 to <span class="token number">10.2</span>.32.2:6379
Adding replica <span class="token number">10.2</span>.32.15:6379 to <span class="token number">10.2</span>.32.3:6379
Adding replica <span class="token number">10.2</span>.32.4:6379 to <span class="token number">10.2</span>.32.5:6379
M: e191fe5e618742934bfea83da698894bfbcea83d <span class="token number">10.2</span>.32.2:6379
   slots:0-5460 <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
M: 57552e559b357e6ec1d173e717a88eddefba9593 <span class="token number">10.2</span>.32.3:6379
   slots:5461-10922 <span class="token punctuation">(</span><span class="token number">5462</span> slots<span class="token punctuation">)</span> master
M: b229fc6243f8976d702d7f14d91947c352b2b80d <span class="token number">10.2</span>.32.5:6379
   slots:10923-16383 <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
S: 99cf0e1f7ae6ee7269e7460a293e2e4470e50725 <span class="token number">10.2</span>.32.4:6379
   replicates b229fc6243f8976d702d7f14d91947c352b2b80d
S: 861ebcee2423afd332f2ff1b9b4790f1478f08c8 <span class="token number">10.2</span>.32.6:6379
   replicates e191fe5e618742934bfea83da698894bfbcea83d
S: 0e85941ac11228229531a3be028416ba21a9a015 <span class="token number">10.2</span>.32.15:6379
   replicates 57552e559b357e6ec1d173e717a88eddefba9593
Can I <span class="token builtin class-name">set</span> the above configuration? <span class="token punctuation">(</span>type <span class="token string">'yes'</span> to accept<span class="token punctuation">)</span>: <span class="token function">yes</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Nodes configuration updated
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Assign a different config epoch to each <span class="token function">node</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Sending CLUSTER MEET messages to <span class="token function">join</span> the cluster
Waiting <span class="token keyword">for</span> the cluster to join<span class="token punctuation">..</span>.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing Cluster Check <span class="token punctuation">(</span>using <span class="token function">node</span> <span class="token number">10.2</span>.32.2:6379<span class="token punctuation">)</span>
M: e191fe5e618742934bfea83da698894bfbcea83d <span class="token number">10.2</span>.32.2:6379
   slots:0-5460 <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
M: b229fc6243f8976d702d7f14d91947c352b2b80d <span class="token number">10.2</span>.32.5:6379
   slots:10923-16383 <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: 99cf0e1f7ae6ee7269e7460a293e2e4470e50725 <span class="token number">10.2</span>.32.4:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates b229fc6243f8976d702d7f14d91947c352b2b80d
S: 0e85941ac11228229531a3be028416ba21a9a015 <span class="token number">10.2</span>.32.15:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 57552e559b357e6ec1d173e717a88eddefba9593
M: 57552e559b357e6ec1d173e717a88eddefba9593 <span class="token number">10.2</span>.32.3:6379
   slots:5461-10922 <span class="token punctuation">(</span><span class="token number">5462</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: 861ebcee2423afd332f2ff1b9b4790f1478f08c8 <span class="token number">10.2</span>.32.6:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates e191fe5e618742934bfea83da698894bfbcea83d
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All nodes agree about slots configuration.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check <span class="token keyword">for</span> <span class="token function">open</span> slots<span class="token punctuation">..</span>.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check slots coverage<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All <span class="token number">16384</span> slots covered.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h5 id="验证redis集群状态"><a href="#验证redis集群状态" class="header-anchor">#</a> 验证redis集群状态</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># slave上的</span>
<span class="token punctuation">[</span>root@xiaomao6 etc<span class="token punctuation">]</span><span class="token comment"># redis-cli</span>
<span class="token comment"># Replication</span>
role:slave
master_host:10.2.32.3
master_port:6379
master_link_status:up
master_last_io_seconds_ago:5
master_sync_in_progress:0
slave_repl_offset:14
slave_priority:100
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># master上的</span>
<span class="token punctuation">[</span>root@k8s-master ~<span class="token punctuation">]</span><span class="token comment"># redis-cli</span>
<span class="token comment"># Replication</span>
role:slave
master_host:10.2.32.3
master_port:6379
master_link_status:up
master_last_io_seconds_ago:5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 验证集群状态</span>
<span class="token punctuation">[</span>root@xiaomao6 etc<span class="token punctuation">]</span><span class="token comment"># redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> AUTH linux39
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> CLUSTER INFO
cluster_state:ok
cluster_slots_assigned:16384
cluster_slots_ok:16384
cluster_slots_pfail:0
cluster_slots_fail:0
cluster_known_nodes:6
cluster_size:3
cluster_current_epoch:6
cluster_my_epoch:2
cluster_stats_messages_ping_sent:172
cluster_stats_messages_pong_sent:188
cluster_stats_messages_sent:360
cluster_stats_messages_ping_received:188
cluster_stats_messages_pong_received:172
cluster_stats_messages_received:360
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查看集群node的对应关系 </span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> cluster nodes
0e85941ac11228229531a3be028416ba21a9a015 <span class="token number">10.2</span>.32.15:6379@16379 slave 57552e559b357e6ec1d173e717a88eddefba9593 <span class="token number">0</span> <span class="token number">1638166405156</span> <span class="token number">6</span> connected
99cf0e1f7ae6ee7269e7460a293e2e4470e50725 <span class="token number">10.2</span>.32.4:6379@16379 slave b229fc6243f8976d702d7f14d91947c352b2b80d <span class="token number">0</span> <span class="token number">1638166405000</span> <span class="token number">4</span> connected
e191fe5e618742934bfea83da698894bfbcea83d :0@0 master,noaddr - <span class="token number">1638165285207</span> <span class="token number">1638165285207</span> <span class="token number">1</span> disconnected <span class="token number">0</span>-5460
861ebcee2423afd332f2ff1b9b4790f1478f08c8 <span class="token number">10.2</span>.32.6:6379@16379 slave e191fe5e618742934bfea83da698894bfbcea83d <span class="token number">0</span> <span class="token number">1638166403155</span> <span class="token number">5</span> connected
b229fc6243f8976d702d7f14d91947c352b2b80d <span class="token number">10.2</span>.32.5:6379@16379 master - <span class="token number">0</span> <span class="token number">1638166406159</span> <span class="token number">3</span> connected <span class="token number">10923</span>-16383
57552e559b357e6ec1d173e717a88eddefba9593 <span class="token number">10.2</span>.32.3:6379@16379 myself,master - <span class="token number">0</span> <span class="token number">1638166401000</span> <span class="token number">2</span> connected <span class="token number">5461</span>-10922
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 检查槽位</span>
<span class="token punctuation">[</span>root@k8s-slave1 etc<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb   check 10.2.32.2:6379</span>
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All nodes agree about slots configuration.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check <span class="token keyword">for</span> <span class="token function">open</span> slots<span class="token punctuation">..</span>.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check slots coverage<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All <span class="token number">16384</span> slots covered.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 验证集群写入key</span>
<span class="token punctuation">[</span>root@k8s-master etc<span class="token punctuation">]</span><span class="token comment"># redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> AUTH linux39
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SET KEY1 VALUEE1
OK
<span class="token punctuation">[</span>root@k8s-master02 run<span class="token punctuation">]</span><span class="token comment"># redis-cli</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> AUTH linux39
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> info
<span class="token comment"># Replication</span>
role:slave
master_host:10.2.32.2
master_port:6379
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> KEYS *
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;KEY1&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="redis-cluster集群节点维护"><a href="#redis-cluster集群节点维护" class="header-anchor">#</a> Redis cluster集群节点维护</h4> <p>集群运行时间长久之后，难免由于硬件故障、网络规划、业务增长等原因对已有集群进行相应的调整， 比如增加Redis node节点、减少节点、节点迁移、更换服务器等</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>增加节点和删除节点会涉及到已有的槽位重新分配及数据迁移
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="动态添加节点"><a href="#动态添加节点" class="header-anchor">#</a> 动态添加节点</h5> <p>增加Redis node节点，需要与之前的Redis node版本相同、配置一致，然后分别启动两台Redis node，因为一主一从</p> <p><strong>案例：</strong></p> <p>因公司业务发展迅猛，现有的三主三从redis cluster架构可能无法满足现有业务的并发写入需求，因此公司紧急采购2台服务器10.2.32.10,10.2.32.11，需要将其动态添加到集群当中其不能影响业务使用和数据丢失，则添加过程如下:同步之前Redis node的配置文件到10.2.32.2  Redis编译安装目录，注意配置文件的监听 IP。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 添加节点到集群</span>
add-node new_host:new_port existing_host:existing_port 要添加的新redis节点IP和端口 添加到的集群中的master IP:端口，新的node节点加到集群之后默认是master节 点，但是没有slots数据，需要重新分配。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># redis4 </span>
<span class="token punctuation">[</span>root@k8s-slave1 etc<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb  add-node 10.2.32.11:6379(新节点)  10.2.32.3:6379(老)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Adding <span class="token function">node</span> <span class="token number">10.2</span>.32.11:6379 to cluster <span class="token number">10.2</span>.32.3:6379
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing Cluster Check <span class="token punctuation">(</span>using <span class="token function">node</span> <span class="token number">10.2</span>.32.3:6379<span class="token punctuation">)</span>
M: 86b330ac633e111e1ff28c6fc119308c47279e37 <span class="token number">10.2</span>.32.3:6379
   slots:5461-10922 <span class="token punctuation">(</span><span class="token number">5462</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: c193dc8ceabf601e435ebba25ce0e15bb59bf946 <span class="token number">10.2</span>.32.6:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates ba4e4fbda137e12c711117fe3d7bea5c447a195a
S: ad7facfbc91e8d22852fef58a7a974f0d070b4cd <span class="token number">10.2</span>.32.15:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 86b330ac633e111e1ff28c6fc119308c47279e37
S: c775e76f383b6dbdb3ea7bbc6a927c35a4280ef3 <span class="token number">10.2</span>.32.4:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 942294da2e9237c1941833ce3217cae8869a915d
M: 942294da2e9237c1941833ce3217cae8869a915d <span class="token number">10.2</span>.32.5:6379
   slots:10923-16383 <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
M: ba4e4fbda137e12c711117fe3d7bea5c447a195a <span class="token number">10.2</span>.32.2:6379
   slots:0-5460 <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All nodes agree about slots configuration.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check <span class="token keyword">for</span> <span class="token function">open</span> slots<span class="token punctuation">..</span>.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check slots coverage<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All <span class="token number">16384</span> slots covered.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Send CLUSTER MEET to <span class="token function">node</span> <span class="token number">10.2</span>.32.11:6379 to <span class="token function">make</span> it <span class="token function">join</span> the cluster.
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> New <span class="token function">node</span> added correctly.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h5 id="更改新节点更改状态为slave"><a href="#更改新节点更改状态为slave" class="header-anchor">#</a> 更改新节点更改状态为slave</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 10.2.32.11</span>
<span class="token punctuation">[</span>root@xiaomao7 data<span class="token punctuation">]</span><span class="token comment"># redis-cli  -h 10.2.32.11 -p 6379 -a linux39</span>
<span class="token number">10.2</span>.32.11:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> CLUSTER  NODES
942294da2e9237c1941833ce3217cae8869a915d <span class="token number">10.2</span>.32.5:6379@16379 master - <span class="token number">0</span> <span class="token number">1638174288160</span> <span class="token number">3</span> connected <span class="token number">10923</span>-16383
7e981b74144f19c4ca36c5f9e76b24aef48e676c <span class="token number">10.2</span>.32.11:6379@16379 myself,master - <span class="token number">0</span> <span class="token number">1638174289000</span> <span class="token number">7</span> connected
c775e76f383b6dbdb3ea7bbc6a927c35a4280ef3 <span class="token number">10.2</span>.32.4:6379@16379 slave 942294da2e9237c1941833ce3217cae8869a915d <span class="token number">0</span> <span class="token number">1638174288000</span> <span class="token number">3</span> connected
ba4e4fbda137e12c711117fe3d7bea5c447a195a <span class="token number">10.2</span>.32.2:6379@16379 master - <span class="token number">0</span> <span class="token number">1638174287158</span> <span class="token number">1</span> connected <span class="token number">0</span>-5460
c193dc8ceabf601e435ebba25ce0e15bb59bf946 <span class="token number">10.2</span>.32.6:6379@16379 slave ba4e4fbda137e12c711117fe3d7bea5c447a195a <span class="token number">0</span> <span class="token number">1638174289561</span> <span class="token number">1</span> connected
86b330ac633e111e1ff28c6fc119308c47279e37 <span class="token number">10.2</span>.32.3:6379@16379 master - <span class="token number">0</span> <span class="token number">1638174290164</span> <span class="token number">2</span> connected <span class="token number">5461</span>-10922
dc75b9d48aecfe518a33497e81a6e50850821a4b <span class="token number">10.2</span>.32.10:6379@16379 master - <span class="token number">0</span> <span class="token number">1638174289000</span> <span class="token number">0</span> connected
ad7facfbc91e8d22852fef58a7a974f0d070b4cd <span class="token number">10.2</span>.32.15:6379@16379 slave 86b330ac633e111e1ff28c6fc119308c47279e37 <span class="token number">0</span> <span class="token number">1638174289162</span> <span class="token number">2</span> connected
<span class="token comment"># 更改10为11的master了</span>
<span class="token number">10.2</span>.32.11:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>  CLUSTER REPLICATE  dc75b9d48aecfe518a33497e81a6e50850821a4b
OK
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="验证当前集群状态"><a href="#验证当前集群状态" class="header-anchor">#</a> 验证当前集群状态</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-slave1 etc<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb   info  10.2.32.4:6379</span>
<span class="token number">10.2</span>.32.10:6379 <span class="token punctuation">(</span>dc75b9d4<span class="token punctuation">..</span>.<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token number">0</span> keys <span class="token operator">|</span> <span class="token number">0</span> slots <span class="token operator">|</span> <span class="token number">1</span> slaves.
<span class="token number">10.2</span>.32.3:6379 <span class="token punctuation">(</span>86b330ac<span class="token punctuation">..</span>.<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token number">0</span> keys <span class="token operator">|</span> <span class="token number">5462</span> slots <span class="token operator">|</span> <span class="token number">1</span> slaves.
<span class="token number">10.2</span>.32.2:6379 <span class="token punctuation">(</span>ba4e4fbd<span class="token punctuation">..</span>.<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token number">1</span> keys <span class="token operator">|</span> <span class="token number">5461</span> slots <span class="token operator">|</span> <span class="token number">1</span> slaves.
<span class="token number">10.2</span>.32.5:6379 <span class="token punctuation">(</span>942294da<span class="token punctuation">..</span>.<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token number">0</span> keys <span class="token operator">|</span> <span class="token number">5461</span> slots <span class="token operator">|</span> <span class="token number">1</span> slaves.
<span class="token comment"># 变成4个slave了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="重新分配槽位"><a href="#重新分配槽位" class="header-anchor">#</a> 重新分配槽位</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 生产上涉及数据问题,要提前备份好数据  槽里有数据不能迁移</span>
<span class="token punctuation">[</span>root@k8s-slave1 etc<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb reshard 10.2.32.3:6379</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing Cluster Check <span class="token punctuation">(</span>using <span class="token function">node</span> <span class="token number">10.2</span>.32.11:6379<span class="token punctuation">)</span>
S: 7e981b74144f19c4ca36c5f9e76b24aef48e676c <span class="token number">10.2</span>.32.11:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates dc75b9d48aecfe518a33497e81a6e50850821a4b
M: 942294da2e9237c1941833ce3217cae8869a915d <span class="token number">10.2</span>.32.5:6379
   slots:10923-16383 <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: c775e76f383b6dbdb3ea7bbc6a927c35a4280ef3 <span class="token number">10.2</span>.32.4:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 942294da2e9237c1941833ce3217cae8869a915d
M: ba4e4fbda137e12c711117fe3d7bea5c447a195a <span class="token number">10.2</span>.32.2:6379
   slots:0-5460 <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: c193dc8ceabf601e435ebba25ce0e15bb59bf946 <span class="token number">10.2</span>.32.6:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates ba4e4fbda137e12c711117fe3d7bea5c447a195a
M: 86b330ac633e111e1ff28c6fc119308c47279e37 <span class="token number">10.2</span>.32.3:6379
   slots:5461-10922 <span class="token punctuation">(</span><span class="token number">5462</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
M: dc75b9d48aecfe518a33497e81a6e50850821a4b <span class="token number">10.2</span>.32.10:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: ad7facfbc91e8d22852fef58a7a974f0d070b4cd <span class="token number">10.2</span>.32.15:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 86b330ac633e111e1ff28c6fc119308c47279e37
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All nodes agree about slots configuration.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check <span class="token keyword">for</span> <span class="token function">open</span> slots<span class="token punctuation">..</span>.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check slots coverage<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All <span class="token number">16384</span> slots covered.
How many slots <span class="token keyword">do</span> you want to move <span class="token punctuation">(</span>from <span class="token number">1</span> to <span class="token number">16384</span><span class="token punctuation">)</span>? <span class="token number">4096</span>   <span class="token comment">#多少个槽位</span>
What is the receiving <span class="token function">node</span> ID? dc75b9d48aecfe518a33497e81a6e50850821a4b  <span class="token comment">#接收槽位的id</span>
Please enter all the <span class="token builtin class-name">source</span> <span class="token function">node</span> IDs.
  Type <span class="token string">'all'</span> to use all the nodes as <span class="token builtin class-name">source</span> nodes <span class="token keyword">for</span> the <span class="token builtin class-name">hash</span> slots.
  Type <span class="token string">'done'</span> once you entered all the <span class="token builtin class-name">source</span> nodes IDs.
Source <span class="token function">node</span> <span class="token comment">#1:all   #自动分</span>
<span class="token comment"># 最后输入yes就行了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h5 id="验证槽位是否分配成功"><a href="#验证槽位是否分配成功" class="header-anchor">#</a> 验证槽位是否分配成功</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-slave1 etc<span class="token punctuation">]</span><span class="token comment">#  redis-trib.rb   check 10.2.32.4:6379</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing Cluster Check <span class="token punctuation">(</span>using <span class="token function">node</span> <span class="token number">10.2</span>.32.4:6379<span class="token punctuation">)</span>
S: c775e76f383b6dbdb3ea7bbc6a927c35a4280ef3 <span class="token number">10.2</span>.32.4:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 942294da2e9237c1941833ce3217cae8869a915d
M: dc75b9d48aecfe518a33497e81a6e50850821a4b <span class="token number">10.2</span>.32.10:6379
   slots:0-1364,5461-6826,10923-12287 <span class="token punctuation">(</span><span class="token number">4096</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="删除节点"><a href="#删除节点" class="header-anchor">#</a> 删除节点</h5> <p>添加节点的时候是先添加node节点到集群，然后分配槽位，删除节点的操作与添加节点的操作正好相反，是先将被删除的Redis node上的槽位迁移到集群中的其他Redis node节点上，然后再将其删除，如果一个Redis node节点上的槽位没有被完全迁移，删除该node的时候会提示有数据且无法删除。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 下线10.2.32.5</span>
<span class="token comment"># 迁移master 的槽位到其他master</span>
<span class="token comment"># 被迁移Redis master源服务器必须保证没有数据，否则迁移报错并会被强制中断。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 添加一个新节点 10.2.32.16</span>
<span class="token punctuation">[</span>root@k8s-slave1 ~<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb  add-node 10.2.32.16:6379  10.2.32.2:6379</span>
<span class="token comment"># 迁移槽位</span>
<span class="token punctuation">[</span>root@k8s-slave1 ~<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb  reshard 10.2.32.3:6379 </span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing Cluster Check <span class="token punctuation">(</span>using <span class="token function">node</span> <span class="token number">10.2</span>.32.10:6379<span class="token punctuation">)</span>
M: dc75b9d48aecfe518a33497e81a6e50850821a4b <span class="token number">10.2</span>.32.10:6379
   slots:0-1364,5461-6826,10923-12287 <span class="token punctuation">(</span><span class="token number">4096</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
S: c193dc8ceabf601e435ebba25ce0e15bb59bf946 <span class="token number">10.2</span>.32.6:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates ba4e4fbda137e12c711117fe3d7bea5c447a195a
S: ad7facfbc91e8d22852fef58a7a974f0d070b4cd <span class="token number">10.2</span>.32.15:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 86b330ac633e111e1ff28c6fc119308c47279e37
S: c775e76f383b6dbdb3ea7bbc6a927c35a4280ef3 <span class="token number">10.2</span>.32.4:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates 942294da2e9237c1941833ce3217cae8869a915d
S: 7e981b74144f19c4ca36c5f9e76b24aef48e676c <span class="token number">10.2</span>.32.11:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> slave
   replicates dc75b9d48aecfe518a33497e81a6e50850821a4b
M: 86b330ac633e111e1ff28c6fc119308c47279e37 <span class="token number">10.2</span>.32.3:6379
   slots:6827-10922 <span class="token punctuation">(</span><span class="token number">4096</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
M: c5495478041f8b263b073997362945e8b2900c1e <span class="token number">10.2</span>.32.16:6379
   slots: <span class="token punctuation">(</span><span class="token number">0</span> slots<span class="token punctuation">)</span> master
   <span class="token number">0</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
M: 942294da2e9237c1941833ce3217cae8869a915d <span class="token number">10.2</span>.32.5:6379
   slots:12288-16383 <span class="token punctuation">(</span><span class="token number">4096</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
M: ba4e4fbda137e12c711117fe3d7bea5c447a195a <span class="token number">10.2</span>.32.2:6379
   slots:1365-5460 <span class="token punctuation">(</span><span class="token number">4096</span> slots<span class="token punctuation">)</span> master
   <span class="token number">1</span> additional replica<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All nodes agree about slots configuration.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check <span class="token keyword">for</span> <span class="token function">open</span> slots<span class="token punctuation">..</span>.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Check slots coverage<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>OK<span class="token punctuation">]</span> All <span class="token number">16384</span> slots covered.
How many slots <span class="token keyword">do</span> you want to move <span class="token punctuation">(</span>from <span class="token number">1</span> to <span class="token number">16384</span><span class="token punctuation">)</span>? <span class="token number">4096</span>
What is the receiving <span class="token function">node</span> ID? c5495478041f8b263b073997362945e8b2900c1e    <span class="token comment"># 接收槽位的id</span>
Please enter all the <span class="token builtin class-name">source</span> <span class="token function">node</span> IDs.
  Type <span class="token string">'all'</span> to use all the nodes as <span class="token builtin class-name">source</span> nodes <span class="token keyword">for</span> the <span class="token builtin class-name">hash</span> slots.
  Type <span class="token string">'done'</span> once you entered all the <span class="token builtin class-name">source</span> nodes IDs.
Source <span class="token function">node</span> <span class="token comment">#1:  942294da2e9237c1941833ce3217cae8869a915d          #下线的服务器id</span>
Source <span class="token function">node</span> <span class="token comment">#2:  done   #然后直接回车</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 下线10.2.32.5</span>
<span class="token punctuation">[</span>root@k8s-slave1 ~<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb  del-node 10.2.32.3:6379 942294da2e9237c1941833ce3217cae8869a915d</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Removing <span class="token function">node</span> 942294da2e9237c1941833ce3217cae8869a915d from cluster <span class="token number">10.2</span>.32.3:6379
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Sending CLUSTER FORGET messages to the cluster<span class="token punctuation">..</span>.
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> SHUTDOWN the node.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="验证node是否删除"><a href="#验证node是否删除" class="header-anchor">#</a> 验证node是否删除</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-slave1 ~<span class="token punctuation">]</span><span class="token comment"># redis-trib.rb  info  10.2.32.3:6379</span>
<span class="token number">10.2</span>.32.3:6379 <span class="token punctuation">(</span>86b330ac<span class="token punctuation">..</span>.<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token number">0</span> keys <span class="token operator">|</span> <span class="token number">4867</span> slots <span class="token operator">|</span> <span class="token number">1</span> slaves.
<span class="token number">10.2</span>.32.10:6379 <span class="token punctuation">(</span>dc75b9d4<span class="token punctuation">..</span>.<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token number">0</span> keys <span class="token operator">|</span> <span class="token number">4096</span> slots <span class="token operator">|</span> <span class="token number">1</span> slaves.
<span class="token number">10.2</span>.32.16:6379 <span class="token punctuation">(</span>c5495478<span class="token punctuation">..</span>.<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token number">0</span> keys <span class="token operator">|</span> <span class="token number">3325</span> slots <span class="token operator">|</span> <span class="token number">1</span> slaves.
<span class="token number">10.2</span>.32.2:6379 <span class="token punctuation">(</span>ba4e4fbd<span class="token punctuation">..</span>.<span class="token punctuation">)</span> -<span class="token operator">&gt;</span> <span class="token number">1</span> keys <span class="token operator">|</span> <span class="token number">4096</span> slots <span class="token operator">|</span> <span class="token number">1</span> slaves.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/lixuanfengs/cactus-vuepress-sc/edit/master/docs/03.手册/01.开发环境配置/03.Redis安装部署.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/06/22, 19:16:34</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/d9927e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">keepalibved安装与使用</div></a> <a href="/pages/deb0c4/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">zookeeper-centos7安装使用</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/d9927e/" class="prev">keepalibved安装与使用</a></span> <span class="next"><a href="/pages/deb0c4/">zookeeper-centos7安装使用</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/118ac7/"><div>
            深圳仪器平台-开发手册记录
            <!----></div></a> <span class="date">01-25</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/6254d2/"><div>
            👋 该怎样设计一套“百万级API网关?”
            <!----></div></a> <span class="date">10-12</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/d9cb43/"><div>
            功能完善(算力关联、接口上报、调用反馈)
            <!----></div></a> <span class="date">10-09</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1183895890@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/lixuanfengs" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://cactusli.net" title="网站首页" target="_blank" class="iconfont icon-rss"></a><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=1183895890&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" class="iconfont icon-QQ"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2018-2024
    <span>Cactusli | <a href="https://github.com/lixuanfengs/cactus-vuepress/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div><div></div><div></div><div class="artalk"></div><canvas id="vuepress-canvas-cursor"></canvas><div></div><!----></div></div>
    <script src="/assets/js/app.d73578e6.js" defer></script><script src="/assets/js/2.f6444e8b.js" defer></script><script src="/assets/js/59.cb26cb6a.js" defer></script><script src="/assets/js/13.9ca28764.js" defer></script><script src="/assets/js/6.0f00df03.js" defer></script><script src="/assets/js/5.1368437e.js" defer></script><script src="/assets/js/4.7c9e6596.js" defer></script>
  </body>
</html>
